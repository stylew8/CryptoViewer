/*!
 * @license
 * TradingView Lightweight Charts™ v4.1.4
 * Copyright (c) 2024 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(){"use strict";function p(n,t){const i={0:[],1:[n.lineWidth,n.lineWidth],2:[2*n.lineWidth,2*n.lineWidth],3:[6*n.lineWidth,6*n.lineWidth],4:[n.lineWidth,4*n.lineWidth]}[t];n.setLineDash(i)}function rf(n,t,i,r){n.beginPath();const u=n.lineWidth%2?.5:0;n.moveTo(i,t+u);n.lineTo(r,t+u);n.stroke()}function v(n,t){if(!n)throw new Error("Assertion failed"+(t?": "+t:""));}function u(n){if(void 0===n)throw new Error("Value is undefined");return n}function n(n){if(null===n)throw new Error("Value is null");return n}function nt(t){return n(u(t))}function e(n){return n<0?0:n>255?255:Math.round(n)||0}function ff(n){return n<=0||n>1?Math.min(Math.max(n,0),1):Math.round(1e4*n)/1e4}function bt(n){(n=n.toLowerCase())in uf&&(n=uf[n]);{const t=ws.exec(n)||ps.exec(n);if(t)return[e(parseInt(t[1],10)),e(parseInt(t[2],10)),e(parseInt(t[3],10)),ff(t.length<5?1:parseFloat(t[4]))]}{const t=ys.exec(n);if(t)return[e(parseInt(t[1],16)),e(parseInt(t[2],16)),e(parseInt(t[3],16)),1]}{const t=vs.exec(n);if(t)return[e(17*parseInt(t[1],16)),e(17*parseInt(t[2],16)),e(17*parseInt(t[3],16)),1]}throw new Error(`Cannot parse color: ${n}`);}function kt(n){const t=bt(n);return{t:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,i:(i=t,.199*i[0]+.687*i[1]+.114*i[2]>160?"black":"white")};var i}function o(n,...t){for(const t of t)for(const i in t)void 0!==t[i]&&("object"!=typeof t[i]||void 0===n[i]||Array.isArray(t[i])?n[i]=t[i]:o(n[i],t[i]));return n}function h(n){return"number"==typeof n&&isFinite(n)}function ft(n){return"number"==typeof n&&n%1==0}function et(n){return"string"==typeof n}function dt(n){return"boolean"==typeof n}function l(n){const t=n;if(!t||"object"!=typeof t)return t;let u,r,i;for(r in u=Array.isArray(t)?[]:{},t)t.hasOwnProperty(r)&&(i=t[r],u[r]=i&&"object"==typeof i?l(i):i);return u}function bs(n){return null!==n}function ot(n){if(null!==n)return n}function tt(n,t,i){return void 0===t&&(t=ki),`${i=void 0!==i?`${i} `:""}${n}px ${t}`}function gs(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}function uh(n,t,i,r,u,f){n.fillRect(t+f,i,r-2*f,f);n.fillRect(t+f,i+u-f,r-2*f,f);n.fillRect(t,i,f,u);n.fillRect(t+r-f,i,f,u)}function gt(n,t,i,r,u,f){n.save();n.globalCompositeOperation="copy";n.fillStyle=f;n.fillRect(t,i,r,u);n.restore()}function ef(n,t,i,r,u,f){n.beginPath();n.roundRect?n.roundRect(t,i,r,u,f):(n.lineTo(t+r-f[1],i),0!==f[1]&&n.arcTo(t+r,i,t+r,i+f[1],f[1]),n.lineTo(t+r,i+u-f[2]),0!==f[2]&&n.arcTo(t+r,i+u,t+r-f[2],i+u,f[2]),n.lineTo(t+f[3],i+u),0!==f[3]&&n.arcTo(t,i+u,t,i+u-f[3],f[3]),n.lineTo(t,i+f[0]),0!==f[0]&&n.arcTo(t,i,t+f[0],i,f[0]))}function of(n,t,i,r,u,f,e=0,o=[0,0,0,0],s=""){if(n.save(),!e||!s||s===f)return ef(n,t,i,r,u,o),n.fillStyle=f,n.fill(),void n.restore();const h=e/2;var c;ef(n,t+h,i+h,r-e,u-e,(c=-h,o.map(n=>0===n?n:n+c)));"transparent"!==f&&(n.fillStyle=f,n.fill());"transparent"!==s&&(n.lineWidth=e,n.strokeStyle=s,n.closePath(),n.stroke());n.restore()}function sf(n,t,i,r,u,f,e){n.save();n.globalCompositeOperation="copy";const o=n.createLinearGradient(0,0,0,u);o.addColorStop(0,f);o.addColorStop(1,e);n.fillStyle=o;n.fillRect(t,i,r,u);n.restore()}function ti(n){return"left"===n||"right"===n}function a(n,t){if(!h(n))return"n/a";if(!ft(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return 0===t?n.toString():("0000000000000000"+n.toString()).slice(-t)}function vf(n,t,i,r,u,f,e){if(0!==t.length&&!(r.from>=t.length)&&!(r.to<=0)){const{context:o,horizontalPixelRatio:s,verticalPixelRatio:h}=n,c=t[r.from];let l=f(n,c),a=c;if(r.to-r.from<2){const r=u/2;o.beginPath();const t={nt:c.nt-r,st:c.st},i={nt:c.nt+r,st:c.st};o.moveTo(t.nt*s,t.st*h);o.lineTo(i.nt*s,i.st*h);e(n,l,t,i)}else{const v=(t,i)=>{e(n,l,a,i),o.beginPath(),l=t,a=i};let u=a;o.beginPath();o.moveTo(c.nt*s,c.st*h);for(let e=r.from+1;e<r.to;++e){u=t[e];const r=f(n,u);switch(i){case 0:o.lineTo(u.nt*s,u.st*h);break;case 1:o.lineTo(u.nt*s,t[e-1].st*h);r!==l&&(v(r,u),o.lineTo(u.nt*s,t[e-1].st*h));o.lineTo(u.nt*s,u.st*h);break;case 2:{const[n,i]=ch(t,e-1,e);o.bezierCurveTo(n.nt*s,n.st*h,i.nt*s,i.st*h,u.nt*s,u.st*h);break}}1!==i&&r!==l&&(v(r,u),o.moveTo(u.nt*s,u.st*h))}(a!==u||a===u&&1===i)&&e(n,l,a,u)}}}function tr(n,t){return{nt:n.nt-t.nt,st:n.st-t.st}}function pf(n,t){return{nt:n.nt/t,st:n.st/t}}function ch(n,t,i){const f=Math.max(0,t-1),e=Math.min(n.length-1,i+1);var r,u;return[(r=n[t],u=pf(tr(n[i],n[f]),yf),{nt:r.nt+u.nt,st:r.st+u.st}),tr(n[i],pf(tr(n[e],n[t]),yf))]}function lh(n,t,i,r,u){const{context:f,horizontalPixelRatio:e,verticalPixelRatio:o}=t;f.lineTo(u.nt*e,n*o);f.lineTo(r.nt*e,n*o);f.closePath();f.fillStyle=i;f.fill()}function ir(n,t,i){return Math.min(Math.max(n,t),i)}function ri(n,t,i){return t-n<=i}function bf(n){const t=Math.ceil(n);return t%2==0?t-1:t}function vh(n,t){const i=n.context;i.strokeStyle=t;i.stroke()}function gf(n,t,i,r,u=0,f=t.length){let e=f-u;for(;0<e;){const f=e>>1,o=u+f;r(t[o],i)===n?(u=o+1,e-=f+1):e=f}return u}function yh(n,t){return n.ot<t}function ph(n,t){return t<n.ot}function te(n,t,i){const f=t.Rs(),e=t.ui(),r=st(n,f,yh),u=ne(n,e,ph);if(!i)return{from:r,to:u};let o=r,s=u;return r>0&&r<n.length&&n[r].ot>=f&&(o=r-1),u>0&&u<n.length&&n[u-1].ot<=e&&(s=u+1),{from:o,to:s}}function uc(n){return{x:n.nt,time:n.ot,originalData:n.Fe,barColor:n.oe}}function ue(n,t,i,r){return function(n,t){if("transparent"===n)return n;const i=bt(n),r=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${t*r})`}(n,i+(r-i)*t)}function fe(n,t){const r=n%2600/2600;let i;for(const n of vc)if(r>=n.Pr&&r<=n.Rr){i=n;break}v(void 0!==i,"Last price animation internal logic error");const u=(r-i.Pr)/(i.Rr-i.Pr);return{Cr:ue(t,u,i.Br,i.Ar),Tr:ue(t,u,i.Vr,i.zr),ht:(e=u,f=i.Dr,o=i.Or,f+(o-f)*e)};var e,f,o}function ct(n,t){return bf(Math.min(Math.max(n,12),30)*t)}function lt(n,t){switch(n){case"arrowDown":case"arrowUp":return ct(t,1);case"circle":return ct(t,.8);case"square":return ct(t,.7)}}function ee(n){return function(n){const t=Math.ceil(n);return t%2!=0?t-1:t}(ct(n,1))}function oe(n){return Math.max(ct(n,.1),3)}function se(n,t,i){return t?n:i?Math.ceil(n/2):0}function he(n,t,i,r,u){const f=lt("square",i),e=(f-1)/2,o=n-e,s=t-e;return r>=o&&r<=o+f&&u>=s&&u<=s+f}function ce(n,t,i,r){const u=(lt("arrowUp",r)-1)/2*i.Kr,f=(bf(r/2)-1)/2*i.Kr;t.beginPath();n?(t.moveTo(i.nt-u,i.st),t.lineTo(i.nt,i.st-u),t.lineTo(i.nt+u,i.st),t.lineTo(i.nt+f,i.st),t.lineTo(i.nt+f,i.st+u),t.lineTo(i.nt-f,i.st+u),t.lineTo(i.nt-f,i.st)):(t.moveTo(i.nt-u,i.st),t.lineTo(i.nt,i.st+u),t.lineTo(i.nt+u,i.st),t.lineTo(i.nt+f,i.st),t.lineTo(i.nt+f,i.st-u),t.lineTo(i.nt-f,i.st-u),t.lineTo(i.nt-f,i.st));t.fill()}function pc(n,t,i,r,u,f){return he(t,i,r,u,f)}function bc(n,t,i,r){t.fillStyle=n.O;void 0!==n.Zt&&function(n,t,i,r,u,f){n.save();n.scale(u,f);n.fillText(t,i,r);n.restore()}(t,n.Zt.Jr,n.Zt.nt,n.Zt.st,i,r),function(n,t,i){if(0!==n.Ys){switch(n.Qr){case"arrowDown":return void ce(!1,t,i,n.Ys);case"arrowUp":return void ce(!0,t,i,n.Ys);case"circle":return void function(n,t,i){const r=(lt("circle",i)-1)/2;n.beginPath();n.arc(t.nt,t.st,r*t.Kr,0,2*Math.PI,!1);n.fill()}(t,i,n.Ys);case"square":return void function(n,t,i){const r=lt("square",i),u=(r-1)*t.Kr/2,f=t.nt-u,e=t.st-u;n.fillRect(f,e,r*t.Kr,r*t.Kr)}(t,i,n.Ys)}n.Qr}}(n,t,function(n,t,i){const r=Math.max(1,Math.floor(t))%2/2;return{nt:Math.round(n.nt*t)+r,st:n.st*i,Kr:t}}(n,i,r))}function kc(n,t,i){return!(void 0===n.Zt||!function(n,t,i,r,u,f){const e=r/2;return u>=n&&u<=n+i&&f>=t-e&&f<=t+e}(n.Zt.nt,n.Zt.st,n.Zt.ji,n.Zt.Vt,t,i))||function(n,t,i){if(0===n.Ys)return!1;switch(n.Qr){case"arrowDown":case"arrowUp":return pc(0,n.nt,n.st,n.Ys,t,i);case"circle":return function(n,t,i,r,u){const o=2+lt("circle",i)/2,f=n-r,e=t-u;return Math.sqrt(f*f+e*e)<=o}(n.nt,n.st,n.Ys,t,i);case"square":return he(n.nt,n.st,n.Ys,t,i)}}(n,t,i)}function dc(n,t,i,r,u,f,e,o,s){const a=h(i)?i:i.ge,v=h(i)?i:i.be,y=h(i)?i:i.we,p=h(t.size)?Math.max(t.size,0):1,l=ee(o.ee())*p,c=l/2;switch(n.Ys=l,t.position){case"inBar":return n.st=e.Rt(a,s),void(void 0!==n.Zt&&(n.Zt.st=n.st+c+f+.6*u));case"aboveBar":return n.st=e.Rt(v,s)-c-r.th,void 0!==n.Zt&&(n.Zt.st=n.st-c-.6*u,r.th+=1.2*u),void(r.th+=l+f);case"belowBar":return n.st=e.Rt(y,s)+c+r.ih,void 0!==n.Zt&&(n.Zt.st=n.st+c+f+.6*u,r.ih+=1.2*u),void(r.ih+=l+f)}t.position}function le(n,t,i,r){const u=Number.isFinite(t),f=Number.isFinite(i);return u&&f?n(t,i):u||f?u?t:i:r}function fi(n,t){return null===n?t:null===t?n:{dl:Math.min(n.dl,t.dl),fl:Math.max(n.fl,t.fl)}}function ae(n){var t,i,r,u,f;return{Zt:n.text(),Si:n.coordinate(),xi:null===(t=n.fixedCoordinate)||void 0===t?void 0:t.call(n),O:n.textColor(),t:n.backColor(),kt:null===(r=null===(i=n.visible)||void 0===i?void 0:i.call(n))||void 0===r||r,hi:null===(f=null===(u=n.tickVisible)||void 0===u?void 0:u.call(n))||void 0===f||f}}function cr(n,t,i,r){n.forEach(n=>{t(n).forEach(n=>{n.wl()===i&&r.push(n)})})}function lr(n){return n.Cn()}function vl(n){return n.Rl()}function yl(n){return n.Dl()}function it(n,t){const i=100*(n-t)/t;return t<0?-i:i}function dl(n,t){const i=it(n.yh(),t),r=it(n.kh(),t);return new f(i,r)}function at(n,t){const i=100*(n-t)/t+100;return t<0?-i:i}function gl(n,t){const i=at(n.yh(),t),r=at(n.kh(),t);return new f(i,r)}function ei(n,t){const i=Math.abs(n);if(i<1e-15)return 0;const r=Math.log10(i+t.Wa)+t.Fa;return n<0?-r:r}function vt(n,t){const i=Math.abs(n);if(i<1e-15)return 0;const r=Math.pow(10,i-t.Fa)-t.Wa;return n<0?-r:r}function yt(n,t){if(null===n)return null;const i=ei(n.yh(),t),r=ei(n.kh(),t);return new f(i,r)}function oi(n,t){if(null===n)return null;const i=vt(n.yh(),t),r=vt(n.kh(),t);return new f(i,r)}function yr(n){if(null===n)return vr;const t=Math.abs(n.kh()-n.yh());if(t>=1||t<1e-15)return vr;const r=Math.ceil(Math.abs(Math.log10(t))),i=vr.Fa+r;return{Fa:i,Wa:1/Math.pow(10,i)}}function ye(t){return t.slice().sort((t,i)=>n(t.Xi())-n(i.Xi()))}function be(n,t){return null===n||null===t?n===t:n.xh(t)}function ua(n,t){return n.weight>t.weight?n:t}function si(n){return!h(n)&&!et(n)}function tu(n){return h(n)}function la(n,t,i){return t.replace(/yyyy/g,(n=>a(ke(n),4))(n)).replace(/yy/g,(n=>a(ke(n)%100,2))(n)).replace(/MMMM/g,((n,t)=>new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(t,{month:"long"}))(n,i)).replace(/MMM/g,((n,t)=>new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(t,{month:"short"}))(n,i)).replace(/MM/g,(n=>a((n=>n.getUTCMonth()+1)(n),2))(n)).replace(/dd/g,(n=>a((n=>n.getUTCDate())(n),2))(n))}function hi(n){return 36e5*n}function iu(n){return 6e4*n}function no(n,t){if(n.getUTCFullYear()!==t.getUTCFullYear())return 70;if(n.getUTCMonth()!==t.getUTCMonth())return 60;if(n.getUTCDate()!==t.getUTCDate())return 50;for(let i=ci.length-1;i>=0;--i)if(Math.floor(t.getTime()/ci[i].kd)!==Math.floor(n.getTime()/ci[i].kd))return ci[i].Cd;return 0}function ru(n){let t=n;if(et(n)&&(t=uu(n)),!si(t))throw new Error("time must be of type BusinessDay");const i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Td:Math.round(i.getTime()/1e3),Pd:t}}function to(n){if(!tu(n))throw new Error("time must be of type isUTCTimestamp");return{Td:n}}function uu(n){const t=new Date(n);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${n}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function io(n){et(n.time)&&(n.time=uu(n.time))}function t(n){var t=n.width,i=n.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(i<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:i}}function w(n,t){return n.width===t.width&&n.height===t.height}function eo(n){return n.ownerDocument.defaultView}function b(n,t){var r=n.canvasElementClientSize,i,u;return 0===r.width||0===r.height?null:(i=n.bitmapSize,0===i.width||0===i.height)?null:(u=n.canvasElement.getContext("2d",t),null===u?null:new oo(u,r,i))}function so(){return!!rt&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function fu(){return!!rt&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function eu(n){return n+n%2}function ou(n,t){return n.Od-t.Od}function su(n,t,i){const r=(n.Od-t.Od)/(n.ot-t.ot);return Math.sign(r)*Math.min(Math.abs(r),i)}function k(t,i){const r=n(t.ownerDocument).createElement("canvas");t.appendChild(r);const u=function(n,t){if("device-pixel-content-box"===t.type)return new fo(n,t.transform,t.options);throw new Error("Unsupported binding target");}(r,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(n,t)=>({width:Math.max(n.width,t.width),height:Math.max(n.height,t.height)})});return u.resizeCanvasElement(i),u}function d(n){var t;n.width=1;n.height=1;null===(t=n.getContext("2d"))||void 0===t||t.clearRect(0,0,1,1)}function hu(n,t,i,r){n.pl&&n.pl(t,i,r)}function li(n,t,i,r){n.K(t,i,r)}function cu(n,t,i,r){const u=n(i,r);for(const n of u){const i=n.gt();null!==i&&t(i)}}function wa(n){rt&&void 0!==window.chrome&&n.addEventListener("mousedown",n=>{if(1===n.button)return n.preventDefault(),!1})}function ho(n,t){const i=n.clientX-t.clientX,r=n.clientY-t.clientY;return Math.sqrt(i*i+r*r)}function ut(n){n.cancelable&&n.preventDefault()}function c(n){return{nt:n.pageX,st:n.pageY}}function ai(n){return n.timeStamp||performance.now()}function au(n,t){for(let i=0;i<n.length;++i)if(n[i].identifier===t)return n[i];return null}function vi(n){return{Lc:n.Lc,wv:{mr:n.gv.externalId},Mv:n.gv.cursorStyle}}function ba(n,t,i){for(const n of n){const r=n.gt();if(null!==r&&r.pr){const u=r.pr(t,i);if(null!==u)return{mv:n,wv:u}}}return null}function vu(n,t){return i=>{var r,u,f,e;return(null!==(u=null===(r=i.Dt())||void 0===r?void 0:r.ya())&&void 0!==u?u:"")!==t?[]:null!==(e=null===(f=i.oa)||void 0===f?void 0:f.call(i,n))&&void 0!==e?e:[]}}function ka(n,t){var i,r;return null!==(r=null===(i=n.la)||void 0===i?void 0:i.call(n,t))&&void 0!==r?r:[]}function yi(n,t){var i,r;return null!==(r=null===(i=n.Cn)||void 0===i?void 0:i.call(n,t))&&void 0!==r?r:[]}function da(n,t){var i,r;return null!==(r=null===(i=n.Gi)||void 0===i?void 0:i.call(n,t))&&void 0!==r?r:[]}function ga(n,t){var i,r;return null!==(r=null===(i=n.ea)||void 0===i?void 0:i.call(n,t))&&void 0!==r?r:[]}function yu(n){return t=>{var i,r;return null!==(r=null===(i=t._a)||void 0===i?void 0:i.call(t,n))&&void 0!==r?r:[]}}function wu(n){return Boolean(n.handleScroll.mouseWheel||n.handleScale.mouseWheel)}function vo(n,t){var u={},i,r;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(u[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(u[i[r]]=n[i[r]]);return u}function yo(n,t,i,r){const u=i.value,f={ie:t,ot:n,Ot:[u,u,u,u],Mb:r};return void 0!==i.color&&(f.O=i.color),f}function ev(n,t,i,r){const u=i.value,f={ie:t,ot:n,Ot:[u,u,u,u],Mb:r};return void 0!==i.lineColor&&(f.lt=i.lineColor),void 0!==i.topColor&&(f.ks=i.topColor),void 0!==i.bottomColor&&(f.Cs=i.bottomColor),f}function ov(n,t,i,r){const f=i.value,u={ie:t,ot:n,Ot:[f,f,f,f],Mb:r};return void 0!==i.topLineColor&&(u.Ce=i.topLineColor),void 0!==i.bottomLineColor&&(u.Te=i.bottomLineColor),void 0!==i.topFillColor1&&(u.Me=i.topFillColor1),void 0!==i.topFillColor2&&(u.xe=i.topFillColor2),void 0!==i.bottomFillColor1&&(u.Se=i.bottomFillColor1),void 0!==i.bottomFillColor2&&(u.ye=i.bottomFillColor2),u}function sv(n,t,i,r){const u={ie:t,ot:n,Ot:[i.open,i.high,i.low,i.close],Mb:r};return void 0!==i.color&&(u.O=i.color),u}function hv(n,t,i,r){const u={ie:t,ot:n,Ot:[i.open,i.high,i.low,i.close],Mb:r};return void 0!==i.color&&(u.O=i.color),void 0!==i.borderColor&&(u.Bt=i.borderColor),void 0!==i.wickColor&&(u.Uh=i.wickColor),u}function cv(n,t,i,r,f){const e=u(f)(i),h=Math.max(...e),c=Math.min(...e),o=e[e.length-1],l=[o,h,c,o],s=i,{color:a}=s;return{ie:t,ot:n,Ot:l,Mb:r,We:vo(s,["time","color"]),O:a}}function pi(n){return void 0!==n.Ot}function po(n,t){return void 0!==t.customValues&&(n.Tb=t.customValues),n}function g(n){return(t,i,r,u,f,e)=>function(n,t){return t?t(n):void 0===(i=n).open&&void 0===i.value;var i}(r,e)?po({ot:t,ie:i,Mb:u},r):po(n(t,i,r,u,f),r)}function wo(n){return{Candlestick:g(hv),Bar:g(sv),Area:g(ev),Baseline:g(ov),Histogram:g(yo),Line:g(yo),Custom:g(cv)}[n]}function bo(n){return{ie:0,Pb:new Map,sa:n}}function ko(n,t){if(void 0!==n&&0!==n.length)return{Rb:t.key(n[0].ot),Db:t.key(n[n.length-1].ot)}}function go(n){let t;return n.forEach(n=>{void 0===t&&(t=n.Mb)}),u(t)}function bu(n,t){n.ie=t;n.Pb.forEach(n=>{n.ie=t})}function ku(n){const t={value:n.Ot[3],time:n.Mb};return void 0!==n.Tb&&(t.customValues=n.Tb),t}function ns(n){const t=ku(n);return void 0!==n.O&&(t.color=n.O),t}function av(n){const t=ku(n);return void 0!==n.lt&&(t.lineColor=n.lt),void 0!==n.ks&&(t.topColor=n.ks),void 0!==n.Cs&&(t.bottomColor=n.Cs),t}function vv(n){const t=ku(n);return void 0!==n.Ce&&(t.topLineColor=n.Ce),void 0!==n.Te&&(t.bottomLineColor=n.Te),void 0!==n.Me&&(t.topFillColor1=n.Me),void 0!==n.xe&&(t.topFillColor2=n.xe),void 0!==n.Se&&(t.bottomFillColor1=n.Se),void 0!==n.ye&&(t.bottomFillColor2=n.ye),t}function ts(n){const t={open:n.Ot[0],high:n.Ot[1],low:n.Ot[2],close:n.Ot[3],time:n.Mb};return void 0!==n.Tb&&(t.customValues=n.Tb),t}function yv(n){const t=ts(n);return void 0!==n.O&&(t.color=n.O),t}function pv(n){const t=ts(n),{O:i,Bt:r,Uh:u}=n;return void 0!==i&&(t.color=i),void 0!==r&&(t.borderColor=r),void 0!==u&&(t.wickColor=u),t}function du(n){return{Area:av,Line:ns,Baseline:vv,Histogram:ns,Bar:yv,Candlestick:pv,Custom:wv}[n]}function wv(n){const t=n.Mb;return Object.assign(Object.assign({},n.We),{time:t})}function is(){return{width:0,height:0,autoSize:!1,layout:dv,crosshair:bv,grid:kv,overlayPriceScales:Object.assign({},gu),leftPriceScale:Object.assign(Object.assign({},gu),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},gu),{visible:!0}),timeScale:gv,watermark:ny,localization:{locale:rt?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}function rs(n,t,i){const u=vo(n,["time","originalTime"]),r=Object.assign({time:t},u);return void 0!==i&&(r.originalTime=i),r}function ey(n){if(void 0!==n&&"custom"!==n.type){const t=n;void 0!==t.minMove&&void 0===t.precision&&(t.precision=function(n){if(n>=1)return 0;let t=0;for(;t<8;t++){const i=Math.round(n);if(Math.abs(i-n)<1e-8)return t;n*=10}return t}(t.minMove))}}function us(n){return function(n){if(dt(n.handleScale)){const t=n.handleScale;n.handleScale={axisDoubleClickReset:{time:t,price:t},axisPressedMouseMove:{time:t,price:t},mouseWheel:t,pinch:t}}else if(void 0!==n.handleScale){const{axisPressedMouseMove:t,axisDoubleClickReset:i}=n.handleScale;dt(t)&&(n.handleScale.axisPressedMouseMove={time:t,price:t});dt(i)&&(n.handleScale.axisDoubleClickReset={time:i,price:i})}const t=n.handleScroll;dt(t)&&(n.handleScroll={horzTouchDrag:t,vertTouchDrag:t,mouseWheel:t,pressedMouseMove:t})}(n),n}function fs(n,t,i){let r;if(et(n)){const t=document.getElementById(n);v(null!==t,`Cannot find element in DOM with id=${n}`);r=t}else r=n;const u=new oy(r,t,i);return t.setOptions(u.options()),u}var wi,bi,nr,sr,wr,br,kr,dr,gr,nu,ge,uo,fo,oo,pu,es;const os={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},ss={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},hs={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},cs={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},ls={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},as={color:"#26a69a",base:0},nf={color:"#2196f3"},tf={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};!function(n){n[n.Simple=0]="Simple";n[n.WithSteps=1]="WithSteps";n[n.Curved=2]="Curved"}(wi||(wi={})),function(n){n[n.Solid=0]="Solid";n[n.Dotted=1]="Dotted";n[n.Dashed=2]="Dashed";n[n.LargeDashed=3]="LargeDashed";n[n.SparseDotted=4]="SparseDotted"}(bi||(bi={}));const uf={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};const vs=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,ys=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,ps=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,ws=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;class i{constructor(){this.h=[]}l(n,t,i){const r={o:n,_:t,u:!0===i};this.h.push(r)}v(n){const t=this.h.findIndex(t=>n===t.o);t>-1&&this.h.splice(t,1)}p(n){this.h=this.h.filter(t=>t._!==n)}m(n,t,i){const r=[...this.h];this.h=this.h.filter(n=>!n.u);r.forEach(r=>r.o(n,t,i))}M(){return this.h.length>0}S(){this.h=[]}}const ki="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";class ks{constructor(n){this.k={C:1,T:5,P:NaN,R:"",D:"",O:"",B:"",A:0,V:0,I:0,L:0,N:0};this.F=n}W(){const n=this.k,t=this.j(),i=this.H();return n.P===t&&n.D===i||(n.P=t,n.D=i,n.R=tt(t,i),n.L=2.5/12*t,n.A=n.L,n.V=t/12*n.T,n.I=t/12*n.T,n.N=0),n.O=this.$(),n.B=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class di{constructor(){this.Y=[]}X(n){this.Y=n}K(n,t,i){this.Y.forEach(r=>{r.K(n,t,i)})}}class s{K(n,t,i){n.useBitmapCoordinateSpace(n=>this.Z(n,t,i))}}class ds extends s{constructor(){super(...arguments);this.G=null}J(n){this.G=n}Z({context:i,horizontalPixelRatio:n,verticalPixelRatio:t}){if(null!==this.G&&null!==this.G.tt){const u=this.G.tt,r=this.G,f=Math.max(1,Math.floor(n))%2/2,e=e=>{i.beginPath();for(let o=u.to-1;o>=u.from;--o){const u=r.it[o],s=Math.round(u.nt*n)+f,h=u.st*t,c=e*t+f;i.moveTo(s,h);i.arc(s,h,c,0,2*Math.PI)}i.fill()};r.et>0&&(i.fillStyle=r.rt,e(r.ht+r.et));i.fillStyle=r.lt;e(r.ht)}}}const nh={from:0,to:1};class th{constructor(n,t){this.ut=new di;this.ct=[];this.dt=[];this.ft=!0;this.F=n;this.vt=t;this.ut.X(this.ct)}bt(){const n=this.F.wt();n.length!==this.ct.length&&(this.dt=n.map(gs),this.ct=this.dt.map(n=>{const t=new ds;return t.J(n),t}),this.ut.X(this.ct));this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const i=2===this.vt.W().mode,r=this.F.wt(),t=this.vt.xt(),u=this.F.St();r.forEach((r,f)=>{var s;const e=this.dt[f],o=r.yt(t);if(i||null===o||!r.kt())return void(e.tt=null);const h=n(r.Ct());e.lt=o.Tt;e.ht=o.ht;e.et=o.Pt;e.it[0]._t=o._t;e.it[0].st=r.Dt().Rt(o._t,h.Ot);e.rt=null!==(s=o.Bt)&&void 0!==s?s:this.F.At(e.it[0].st/r.Dt().Vt());e.it[0].ot=t;e.it[0].nt=u.zt(t);e.tt=nh})}}class ih extends s{constructor(n){super();this.Et=n}Z({context:r,bitmapSize:n,horizontalPixelRatio:t,verticalPixelRatio:i}){if(null!==this.Et){const u=this.Et.It.kt,f=this.Et.Lt.kt;if(u||f){const e=Math.round(this.Et.nt*t),o=Math.round(this.Et.st*i);r.lineCap="butt";u&&e>=0&&(r.lineWidth=Math.floor(this.Et.It.et*t),r.strokeStyle=this.Et.It.O,r.fillStyle=this.Et.It.O,p(r,this.Et.It.Nt),function(n,t,i,r){n.beginPath();const u=n.lineWidth%2?.5:0;n.moveTo(t+u,i);n.lineTo(t+u,r);n.stroke()}(r,e,0,n.height));f&&o>=0&&(r.lineWidth=Math.floor(this.Et.Lt.et*i),r.strokeStyle=this.Et.Lt.O,r.fillStyle=this.Et.Lt.O,p(r,this.Et.Lt.Nt),rf(r,o,0,n.width))}}}}class rh{constructor(n){this.ft=!0;this.Ft={It:{et:1,Nt:0,O:"",kt:!1},Lt:{et:1,Nt:0,O:"",kt:!1},nt:0,st:0};this.Wt=new ih(this.Ft);this.jt=n}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const r=this.jt.kt(),u=n(this.jt.Ht()),i=u.$t().W().crosshair,t=this.Ft;if(2===i.mode)return t.Lt.kt=!1,void(t.It.kt=!1);t.Lt.kt=r&&this.jt.Ut(u);t.It.kt=r&&this.jt.qt();t.Lt.et=i.horzLine.width;t.Lt.Nt=i.horzLine.style;t.Lt.O=i.horzLine.color;t.It.et=i.vertLine.width;t.It.Nt=i.vertLine.style;t.It.O=i.vertLine.color;t.nt=this.jt.Yt();t.st=this.jt.Xt()}}class hf{constructor(n,t){this.J(n,t)}J(n,t){this.Et=n;this.Kt=t}Vt(n){return this.Et.kt?n.P+n.L+n.A:0}K(n,t,i,r){if(this.Et.kt&&0!==this.Et.Zt.length){const u=this.Et.O,f=this.Kt.t,e=n.useBitmapCoordinateSpace(n=>{const o=n.context;o.font=t.R;const s=this.Gt(n,t,i,r),e=s.Jt,h=(n,t)=>{s.Qt?of(o,e.ti,e.ii,e.ni,e.si,n,e.ei,[e.ht,0,0,e.ht],t):of(o,e.ri,e.ii,e.ni,e.si,n,e.ei,[0,e.ht,e.ht,0],t)};return h(f,"transparent"),this.Et.hi&&(o.fillStyle=u,o.fillRect(e.ri,e.li,e.ai-e.ri,e.oi)),h("transparent",f),this.Et._i&&(o.fillStyle=t.B,o.fillRect(s.Qt?e.ui-e.ei:0,e.ii,e.ei,e.ci-e.ii)),s});n.useMediaCoordinateSpace({context:n}=>{const i=e.di;n.font=t.R;n.textAlign=e.Qt?"right":"left";n.textBaseline="middle";n.fillStyle=u;n.fillText(this.Et.Zt,i.fi,(i.ii+i.ci)/2+i.vi)})}}Gt(n,t,i,r){var l;const{context:g,bitmapSize:nt,mediaSize:et,horizontalPixelRatio:s,verticalPixelRatio:u}=n,h=this.Et.hi||!this.Et.pi?t.T:0,f=this.Et.mi?t.C:0,ot=t.L+this.Kt.bi,st=t.A+this.Kt.wi,a=t.V,ht=t.I,tt=this.Et.Zt,ct=t.P,lt=i.gi(g,tt),at=Math.ceil(i.Mi(g,tt)),vt=ct+ot+st,yt=t.C+a+ht+at+h,v=Math.max(1,Math.floor(u));let e=Math.round(vt*u);e%2!=v%2&&(e+=1);const y=f>0?Math.max(1,Math.floor(f*s)):0,p=Math.round(yt*s),it=Math.round(h*s),pt=null!==(l=this.Kt.xi)&&void 0!==l?l:this.Kt.Si,rt=Math.round(pt*u)-Math.floor(.5*u),w=Math.floor(rt+v/2-e/2),ut=w+e,c="right"===r,ft=c?et.width-f:f,o=c?nt.width-y:y;let b,k,d;return c?(b=o-p,k=o-it,d=ft-h-a-f):(b=o+p,k=o+it,d=ft+h+a),{Qt:c,Jt:{ii:w,li:rt,ci:ut,ni:p,si:e,ht:2*s,ei:y,ti:b,ri:o,ai:k,oi:v,ui:nt.width},di:{ii:w/u,ci:ut/u,fi:d,vi:lt}}}}class ni{constructor(n){this.yi={Si:0,t:"#000",wi:0,bi:0};this.ki={Zt:"",kt:!1,hi:!0,pi:!1,Bt:"",O:"#FFF",_i:!1,mi:!1};this.Ci={Zt:"",kt:!1,hi:!1,pi:!0,Bt:"",O:"#FFF",_i:!0,mi:!0};this.ft=!0;this.Ti=new(n||hf)(this.ki,this.yi);this.Pi=new(n||hf)(this.Ci,this.yi)}Zt(){return this.Ri(),this.ki.Zt}Si(){return this.Ri(),this.yi.Si}bt(){this.ft=!0}Vt(n,t=!1){return Math.max(this.Ti.Vt(n,t),this.Pi.Vt(n,t))}Di(){return this.yi.xi||0}Oi(n){this.yi.xi=n}Bi(){return this.Ri(),this.ki.kt||this.Ci.kt}Ai(){return this.Ri(),this.ki.kt}gt(n){return this.Ri(),this.ki.hi=this.ki.hi&&n.W().ticksVisible,this.Ci.hi=this.Ci.hi&&n.W().ticksVisible,this.Ti.J(this.ki,this.yi),this.Pi.J(this.Ci,this.yi),this.Ti}Vi(){return this.Ri(),this.Ti.J(this.ki,this.yi),this.Pi.J(this.Ci,this.yi),this.Pi}Ri(){this.ft&&(this.ki.hi=!0,this.Ci.hi=!1,this.zi(this.ki,this.Ci,this.yi))}}class fh extends ni{constructor(n,t,i){super();this.jt=n;this.Ei=t;this.Ii=i}zi(n,t,i){if(n.kt=!1,2!==this.jt.W().mode){const r=this.jt.W().horzLine;if(r.labelVisible){const u=this.Ei.Ct();if(this.jt.kt()&&!this.Ei.Li()&&null!==u){const f=kt(r.labelBackgroundColor);i.t=f.t;n.O=f.i;const e=2/12*this.Ei.P();i.bi=e;i.wi=e;const o=this.Ii(this.Ei);i.Si=o.Si;n.Zt=this.Ei.Ni(o._t,u);n.kt=!0}}}}}const eh=/[1-9]/g;class cf{constructor(){this.Et=null}J(n){this.Et=n}K(t,i){if(null!==this.Et&&!1!==this.Et.kt&&0!==this.Et.Zt.length){const o=t.useMediaCoordinateSpace({context:t}=>(t.font=i.R,Math.round(i.Fi.Mi(t,n(this.Et).Zt,eh))));if(!(o<=0)){const s=i.Wi,f=o+2*s,e=f/2,h=this.Et.ji;let u=this.Et.Si,r=Math.floor(u-e)+.5;r<0?(u+=Math.abs(0-r),r=Math.floor(u-e)+.5):r+f>h&&(u-=Math.abs(h-(r+f)),r=Math.floor(u-e)+.5);const c=r+f,l=Math.ceil(0+i.C+i.T+i.L+i.P+i.A);t.useBitmapCoordinateSpace({context:f,horizontalPixelRatio:t,verticalPixelRatio:u}=>{const s=n(this.Et);f.fillStyle=s.t;const h=Math.round(r*t),v=Math.round(0*u),a=Math.round(c*t),e=Math.round(l*u),o=Math.round(2*t);if(f.beginPath(),f.moveTo(h,v),f.lineTo(h,e-o),f.arcTo(h,e,h+o,e,o),f.lineTo(a-o,e),f.arcTo(a,e,a,e-o,o),f.lineTo(a,v),f.fill(),s.hi){const r=Math.round(s.Si*t),n=v,e=Math.round((n+i.T)*u);f.fillStyle=s.O;const o=Math.max(1,Math.floor(t)),h=Math.floor(.5*t);f.fillRect(r-h,n,o,e-n)}});t.useMediaCoordinateSpace({context:t}=>{const u=n(this.Et),f=0+i.C+i.T+i.L+i.P/2;t.font=i.R;t.textAlign="left";t.textBaseline="middle";t.fillStyle=u.O;const e=i.Fi.gi(t,"Apr0");t.translate(r+s,f+e);t.fillText(u.Zt,0,0)})}}}}class oh{constructor(n,t,i){this.ft=!0;this.Wt=new cf;this.Ft={kt:!1,t:"#4c525e",O:"white",Zt:"",ji:0,Si:NaN,hi:!0};this.vt=n;this.Hi=t;this.Ii=i}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const t=this.Ft;if(t.kt=!1,2!==this.vt.W().mode){const r=this.vt.W().vertLine;if(r.labelVisible){const i=this.Hi.St();if(!i.Li()){t.ji=i.ji();const u=this.Ii();if(null!==u){t.Si=u.Si;const e=i.$i(this.vt.xt());t.Zt=i.Ui(n(e));t.kt=!0;const f=kt(r.labelBackgroundColor);t.t=f.t;t.O=f.i;t.hi=i.W().ticksVisible}}}}}}class gi{constructor(){this.qi=null;this.Yi=0}Xi(){return this.Yi}Ki(n){this.Yi=n}Dt(){return this.qi}Zi(n){this.qi=n}Gi(){return[]}Ji(){return[]}kt(){return!0}}!function(n){n[n.Normal=0]="Normal";n[n.Magnet=1]="Magnet";n[n.Hidden=2]="Hidden"}(nr||(nr={}));class sh extends gi{constructor(t,i){super();this.Qi=null;this.tn=NaN;this.nn=0;this.sn=!0;this.en=new Map;this.rn=!1;this.hn=NaN;this.ln=NaN;this.an=NaN;this.on=NaN;this.Hi=t;this._n=i;this.un=new th(t,this);this.cn=((t,i)=>r=>{const u=i(),f=t();if(r===n(this.Qi).dn())return{_t:f,Si:u};{const t=n(r.Ct());return{_t:r.fn(u,t),Si:u}}})(()=>this.tn,()=>this.ln);const r=((n,t)=>()=>{const i=this.Hi.St().vn(n()),r=t();return i&&Number.isFinite(r)?{ot:i,Si:r}:null})(()=>this.nn,()=>this.Yt());this.pn=new oh(this,t,r);this.mn=new rh(this)}W(){return this._n}bn(n,t){this.an=n;this.on=t}wn(){this.an=NaN;this.on=NaN}gn(){return this.an}Mn(){return this.on}xn(n,t,i){this.rn||(this.rn=!0);this.sn=!0;this.Sn(n,t,i)}xt(){return this.nn}Yt(){return this.hn}Xt(){return this.ln}kt(){return this.sn}yn(){this.sn=!1;this.kn();this.tn=NaN;this.hn=NaN;this.ln=NaN;this.Qi=null;this.wn()}Cn(){return null!==this.Qi?[this.mn,this.un]:[]}Ut(n){return n===this.Qi&&this._n.horzLine.visible}qt(){return this._n.vertLine.visible}Tn(n,t){this.sn&&this.Qi===n||this.en.clear();const i=[];return this.Qi===n&&i.push(this.Pn(this.en,t,this.cn)),i}Ji(){return this.sn?[this.pn]:[]}Ht(){return this.Qi}Rn(){this.mn.bt();this.en.forEach(n=>n.bt());this.pn.bt();this.un.bt()}Dn(n){return n&&!n.dn().Li()?n.dn():null}Sn(n,t,i){this.On(n,t,i)&&this.Rn()}On(n,t,i){const f=this.hn,e=this.ln,o=this.tn,s=this.nn,h=this.Qi,r=this.Dn(i);this.nn=n;this.hn=isNaN(n)?NaN:this.Hi.St().zt(n);this.Qi=i;const u=null!==r?r.Ct():null;return null!==r&&null!==u?(this.tn=t,this.ln=r.Rt(t,u)):(this.tn=NaN,this.ln=NaN),f!==this.hn||e!==this.ln||s!==this.nn||o!==this.tn||h!==this.Qi}kn(){const n=this.Hi.wt().map(n=>n.An().Bn()).filter(bs),t=0===n.length?null:Math.max(...n);this.nn=null!==t?t:NaN}Pn(n,t,i){let r=n.get(t);return void 0===r&&(r=new fh(this,t,i),n.set(t,r)),r}}class r{constructor(n){this.Vn=new Map;this.zn=[];this.En=n}In(n,t){const i=function(n,t){return void 0===n?t:{Ln:Math.max(n.Ln,t.Ln),Nn:n.Nn||t.Nn}}(this.Vn.get(n),t);this.Vn.set(n,i)}Fn(){return this.En}Wn(n){const t=this.Vn.get(n);return void 0===t?{Ln:this.En}:{Ln:Math.max(this.En,t.Ln),Nn:t.Nn}}jn(){this.Hn();this.zn=[{$n:0}]}Un(n){this.Hn();this.zn=[{$n:1,Ot:n}]}qn(n){this.Yn();this.zn.push({$n:5,Ot:n})}Hn(){this.Yn();this.zn.push({$n:6})}Xn(){this.Hn();this.zn=[{$n:4}]}Kn(n){this.Hn();this.zn.push({$n:2,Ot:n})}Zn(n){this.Hn();this.zn.push({$n:3,Ot:n})}Gn(){return this.zn}Jn(n){for(const t of n.zn)this.Qn(t);this.En=Math.max(this.En,n.En);n.Vn.forEach((n,t)=>{this.In(t,n)})}static ts(){return new r(2)}static ns(){return new r(3)}Qn(n){switch(n.$n){case 0:this.jn();break;case 1:this.Un(n.Ot);break;case 2:this.Kn(n.Ot);break;case 3:this.Zn(n.Ot);break;case 4:this.Xn();break;case 5:this.qn(n.Ot);break;case 6:this.Yn()}}Yn(){const n=this.zn.findIndex(n=>5===n.$n);-1!==n&&this.zn.splice(n,1)}}const lf=".";class ii{constructor(n,t){if(t||(t=1),h(n)&&ft(n)||(n=100),n<0)throw new TypeError("invalid base");this.Ei=n;this.ss=t;this.es()}format(n){const t=n<0?"−":"";return n=Math.abs(n),t+this.rs(n)}es(){if(this.hs=0,this.Ei>0&&this.ss>0){let n=this.Ei;for(;n>1;)n/=10,this.hs++}}rs(n){const t=this.Ei/this.ss;let i=Math.floor(n),r="";const u=void 0!==this.hs?this.hs:NaN;if(t>1){let f=+(Math.round(n*t)-i*t).toFixed(this.hs);f>=t&&(f-=t,i+=1);r=lf+a(+f.toFixed(this.hs)*this.ss,u)}else i=Math.round(i*t)/t,u>0&&(r=lf+a(0,u));return i.toFixed(0)+r}}class af extends ii{constructor(n=100){super(n)}format(n){return`${super.format(n)}%`}}class hh{constructor(n){this.ls=n}format(n){let t="";return n<0&&(t="-",n=-n),n<995?t+this.os(n):n<999995?t+this.os(n/1e3)+"K":n<999999995?(n=1e3*Math.round(n/1e3),t+this.os(n/1e6)+"M"):(n=1e6*Math.round(n/1e6),t+this.os(n/1e9)+"B")}os(n){let t;const i=Math.pow(10,this.ls);return t=(n=Math.round(n*i)/i)>=1e-15&&n<1?n.toFixed(this.ls).replace(/\.?0+$/,""):String(n),t.replace(/(\.[1-9]*)0+$/,(n,t)=>t)}}const yf=6;class wf extends s{constructor(){super(...arguments);this.G=null}J(n){this.G=n}Z(n){var i;if(null!==this.G){const{it:u,tt:r,_s:f,et:e,Nt:o,us:s}=this.G,h=null!==(i=this.G.cs)&&void 0!==i?i:this.G.ds?0:n.mediaSize.height;if(null!==r){const t=n.context;t.lineCap="butt";t.lineJoin="round";t.lineWidth=e;p(t,o);t.lineWidth=1;vf(n,u,s,r,f,this.fs.bind(this),lh.bind(null,h))}}}}class rr{vs(n,t){const i=this.ps,{bs:f,ws:e,gs:o,Ms:s,xs:r,cs:u}=t;if(void 0===this.Ss||void 0===i||i.bs!==f||i.ws!==e||i.gs!==o||i.Ms!==s||i.cs!==u||i.xs!==r){const i=n.context.createLinearGradient(0,0,0,r);if(i.addColorStop(0,f),null!=u){const t=ir(u*n.verticalPixelRatio/r,0,1);i.addColorStop(t,e);i.addColorStop(t,o)}i.addColorStop(1,s);this.Ss=i;this.ps=t}return this.Ss}}class ah extends wf{constructor(){super(...arguments);this.ys=new rr}fs(n,t){return this.ys.vs(n,{bs:t.ks,ws:"",gs:"",Ms:t.Cs,xs:n.bitmapSize.height})}}class kf extends s{constructor(){super(...arguments);this.G=null}J(n){this.G=n}Z(n){if(null!==this.G){const{it:r,tt:i,_s:o,us:u,et:s,Nt:h,Ts:f}=this.G;if(null!==i){const t=n.context;t.lineCap="butt";t.lineWidth=s*n.verticalPixelRatio;p(t,h);t.lineJoin="round";const e=this.Ps.bind(this);void 0!==u&&vf(n,r,u,i,o,e,vh);f&&function(n,t,i,r,u){const{horizontalPixelRatio:o,verticalPixelRatio:s,context:f}=n;let e=null;const h=Math.max(1,Math.floor(o))%2/2,c=i*s+h;for(let i=r.to-1;i>=r.from;--i){const r=t[i];if(r){const t=u(n,r);t!==e&&(f.beginPath(),null!==e&&f.fill(),f.fillStyle=t,e=t);const i=Math.round(r.nt*o)+h,l=r.st*s;f.moveTo(i,l);f.arc(i,l,c,0,2*Math.PI)}}f.fill()}(n,r,f,i,e)}}}}class df extends kf{Ps(n,t){return t.lt}}const st=gf.bind(null,!0),ne=gf.bind(null,!1);class ur{constructor(n,t,i){this.Ds=!0;this.Os=!0;this.Bs=!0;this.As=[];this.Vs=null;this.zs=n;this.Es=t;this.Is=i}bt(n){this.Ds=!0;"data"===n&&(this.Os=!0);"options"===n&&(this.Bs=!0)}gt(){return this.zs.kt()?(this.Ls(),null===this.Vs?null:this.Ns):null}Fs(){this.As=this.As.map(n=>Object.assign(Object.assign({},n),this.zs.js().Ws(n.ot)))}Hs(){this.Vs=null}Ls(){this.Os&&(this.$s(),this.Os=!1);this.Bs&&(this.Fs(),this.Bs=!1);this.Ds&&(this.Us(),this.Ds=!1)}Us(){const t=this.zs.Dt(),n=this.Es.St();if(this.Hs(),!n.Li()&&!t.Li()){const i=n.qs();if(null!==i&&0!==this.zs.An().Ys()){const r=this.zs.Ct();null!==r&&(this.Vs=te(this.As,i,this.Is),this.Xs(t,n,r.Ot),this.Ks())}}}}class ui extends ur{constructor(n,t){super(n,t,!0)}Xs(n,t,i){t.Zs(this.As,ot(this.Vs));n.Gs(this.As,i,ot(this.Vs))}Js(n,t){return{ot:n,_t:t,nt:NaN,st:NaN}}$s(){const n=this.zs.js();this.As=this.zs.An().Qs().map(t=>{const i=t.Ot[3];return this.te(t.ie,i,n)})}}class wh extends ui{constructor(n,t){super(n,t);this.Ns=new di;this.ne=new ah;this.se=new df;this.Ns.X([this.ne,this.se])}te(n,t,i){return Object.assign(Object.assign({},this.Js(n,t)),i.Ws(n))}Ks(){const n=this.zs.W();this.ne.J({us:n.lineType,it:this.As,Nt:n.lineStyle,et:n.lineWidth,cs:null,ds:n.invertFilledArea,tt:this.Vs,_s:this.Es.St().ee()});this.se.J({us:n.lineVisible?n.lineType:void 0,it:this.As,Nt:n.lineStyle,et:n.lineWidth,tt:this.Vs,_s:this.Es.St().ee(),Ts:n.pointMarkersVisible?n.pointMarkersRadius||n.lineWidth/2+2:void 0})}}class bh extends s{constructor(){super(...arguments);this.Et=null;this.re=0;this.he=0}J(n){this.Et=n}Z({context:i,horizontalPixelRatio:n,verticalPixelRatio:t}){if(null!==this.Et&&0!==this.Et.An.length&&null!==this.Et.tt){(this.re=this.le(n),this.re>=2)&&Math.max(1,Math.floor(n))%2!=this.re%2&&this.re--;this.he=this.Et.ae?Math.min(this.re,Math.floor(n)):this.re;let r=null;const u=this.he<=this.re&&this.Et.ee>=Math.floor(1.5*n);for(let f=this.Et.tt.from;f<this.Et.tt.to;++f){const e=this.Et.An[f];r!==e.oe&&(i.fillStyle=e.oe,r=e.oe);const h=Math.floor(.5*this.he),l=Math.round(e.nt*n),a=l-h,s=this.he,v=a+s-1,p=Math.min(e._e,e.ue),w=Math.max(e._e,e.ue),o=Math.round(p*t)-h,b=Math.round(w*t)+h,c=Math.max(b-o,this.he);i.fillRect(a,o,s,c);const y=Math.ceil(1.5*this.re);if(u){if(this.Et.ce){const u=l-y;let n=Math.max(o,Math.round(e.de*t)-h),r=n+s-1;r>o+c-1&&(r=o+c-1,n=r-s+1);i.fillRect(u,n,a-u,r-n+1)}const u=l+y;let n=Math.max(o,Math.round(e.fe*t)-h),r=n+s-1;r>o+c-1&&(r=o+c-1,n=r-s+1);i.fillRect(v+1,n,u-v,r-n+1)}}}}le(t){const i=Math.floor(t);return Math.max(i,Math.floor(function(n,t){return Math.floor(.3*n*t)}(n(this.Et).ee,t)))}}class ie extends ur{constructor(n,t){super(n,t,!1)}Xs(n,t,i){t.Zs(this.As,ot(this.Vs));n.ve(this.As,i,ot(this.Vs))}pe(n,t){return{ot:n,me:t.Ot[0],be:t.Ot[1],we:t.Ot[2],ge:t.Ot[3],nt:NaN,de:NaN,_e:NaN,ue:NaN,fe:NaN}}$s(){const n=this.zs.js();this.As=this.zs.An().Qs().map(t=>this.te(t.ie,t,n))}}class kh extends ie{constructor(){super(...arguments);this.Ns=new bh}te(n,t,i){return Object.assign(Object.assign({},this.pe(n,t,i)),i.Ws(n))}Ks(){const n=this.zs.W();this.Ns.J({An:this.As,ee:this.Es.St().ee(),ce:n.openVisible,ae:n.thinBars,tt:this.Vs})}}class dh extends wf{constructor(){super(...arguments);this.ys=new rr}fs(n,t){const i=this.G;return this.ys.vs(n,{bs:t.Me,ws:t.xe,gs:t.Se,Ms:t.ye,xs:n.bitmapSize.height,cs:i.cs})}}class gh extends kf{constructor(){super(...arguments);this.ke=new rr}Ps(n,t){const i=this.G;return this.ke.vs(n,{bs:t.Ce,ws:t.Ce,gs:t.Te,Ms:t.Te,xs:n.bitmapSize.height,cs:i.cs})}}class nc extends ui{constructor(n,t){super(n,t);this.Ns=new di;this.Pe=new dh;this.Re=new gh;this.Ns.X([this.Pe,this.Re])}te(n,t,i){return Object.assign(Object.assign({},this.Js(n,t)),i.Ws(n))}Ks(){const t=this.zs.Ct();if(null!==t){const n=this.zs.W(),i=this.zs.Dt().Rt(n.baseValue.price,t.Ot),r=this.Es.St().ee();this.Pe.J({it:this.As,et:n.lineWidth,Nt:n.lineStyle,us:n.lineType,cs:i,ds:!1,tt:this.Vs,_s:r});this.Re.J({it:this.As,et:n.lineWidth,Nt:n.lineStyle,us:n.lineVisible?n.lineType:void 0,Ts:n.pointMarkersVisible?n.pointMarkersRadius||n.lineWidth/2+2:void 0,cs:i,tt:this.Vs,_s:r})}}}class tc extends s{constructor(){super(...arguments);this.Et=null;this.re=0}J(n){this.Et=n}Z(n){if(null!==this.Et&&0!==this.Et.An.length&&null!==this.Et.tt){const{horizontalPixelRatio:t}=n;(this.re=function(n,t){if(n>=2.5&&n<=4)return Math.floor(3*t);const i=1-.2*Math.atan(Math.max(4,n)-4)/(.5*Math.PI),r=Math.floor(n*i*t),u=Math.floor(n*t),f=Math.min(r,u);return Math.max(Math.floor(t),f)}(this.Et.ee,t),this.re>=2)&&Math.floor(t)%2!=this.re%2&&this.re--;const i=this.Et.An;this.Et.De&&this.Oe(n,i,this.Et.tt);this.Et._i&&this.Be(n,i,this.Et.tt);const r=this.Ae(t);(!this.Et._i||this.re>2*r)&&this.Ve(n,i,this.Et.tt)}}Oe(n,t,i){if(null!==this.Et){const{context:e,horizontalPixelRatio:r,verticalPixelRatio:u}=n;let s="",f=Math.min(Math.floor(r),Math.floor(this.Et.ee*r));f=Math.max(Math.floor(r),Math.min(f,this.re));const h=Math.floor(.5*f);let o=null;for(let n=i.from;n<i.to;n++){const i=t[n];i.ze!==s&&(e.fillStyle=i.ze,s=i.ze);const p=Math.round(Math.min(i.de,i.fe)*u),a=Math.round(Math.max(i.de,i.fe)*u),v=Math.round(i._e*u),w=Math.round(i.ue*u);let c=Math.round(r*i.nt)-h;const l=c+f-1;null!==o&&(c=Math.max(o+1,c),c=Math.min(c,l));const y=l-c+1;e.fillRect(c,v,y,p-v);e.fillRect(c,a+1,y,w-a);o=l}}}Ae(n){let t=Math.floor(1*n);this.re<=2*t&&(t=Math.floor(.5*(this.re-1)));const i=Math.max(Math.floor(n),t);return this.re<=2*i?Math.max(Math.floor(n),Math.floor(1*n)):i}Be(n,t,i){if(null!==this.Et){const{context:r,horizontalPixelRatio:u,verticalPixelRatio:e}=n;let o="";const s=this.Ae(u);let f=null;for(let n=i.from;n<i.to;n++){const h=t[n];h.Ee!==o&&(r.fillStyle=h.Ee,o=h.Ee);let i=Math.round(h.nt*u)-Math.floor(.5*this.re);const c=i+this.re-1,l=Math.round(Math.min(h.de,h.fe)*e),a=Math.round(Math.max(h.de,h.fe)*e);if(null!==f&&(i=Math.max(f+1,i),i=Math.min(i,c)),this.Et.ee*u>2*s)uh(r,i,l,c-i+1,a-l+1,s);else{const n=c-i+1;r.fillRect(i,l,n,a-l+1)}f=c}}}Ve(n,t,i){if(null!==this.Et){const{context:u,horizontalPixelRatio:f,verticalPixelRatio:e}=n;let o="";const r=this.Ae(f);for(let n=i.from;n<i.to;n++){const i=t[n];let s=Math.round(Math.min(i.de,i.fe)*e),c=Math.round(Math.max(i.de,i.fe)*e),h=Math.round(i.nt*f)-Math.floor(.5*this.re),l=h+this.re-1;if(i.oe!==o){const n=i.oe;u.fillStyle=n;o=n}this.Et._i&&(h+=r,s+=r,l-=r,c-=r);s>c||u.fillRect(h,s,l-h+1,c-s+1)}}}}class ic extends ie{constructor(){super(...arguments);this.Ns=new tc}te(n,t,i){return Object.assign(Object.assign({},this.pe(n,t,i)),i.Ws(n))}Ks(){const n=this.zs.W();this.Ns.J({An:this.As,ee:this.Es.St().ee(),De:n.wickVisible,_i:n.borderVisible,tt:this.Vs})}}class rc{constructor(n,t){this.Ie=n;this.Ei=t}K(n,t,i){this.Ie.draw(n,this.Ei,t,i)}}class fr extends ur{constructor(n,t,i){super(n,t,!1);this.mn=i;this.Ns=new rc(this.mn.renderer(),t=>{const i=n.Ct();return null===i?null:n.Dt().Rt(t,i.Ot)})}Le(n){return this.mn.priceValueBuilder(n)}Ne(n){return this.mn.isWhitespace(n)}$s(){const n=this.zs.js();this.As=this.zs.An().Qs().map(t=>Object.assign(Object.assign({ot:t.ie,nt:NaN},n.Ws(t.ie)),{Fe:t.We}))}Xs(n,t){t.Zs(this.As,ot(this.Vs))}Ks(){this.mn.update({bars:this.As.map(uc),barSpacing:this.Es.St().ee(),visibleRange:this.Vs},this.zs.W())}}class fc extends s{constructor(){super(...arguments);this.Et=null;this.je=[]}J(n){this.Et=n;this.je=[]}Z({context:i,horizontalPixelRatio:n,verticalPixelRatio:t}){if(null!==this.Et&&0!==this.Et.it.length&&null!==this.Et.tt){this.je.length||this.He(n);const r=Math.max(1,Math.floor(t)),u=Math.round(this.Et.$e*t)-Math.floor(r/2),f=u+r;for(let n=this.Et.tt.from;n<this.Et.tt.to;n++){const c=this.Et.it[n],o=this.je[n-this.Et.tt.from],s=Math.round(c.st*t);let e,h;i.fillStyle=c.oe;s<=u?(e=s,h=f):(e=u,h=s-Math.floor(r/2)+r);i.fillRect(o.Rs,e,o.ui-o.Rs+1,h-e)}}}He(n){if(null===this.Et||0===this.Et.it.length||null===this.Et.tt)return void(this.je=[]);const t=Math.ceil(this.Et.ee*n)<=1?0:Math.max(1,Math.floor(n)),r=Math.round(this.Et.ee*n)-t;this.je=new Array(this.Et.tt.to-this.Et.tt.from);for(let t=this.Et.tt.from;t<this.Et.tt.to;t++){const u=this.Et.it[t],i=Math.round(u.nt*n);let f,e;if(r%2){const n=(r-1)/2;f=i-n;e=i+n}else{const n=r/2;f=i-n;e=i+n-1}this.je[t-this.Et.tt.from]={Rs:f,ui:e,Ue:i,qe:u.nt*n,ot:u.ot}}for(let n=this.Et.tt.from+1;n<this.Et.tt.to;n++){const r=this.je[n-this.Et.tt.from],i=this.je[n-this.Et.tt.from-1];r.ot===i.ot+1&&r.Rs-i.ui!==t+1&&(i.Ue>i.qe?i.ui=r.Rs-t-1:r.Rs=i.ui+t+1)}let i=Math.ceil(this.Et.ee*n);for(let n=this.Et.tt.from;n<this.Et.tt.to;n++){const t=this.je[n-this.Et.tt.from];t.ui<t.Rs&&(t.ui=t.Rs);const r=t.ui-t.Rs+1;i=Math.min(r,i)}if(t>0&&i<4)for(let n=this.Et.tt.from;n<this.Et.tt.to;n++){const t=this.je[n-this.Et.tt.from];t.ui-t.Rs+1>i&&(t.Ue>t.qe?t.ui-=1:t.Rs+=1)}}}class ec extends ui{constructor(){super(...arguments);this.Ns=new fc}te(n,t,i){return Object.assign(Object.assign({},this.Js(n,t)),i.Ws(n))}Ks(){const t={it:this.As,ee:this.Es.St().ee(),tt:this.Vs,$e:this.zs.Dt().Rt(this.zs.W().base,n(this.zs.Ct()).Ot)};this.Ns.J(t)}}class oc extends ui{constructor(){super(...arguments);this.Ns=new df}te(n,t,i){return Object.assign(Object.assign({},this.Js(n,t)),i.Ws(n))}Ks(){const n=this.zs.W(),t={it:this.As,Nt:n.lineStyle,us:n.lineVisible?n.lineType:void 0,et:n.lineWidth,Ts:n.pointMarkersVisible?n.pointMarkersRadius||n.lineWidth/2+2:void 0,tt:this.Vs,_s:this.Es.St().ee()};this.Ns.J(t)}}const sc=/[2-9]/g;class ht{constructor(n=50){this.Ye=0;this.Xe=1;this.Ke=1;this.Ze={};this.Ge=new Map;this.Je=n}Qe(){this.Ye=0;this.Ge.clear();this.Xe=1;this.Ke=1;this.Ze={}}Mi(n,t,i){return this.tr(n,t,i).width}gi(n,t,i){const r=this.tr(n,t,i);return((r.actualBoundingBoxAscent||0)-(r.actualBoundingBoxDescent||0))/2}tr(n,t,i){const e=i||sc,r=String(t).replace(e,"0");if(this.Ge.has(r))return u(this.Ge.get(r)).ir;if(this.Ye===this.Je){const n=this.Ze[this.Ke];delete this.Ze[this.Ke];this.Ge.delete(n);this.Ke++;this.Ye--}n.save();n.textBaseline="middle";const f=n.measureText(r);return n.restore(),0===f.width&&t.length||(this.Ge.set(r,{ir:f,nr:this.Xe}),this.Ze[this.Xe]=r,this.Ye++,this.Xe++),f}}class hc{constructor(n){this.sr=null;this.k=null;this.er="right";this.rr=n}hr(n,t,i){this.sr=n;this.k=t;this.er=i}K(n){null!==this.k&&null!==this.sr&&this.sr.K(n,this.k,this.rr,this.er)}}class re{constructor(n,t,i){this.lr=n;this.rr=new ht(50);this.ar=t;this.F=i;this.j=-1;this.Wt=new hc(this.rr)}gt(){const n=this.F._r(this.ar);if(null===n)return null;const i=n.ur(this.ar)?n.cr():this.ar.Dt();if(null===i)return null;const r=n.dr(i);if("overlay"===r)return null;const t=this.F.vr();return t.P!==this.j&&(this.j=t.P,this.rr.Qe()),this.Wt.hr(this.lr.Vi(),t,r),this.Wt}}class cc extends s{constructor(){super(...arguments);this.Et=null}J(n){this.Et=n}pr(n,t){var i;if(!(null===(i=this.Et)||void 0===i?void 0:i.kt))return null;const{st:r,et:u,mr:f}=this.Et;return t>=r-u-7&&t<=r+u+7?{br:this.Et,mr:f}:null}Z({context:r,bitmapSize:n,horizontalPixelRatio:t,verticalPixelRatio:i}){if(null!==this.Et&&!1!==this.Et.kt){const u=Math.round(this.Et.st*i);u<0||u>n.height||(r.lineCap="butt",r.strokeStyle=this.Et.O,r.lineWidth=Math.floor(this.Et.et*t),p(r,this.Et.Nt),rf(r,u,0,n.width))}}}class er{constructor(n){this.wr={st:0,O:"rgba(0, 0, 0, 0)",et:1,Nt:0,kt:!1};this.gr=new cc;this.ft=!0;this.zs=n;this.Es=n.$t();this.gr.J(this.wr)}bt(){this.ft=!0}gt(){return this.zs.kt()?(this.ft&&(this.Mr(),this.ft=!1),this.gr):null}}class lc extends er{constructor(n){super(n)}Mr(){this.wr.kt=!1;const i=this.zs.Dt(),r=i.Sr().Sr;if(2===r||3===r){const n=this.zs.W();if(n.baseLineVisible&&this.zs.kt()){const t=this.zs.Ct();null!==t&&(this.wr.kt=!0,this.wr.st=i.Rt(t.Ot,t.Ot),this.wr.O=n.baseLineColor,this.wr.et=n.baseLineWidth,this.wr.Nt=n.baseLineStyle)}}}}class ac extends s{constructor(){super(...arguments);this.Et=null}J(n){this.Et=n}We(){return this.Et}Z({context:i,horizontalPixelRatio:n,verticalPixelRatio:t}){const r=this.Et;if(null!==r){const u=Math.max(1,Math.floor(n)),o=u%2/2,f=Math.round(r.qe.x*n)+o,e=r.qe.y*t;i.fillStyle=r.yr;i.beginPath();const s=Math.max(2,1.5*r.kr)*n;i.arc(f,e,s,0,2*Math.PI,!1);i.fill();i.fillStyle=r.Cr;i.beginPath();i.arc(f,e,r.ht*n,0,2*Math.PI,!1);i.fill();i.lineWidth=u;i.strokeStyle=r.Tr;i.beginPath();i.arc(f,e,r.ht*n+u/2,0,2*Math.PI,!1);i.stroke()}}}const vc=[{Pr:0,Rr:.25,Dr:4,Or:10,Br:.25,Ar:0,Vr:.4,zr:.8},{Pr:.25,Rr:.525,Dr:10,Or:14,Br:0,Ar:0,Vr:.8,zr:0},{Pr:.525,Rr:1,Dr:14,Or:14,Br:0,Ar:0,Vr:0,zr:0}];class yc{constructor(n){this.Wt=new ac;this.ft=!0;this.Er=!0;this.Ir=performance.now();this.Lr=this.Ir-1;this.Nr=n}Fr(){this.Lr=this.Ir-1;this.bt()}Wr(){if(this.bt(),2===this.Nr.W().lastPriceAnimation){const n=performance.now(),t=this.Lr-n;if(t>0)return void(t<650&&(this.Lr+=2600));this.Ir=n;this.Lr=n+2600}}bt(){this.ft=!0}jr(){this.Er=!0}kt(){return 0!==this.Nr.W().lastPriceAnimation}Hr(){switch(this.Nr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Lr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Er=!1):this.Er&&(this.$r(),this.Er=!1),this.Wt}Mt(){this.Wt.J(null);const i=this.Nr.$t().St(),r=i.qs(),u=this.Nr.Ct();if(null!==r&&null!==u){const n=this.Nr.Ur(!0);if(!n.qr&&r.Yr(n.ie)){const e={x:i.zt(n.ie),y:this.Nr.Dt().Rt(n._t,u.Ot)},f=n.O,o=this.Nr.W().lineWidth,t=fe(this.Xr(),f);this.Wt.J({yr:f,kr:o,Cr:t.Cr,Tr:t.Tr,ht:t.ht,qe:e})}}}$r(){const n=this.Wt.We();if(null!==n){const t=fe(this.Xr(),n.yr);n.Cr=t.Cr;n.Tr=t.Tr;n.ht=t.ht}}Xr(){return this.Hr()?performance.now()-this.Ir:2599}}class wc extends s{constructor(){super(...arguments);this.Et=null;this.rr=new ht;this.j=-1;this.H="";this.Zr=""}J(n){this.Et=n}hr(n,t){this.j===n&&this.H===t||(this.j=n,this.H=t,this.Zr=tt(n,t),this.rr.Qe())}pr(n,t){if(null===this.Et||null===this.Et.tt)return null;for(let i=this.Et.tt.from;i<this.Et.tt.to;i++){const r=this.Et.it[i];if(kc(r,n,t))return{br:r.Gr,mr:r.mr}}return null}Z({context:i,horizontalPixelRatio:n,verticalPixelRatio:t}){if(null!==this.Et&&null!==this.Et.tt){i.textBaseline="middle";i.font=this.Zr;for(let r=this.Et.tt.from;r<this.Et.tt.to;r++){const u=this.Et.it[r];void 0!==u.Zt&&(u.Zt.ji=this.rr.Mi(i,u.Zt.Jr),u.Zt.Vt=this.j,u.Zt.nt=u.nt-u.Zt.ji/2);bc(u,i,n,t)}}}}class gc{constructor(n,t){this.ft=!0;this.nh=!0;this.sh=!0;this.eh=null;this.rh=null;this.Wt=new wc;this.Nr=n;this.Hi=t;this.Et={it:[],tt:null}}bt(n){this.ft=!0;this.sh=!0;"data"===n&&(this.nh=!0,this.rh=null)}gt(){if(!this.Nr.kt())return null;this.ft&&this.hh();const n=this.Hi.W().layout;return this.Wt.hr(n.fontSize,n.fontFamily),this.Wt.J(this.Et),this.Wt}lh(){if(this.sh){if(this.Nr.ah().length>0){const t=this.Hi.St().ee(),r=oe(t),i=1.5*ee(t)+2*r,n=this.oh();this.eh={above:se(i,n.aboveBar,n.inBar),below:se(i,n.belowBar,n.inBar)}}else this.eh=null;this.sh=!1}return this.eh}oh(){return null===this.rh&&(this.rh=this.Nr.ah().reduce((n,t)=>(n[t.position]||(n[t.position]=!0),n),{inBar:!1,aboveBar:!1,belowBar:!1})),this.rh}hh(){const o=this.Nr.Dt(),t=this.Hi.St(),r=this.Nr.ah();this.nh&&(this.Et.it=r.map(n=>({ot:n.time,nt:0,st:0,Ys:0,Qr:n.shape,O:n.color,Gr:n.Gr,mr:n.id,Zt:void 0})),this.nh=!1);const s=this.Hi.W().layout;this.Et.tt=null;const u=t.qs();if(null!==u){const f=this.Nr.Ct();if(null!==f&&0!==this.Et.it.length){let e=NaN;const n=oe(t.ee()),i={th:n,ih:n};this.Et.tt=te(this.Et.it,u,!0);for(let u=this.Et.tt.from;u<this.Et.tt.to;u++){const h=r[u];h.time!==e&&(i.th=n,i.ih=n,e=h.time);const c=this.Et.it[u];c.nt=t.zt(h.time);void 0!==h.text&&h.text.length>0&&(c.Zt={Jr:h.text,nt:0,st:0,ji:0,Vt:0});const l=this.Nr._h(h.time);null!==l&&dc(c,h,l,i,s.fontSize,n,o,t,f.Ot)}this.ft=!1}}}}class nl extends er{constructor(n){super(n)}Mr(){const n=this.wr;n.kt=!1;const t=this.zs.W();if(t.priceLineVisible&&this.zs.kt()){const i=this.zs.Ur(0===t.priceLineSource);i.qr||(n.kt=!0,n.st=i.Si,n.O=this.zs.uh(i.O),n.et=t.priceLineWidth,n.Nt=t.priceLineStyle)}}}class tl extends ni{constructor(n){super();this.jt=n}zi(n,t,i){n.kt=!1;t.kt=!1;const r=this.jt;if(r.kt()){const s=r.W(),f=s.lastValueVisible,h=""!==r.dh(),e=0===s.seriesLastValueMode,u=r.Ur(!1);if(!u.qr){f&&(n.Zt=this.fh(u,f,e),n.kt=0!==n.Zt.length);(h||e)&&(t.Zt=this.ph(u,f,h,e),t.kt=t.Zt.length>0);const c=r.uh(u.O),o=kt(c);i.t=o.t;i.Si=u.Si;t.Bt=r.$t().At(u.Si/r.Dt().Vt());n.Bt=c;n.O=o.i;t.O=o.i}}}ph(n,t,i,r){let u="";const f=this.jt.dh();return i&&0!==f.length&&(u+=`${f} `),t&&r&&(u+=this.jt.Dt().mh()?n.bh:n.wh),u.trim()}fh(n,t,i){return t?i?this.jt.Dt().mh()?n.wh:n.bh:n.Zt:""}}class f{constructor(n,t){this.gh=n;this.Mh=t}xh(n){return null!==n&&this.gh===n.gh&&this.Mh===n.Mh}Sh(){return new f(this.gh,this.Mh)}yh(){return this.gh}kh(){return this.Mh}Ch(){return this.Mh-this.gh}Li(){return this.Mh===this.gh||Number.isNaN(this.Mh)||Number.isNaN(this.gh)}Jn(n){return null===n?this:new f(le(Math.min,this.yh(),n.yh(),-1/0),le(Math.max,this.kh(),n.kh(),1/0))}Th(n){if(h(n)&&0!=this.Mh-this.gh){const t=.5*(this.Mh+this.gh);let i=this.Mh-t,r=this.gh-t;i*=n;r*=n;this.Mh=t+i;this.gh=t+r}}Ph(n){h(n)&&(this.Mh+=n,this.gh+=n)}Rh(){return{minValue:this.gh,maxValue:this.Mh}}static Dh(n){return null===n?null:new f(n.minValue,n.maxValue)}}class or{constructor(n,t){this.Oh=n;this.Bh=t||null}Ah(){return this.Oh}Vh(){return this.Bh}Rh(){return null===this.Oh?null:{priceRange:this.Oh.Rh(),margins:this.Bh||void 0}}static Dh(n){return null===n?null:new or(f.Dh(n.priceRange),n.margins)}}class il extends er{constructor(n,t){super(n);this.zh=t}Mr(){const n=this.wr;n.kt=!1;const t=this.zh.W();if(this.zs.kt()&&t.lineVisible){const i=this.zh.Eh();null!==i&&(n.kt=!0,n.st=i,n.O=t.color,n.et=t.lineWidth,n.Nt=t.lineStyle,n.mr=this.zh.W().id)}}}class rl extends ni{constructor(n,t){super();this.Nr=n;this.zh=t}zi(n,t,i){n.kt=!1;t.kt=!1;const r=this.zh.W(),s=r.axisLabelVisible,h=""!==r.title,u=this.Nr;if(s&&u.kt()){const f=this.zh.Eh();if(null!==f){h&&(t.Zt=r.title,t.kt=!0);t.Bt=u.$t().At(f/u.Dt().Vt());n.Zt=this.Ih(r.price);n.kt=!0;const e=kt(r.axisLabelColor||r.color);i.t=e.t;const o=r.axisLabelTextColor||e.i;n.O=o;t.O=o;i.Si=f}}}Ih(n){const t=this.Nr.Ct();return null===t?"":this.Nr.Dt().Ni(n,t.Ot)}}class ul{constructor(n,t){this.Nr=n;this._n=t;this.Lh=new il(n,this);this.lr=new rl(n,this);this.Nh=new re(this.lr,n,n.$t())}Fh(n){o(this._n,n);this.bt();this.Nr.$t().Wh()}W(){return this._n}jh(){return this.Lh}Hh(){return this.Nh}$h(){return this.lr}bt(){this.Lh.bt();this.lr.bt()}Eh(){const n=this.Nr,t=n.Dt();if(n.$t().St().Li()||t.Li())return null;const i=n.Ct();return null===i?null:t.Rt(this._n.price,i.Ot)}}class fl extends gi{constructor(n){super();this.Hi=n}$t(){return this.Hi}}const el={Bar:(t,i,r,u)=>{var f;const o=i.upColor,s=i.downColor,e=n(t(r,u)),h=nt(e.Ot[0])<=nt(e.Ot[3]);return{oe:null!==(f=e.O)&&void 0!==f?f:h?o:s}},Candlestick:(t,i,r,u)=>{var e,o,s;const c=i.upColor,l=i.downColor,a=i.borderUpColor,v=i.borderDownColor,y=i.wickUpColor,p=i.wickDownColor,f=n(t(r,u)),h=nt(f.Ot[0])<=nt(f.Ot[3]);return{oe:null!==(e=f.O)&&void 0!==e?e:h?c:l,Ee:null!==(o=f.Bt)&&void 0!==o?o:h?a:v,ze:null!==(s=f.Uh)&&void 0!==s?s:h?y:p}},Custom:(t,i,r,u)=>{var f;return{oe:null!==(f=n(t(r,u)).O)&&void 0!==f?f:i.color}},Area:(t,i,r,u)=>{var e,o,s,h;const f=n(t(r,u));return{oe:null!==(e=f.lt)&&void 0!==e?e:i.lineColor,lt:null!==(o=f.lt)&&void 0!==o?o:i.lineColor,ks:null!==(s=f.ks)&&void 0!==s?s:i.topColor,Cs:null!==(h=f.Cs)&&void 0!==h?h:i.bottomColor}},Baseline:(t,i,r,u)=>{var e,o,s,h,c,l;const f=n(t(r,u));return{oe:f.Ot[3]>=i.baseValue.price?i.topLineColor:i.bottomLineColor,Ce:null!==(e=f.Ce)&&void 0!==e?e:i.topLineColor,Te:null!==(o=f.Te)&&void 0!==o?o:i.bottomLineColor,Me:null!==(s=f.Me)&&void 0!==s?s:i.topFillColor1,xe:null!==(h=f.xe)&&void 0!==h?h:i.topFillColor2,Se:null!==(c=f.Se)&&void 0!==c?c:i.bottomFillColor1,ye:null!==(l=f.ye)&&void 0!==l?l:i.bottomFillColor2}},Line:(t,i,r,u)=>{var f,e;const o=n(t(r,u));return{oe:null!==(f=o.O)&&void 0!==f?f:i.color,lt:null!==(e=o.O)&&void 0!==e?e:i.color}},Histogram:(t,i,r,u)=>{var f;return{oe:null!==(f=n(t(r,u)).O)&&void 0!==f?f:i.color}}};class ol{constructor(n){this.qh=(n,t)=>void 0!==t?t.Ot:this.Nr.An().Yh(n);this.Nr=n;this.Xh=el[n.Kh()]}Ws(n,t){return this.Xh(this.qh,this.Nr.W(),n,t)}}!function(n){n[n.NearestLeft=-1]="NearestLeft";n[n.None=0]="None";n[n.NearestRight=1]="NearestRight"}(sr||(sr={}));const y=30;class sl{constructor(){this.Zh=[];this.Gh=new Map;this.Jh=new Map}Qh(){return this.Ys()>0?this.Zh[this.Zh.length-1]:null}tl(){return this.Ys()>0?this.il(0):null}Bn(){return this.Ys()>0?this.il(this.Zh.length-1):null}Ys(){return this.Zh.length}Li(){return 0===this.Ys()}Yr(n){return null!==this.nl(n,0)}Yh(n){return this.sl(n)}sl(n,t=0){const i=this.nl(n,t);return null===i?null:Object.assign(Object.assign({},this.el(i)),{ie:this.il(i)})}Qs(){return this.Zh}rl(n,t,i){if(this.Li())return null;let r=null;for(const i of i)r=fi(r,this.hl(n,t,i));return r}J(n){this.Jh.clear();this.Gh.clear();this.Zh=n}il(n){return this.Zh[n].ie}el(n){return this.Zh[n]}nl(n,t){const i=this.ll(n);if(null===i&&0!==t)switch(t){case-1:return this.al(n);case 1:return this.ol(n);default:throw new TypeError("Unknown search mode");}return i}al(n){let t=this._l(n);return t>0&&(t-=1),t!==this.Zh.length&&this.il(t)<n?t:null}ol(n){const t=this.ul(n);return t!==this.Zh.length&&n<this.il(t)?t:null}ll(n){const t=this._l(n);return t===this.Zh.length||n<this.Zh[t].ie?null:t}_l(n){return st(this.Zh,n,(n,t)=>n.ie<t)}ul(n){return ne(this.Zh,n,(n,t)=>n.ie>t)}cl(n,t,i){let r=null;for(let u=n;u<t;u++){const n=this.Zh[u].Ot[i];Number.isNaN(n)||(null===r?r={dl:n,fl:n}:(n<r.dl&&(r.dl=n),n>r.fl&&(r.fl=n)))}return r}hl(t,i,r){if(this.Li())return null;let u=null;const c=n(this.tl()),l=n(this.Bn()),e=Math.max(t,c),o=Math.min(i,l),s=Math.ceil(e/y)*y,h=Math.max(s,Math.floor(o/y)*y);{const n=this._l(e),t=this.ul(Math.min(o,s,i));u=fi(u,this.cl(n,t,r))}let f=this.Gh.get(r);void 0===f&&(f=new Map,this.Gh.set(r,f));for(let n=Math.max(s+1,e);n<h;n+=y){const t=Math.floor(n/y);let i=f.get(t);if(void 0===i){const n=this._l(t*y),u=this.ul((t+1)*y-1);i=this.cl(n,u,r);f.set(t,i)}u=fi(u,i)}{const n=this._l(h),t=this.ul(o);u=fi(u,this.cl(n,t,r))}return u}}class hl{constructor(n){this.vl=n}K(n){this.vl.draw(n)}pl(n){var i,t;null===(t=(i=this.vl).drawBackground)||void 0===t||t.call(i,n)}}class hr{constructor(n){this.Ge=null;this.mn=n}gt(){var t;const n=this.mn.renderer();if(null===n)return null;if((null===(t=this.Ge)||void 0===t?void 0:t.ml)===n)return this.Ge.bl;const i=new hl(n);return this.Ge={ml:n,bl:i},i}wl(){var i,n,t;return null!==(t=null===(n=(i=this.mn).zOrder)||void 0===n?void 0:n.call(i))&&void 0!==t?t:"normal"}}class cl{constructor(n,t){this.Wt=new cf;this.gl=n;this.Ml=t}gt(){return this.Wt.J(Object.assign({ji:this.Ml.ji()},ae(this.gl))),this.Wt}}class ll extends ni{constructor(n,t){super();this.gl=n;this.Ei=t}zi(n,t,i){const r=ae(this.gl);i.t=r.t;n.O=r.O;const u=2/12*this.Ei.P();i.bi=u;i.wi=u;i.Si=r.Si;i.xi=r.xi;n.Zt=r.Zt;n.kt=r.kt;n.hi=r.hi}}class al{constructor(n,t){this.xl=null;this.Sl=null;this.yl=null;this.kl=null;this.Cl=null;this.Tl=n;this.Nr=t}Pl(){return this.Tl}Rn(){var t,n;null===(n=(t=this.Tl).updateAllViews)||void 0===n||n.call(t)}Cn(){var u,n,t,i;const r=null!==(t=null===(n=(u=this.Tl).paneViews)||void 0===n?void 0:n.call(u))&&void 0!==t?t:[];if((null===(i=this.xl)||void 0===i?void 0:i.ml)===r)return this.xl.bl;const f=r.map(n=>new hr(n));return this.xl={ml:r,bl:f},f}Ji(){var u,n,t,i;const r=null!==(t=null===(n=(u=this.Tl).timeAxisViews)||void 0===n?void 0:n.call(u))&&void 0!==t?t:[];if((null===(i=this.Sl)||void 0===i?void 0:i.ml)===r)return this.Sl.bl;const e=this.Nr.$t().St(),f=r.map(n=>new cl(n,e));return this.Sl={ml:r,bl:f},f}Tn(){var u,n,t,i;const r=null!==(t=null===(n=(u=this.Tl).priceAxisViews)||void 0===n?void 0:n.call(u))&&void 0!==t?t:[];if((null===(i=this.yl)||void 0===i?void 0:i.ml)===r)return this.yl.bl;const e=this.Nr.Dt(),f=r.map(n=>new ll(n,e));return this.yl={ml:r,bl:f},f}Rl(){var u,n,t,i;const r=null!==(t=null===(n=(u=this.Tl).priceAxisPaneViews)||void 0===n?void 0:n.call(u))&&void 0!==t?t:[];if((null===(i=this.kl)||void 0===i?void 0:i.ml)===r)return this.kl.bl;const f=r.map(n=>new hr(n));return this.kl={ml:r,bl:f},f}Dl(){var u,n,t,i;const r=null!==(t=null===(n=(u=this.Tl).timeAxisPaneViews)||void 0===n?void 0:n.call(u))&&void 0!==t?t:[];if((null===(i=this.Cl)||void 0===i?void 0:i.ml)===r)return this.Cl.bl;const f=r.map(n=>new hr(n));return this.Cl={ml:r,bl:f},f}Ol(n,t){var u,i,r;return null!==(r=null===(i=(u=this.Tl).autoscaleInfo)||void 0===i?void 0:i.call(u,n,t))&&void 0!==r?r:null}pr(n,t){var u,i,r;return null!==(r=null===(i=(u=this.Tl).hitTest)||void 0===i?void 0:i.call(u,n,t))&&void 0!==r?r:null}}class ar extends fl{constructor(n,t,i,r,u){super(n);this.Et=new sl;this.Lh=new nl(this);this.Bl=[];this.Al=new lc(this);this.Vl=null;this.zl=null;this.El=[];this.Il=[];this.Ll=null;this.Nl=[];this._n=t;this.Fl=i;const f=new tl(this);this.en=[f];this.Nh=new re(f,this,n);"Area"!==i&&"Line"!==i&&"Baseline"!==i||(this.Vl=new yc(this));this.Wl();this.jl(u)}S(){null!==this.Ll&&clearTimeout(this.Ll)}uh(n){return this._n.priceLineColor||n}Ur(n){const t={qr:!0},i=this.Dt();if(this.$t().St().Li()||i.Li()||this.Et.Li())return t;const o=this.$t().St().qs(),f=this.Ct();if(null===o||null===f)return t;let r,e;if(n){const n=this.Et.Qh();if(null===n)return t;r=n;e=n.ie}else{const n=this.Et.sl(o.ui(),-1);if(null===n||(r=this.Et.Yh(n.ie),null===r))return t;e=n.ie}const u=r.Ot[3],s=this.js().Ws(e,{Ot:r}),h=i.Rt(u,f.Ot);return{qr:!1,_t:u,Zt:i.Ni(u,f.Ot),bh:i.Hl(u),wh:i.$l(u,f.Ot),O:s.oe,Si:h,ie:e}}js(){return null!==this.zl||(this.zl=new ol(this)),this.zl}W(){return this._n}Fh(n){const t=n.priceScaleId;void 0!==t&&t!==this._n.priceScaleId&&this.$t().Ul(this,t);o(this._n,n);void 0!==n.priceFormat&&(this.Wl(),this.$t().ql());this.$t().Yl(this);this.$t().Xl();this.mn.bt("options")}J(n,t){this.Et.J(n);this.Kl();this.mn.bt("data");this.un.bt("data");null!==this.Vl&&(t&&t.Zl?this.Vl.Wr():0===n.length&&this.Vl.Fr());const i=this.$t()._r(this);this.$t().Gl(i);this.$t().Yl(this);this.$t().Xl();this.$t().Wh()}Jl(n){this.El=n;this.Kl();const t=this.$t()._r(this);this.un.bt("data");this.$t().Gl(t);this.$t().Yl(this);this.$t().Xl();this.$t().Wh()}Ql(){return this.El}ah(){return this.Il}ta(n){const t=new ul(this,n);return this.Bl.push(t),this.$t().Yl(this),t}ia(n){const t=this.Bl.indexOf(n);-1!==t&&this.Bl.splice(t,1);this.$t().Yl(this)}Kh(){return this.Fl}Ct(){const n=this.na();return null===n?null:{Ot:n.Ot[3],sa:n.ot}}na(){const n=this.$t().St().qs();if(null===n)return null;const t=n.Rs();return this.Et.sl(t,1)}An(){return this.Et}_h(n){const t=this.Et.Yh(n);return null===t?null:"Bar"===this.Fl||"Candlestick"===this.Fl||"Custom"===this.Fl?{me:t.Ot[0],be:t.Ot[1],we:t.Ot[2],ge:t.Ot[3]}:t.Ot[3]}ea(){const t=[];cr(this.Nl,lr,"top",t);const n=this.Vl;return null!==n&&n.kt()?(null===this.Ll&&n.Hr()&&(this.Ll=setTimeout(()=>{this.Ll=null,this.$t().ra()},0)),n.jr(),t.unshift(n),t):t}Cn(){const n=[];this.ha()||n.push(this.Al);n.push(this.mn,this.Lh,this.un);const t=this.Bl.map(n=>n.jh());return n.push(...t),cr(this.Nl,lr,"normal",n),n}la(){return this.aa(lr,"bottom")}oa(n){return this.aa(vl,n)}_a(n){return this.aa(yl,n)}ua(n,t){return this.Nl.map(i=>i.pr(n,t)).filter(n=>null!==n)}Gi(){return[this.Nh,...this.Bl.map(n=>n.Hh())]}Tn(n,t){if(t!==this.qi&&!this.ha())return[];const i=[...this.en];for(const n of this.Bl)i.push(n.$h());return this.Nl.forEach(n=>{i.push(...n.Tn())}),i}Ji(){const n=[];return this.Nl.forEach(t=>{n.push(...t.Ji())}),n}Ol(n,t){if(void 0!==this._n.autoscaleInfoProvider){const i=this._n.autoscaleInfoProvider(()=>{const i=this.ca(n,t);return null===i?null:i.Rh()});return or.Dh(i)}return this.ca(n,t)}da(){return this._n.priceFormat.minMove}fa(){return this.va}Rn(){var n;this.mn.bt();this.un.bt();for(const n of this.en)n.bt();for(const n of this.Bl)n.bt();this.Lh.bt();this.Al.bt();null===(n=this.Vl)||void 0===n||n.bt();this.Nl.forEach(n=>n.Rn())}Dt(){return n(super.Dt())}yt(n){if(!(("Line"===this.Fl||"Area"===this.Fl||"Baseline"===this.Fl)&&this._n.crosshairMarkerVisible))return null;const t=this.Et.Yh(n);return null===t?null:{_t:t.Ot[3],ht:this.pa(),Bt:this.ma(),Pt:this.ba(),Tt:this.wa(n)}}dh(){return this._n.title}kt(){return this._n.visible}ga(n){this.Nl.push(new al(n,this))}Ma(n){this.Nl=this.Nl.filter(t=>t.Pl()!==n)}xa(){if(this.mn instanceof fr!=!1)return n=>this.mn.Le(n)}Sa(){if(this.mn instanceof fr!=!1)return n=>this.mn.Ne(n)}ha(){return!ti(this.Dt().ya())}ca(n,t){if(!ft(n)||!ft(t)||this.Et.Li())return null;const e="Line"===this.Fl||"Area"===this.Fl||"Baseline"===this.Fl||"Histogram"===this.Fl?[3]:[2,1],r=this.Et.rl(n,t,e);let i=null!==r?new f(r.dl,r.fl):null;if("Histogram"===this.Kh()){const n=this._n.base,t=new f(n,n);i=null!==i?i.Jn(t):t}let u=this.un.lh();return this.Nl.forEach(r=>{const e=r.Ol(n,t);if(null==e?void 0:e.priceRange){const n=new f(e.priceRange.minValue,e.priceRange.maxValue);i=null!==i?i.Jn(n):n}var o,s,h,c;(null==e?void 0:e.margins)&&(o=u,s=e.margins,u={above:Math.max(null!==(h=null==o?void 0:o.above)&&void 0!==h?h:0,s.above),below:Math.max(null!==(c=null==o?void 0:o.below)&&void 0!==c?c:0,s.below)})}),new or(i,u)}pa(){switch(this.Fl){case"Line":case"Area":case"Baseline":return this._n.crosshairMarkerRadius}return 0}ma(){switch(this.Fl){case"Line":case"Area":case"Baseline":{const n=this._n.crosshairMarkerBorderColor;if(0!==n.length)return n}}return null}ba(){switch(this.Fl){case"Line":case"Area":case"Baseline":return this._n.crosshairMarkerBorderWidth}return 0}wa(n){switch(this.Fl){case"Line":case"Area":case"Baseline":{const n=this._n.crosshairMarkerBackgroundColor;if(0!==n.length)return n}}return this.js().Ws(n).oe}Wl(){switch(this._n.priceFormat.type){case"custom":this.va={format:this._n.priceFormat.formatter};break;case"volume":this.va=new hh(this._n.priceFormat.precision);break;case"percent":this.va=new af(this._n.priceFormat.precision);break;default:{const n=Math.pow(10,this._n.priceFormat.precision);this.va=new ii(n,this._n.priceFormat.minMove*n)}}null!==this.qi&&this.qi.ka()}Kl(){const t=this.$t().St();if(!t.Ca()||this.Et.Li())return void(this.Il=[]);const i=n(this.Et.tl());this.Il=this.El.map((r,u)=>{const f=n(t.Ta(r.time,!0)),e=f<i?1:-1;return{time:n(this.Et.sl(f,e)).ie,position:r.position,shape:r.shape,color:r.color,id:r.id,Gr:u,text:r.text,size:r.size,originalTime:r.originalTime}})}jl(n){switch(this.un=new gc(this,this.$t()),this.Fl){case"Bar":this.mn=new kh(this,this.$t());break;case"Candlestick":this.mn=new ic(this,this.$t());break;case"Line":this.mn=new oc(this,this.$t());break;case"Custom":this.mn=new fr(this,this.$t(),u(n));break;case"Area":this.mn=new wh(this,this.$t());break;case"Baseline":this.mn=new nc(this,this.$t());break;case"Histogram":this.mn=new ec(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.Fl);}}aa(n,t){const i=[];return cr(this.Nl,n,t,i),i}}class pl{constructor(n){this._n=n}Pa(n,t,i){let r=n;if(0===this._n.mode)return r;const u=i.dn(),f=u.Ct();if(null===f)return r;const o=u.Rt(n,f),e=i.Ra().filter(n=>n instanceof ar).reduce((n,r)=>{if(i.ur(r)||!r.kt())return n;const u=r.Dt(),f=r.An();if(u.Li()||!f.Yr(t))return n;const e=f.Yh(t);if(null===e)return n;const o=nt(r.Ct());return n.concat([u.Rt(e.Ot[3],o.Ot)])},[]);if(0===e.length)return r;e.sort((n,t)=>Math.abs(n-o)-Math.abs(t-o));const s=e[0];return r=u.fn(s,f),r}}class wl extends s{constructor(){super(...arguments);this.Et=null}J(n){this.Et=n}Z({context:u,bitmapSize:t,horizontalPixelRatio:i,verticalPixelRatio:r}){if(null!==this.Et){const f=Math.max(1,Math.floor(i));u.lineWidth=f,function(n,t){n.save();n.lineWidth%2&&n.translate(.5,.5);t();n.restore()}(u,()=>{const e=n(this.Et);if(e.Da){u.strokeStyle=e.Oa;p(u,e.Ba);u.beginPath();for(const n of e.Aa){const r=Math.round(n.Va*i);u.moveTo(r,-f);u.lineTo(r,t.height+f)}u.stroke()}if(e.za){u.strokeStyle=e.Ea;p(u,e.Ia);u.beginPath();for(const n of e.La){const i=Math.round(n.Va*r);u.moveTo(-f,i);u.lineTo(t.width+f,i)}u.stroke()}})}}}class bl{constructor(n){this.Wt=new wl;this.ft=!0;this.Qi=n}bt(){this.ft=!0}gt(){if(this.ft){const n=this.Qi.$t().W().grid,t={za:n.horzLines.visible,Da:n.vertLines.visible,Ea:n.horzLines.color,Oa:n.vertLines.color,Ia:n.horzLines.style,Ba:n.vertLines.style,La:this.Qi.dn().Na(),Aa:(this.Qi.$t().St().Na()||[]).map(n=>({Va:n.coord}))};this.Wt.J(t);this.ft=!1}return this.Wt}}class kl{constructor(n){this.mn=new bl(n)}jh(){return this.mn}}const vr={Fa:4,Wa:.0001};class pr{constructor(n,t){if(this.ja=n,this.Ha=t,function(n){if(n<0)return!1;for(let t=n;t>1;t/=10)if(t%10!=0)return!1;return!0}(this.ja))this.$a=[2,2.5,2];else{this.$a=[];for(let n=this.ja;1!==n;){if(n%2==0)this.$a.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this.$a.push(2,2.5);n/=5}if(this.$a.length>100)throw new Error("something wrong with base");}}}Ua(n,t,i){const f=0===this.ja?0:1/this.ja;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(n-t)))),e=0,u=this.Ha[0];for(;;){const n=ri(r,f,1e-14)&&r>f+1e-14,t=ri(r,i*u,1e-14),o=ri(r,1,1e-14);if(!(n&&t&&o))break;r/=u;u=this.Ha[++e%this.Ha.length]}if(r<=f+1e-14&&(r=f),r=Math.max(1,r),this.$a.length>0&&(o=r,s=1,h=1e-14,Math.abs(o-s)<h))for(e=0,u=this.$a[0];ri(r,i*u,1e-14)&&r>f+1e-14;)r/=u,u=this.$a[++e%this.$a.length];var o,s,h;return r}}class ve{constructor(n,t,i,r){this.qa=[];this.Ei=n;this.ja=t;this.Ya=i;this.Xa=r}Ua(n,t){if(n<t)throw new Error("high < low");const u=this.Ei.Vt(),i=(n-t)*this.Ka()/u,f=new pr(this.ja,[2,2.5,2]),e=new pr(this.ja,[2,2,2.5]),o=new pr(this.ja,[2.5,2,2]),r=[];return r.push(f.Ua(n,t,i),e.Ua(n,t,i),o.Ua(n,t,i)),function(n){if(n.length<1)throw Error("array is empty");let t=n[0];for(let i=1;i<n.length;++i)n[i]<t&&(t=n[i]);return t}(r)}Za(){const n=this.Ei,u=n.Ct();if(null===u)return void(this.qa=[]);const s=n.Vt(),h=this.Ya(s-1,u),c=this.Ya(0,u),l=this.Ei.W().entireTextOnly?this.Ga()/2:0,a=l,v=s-1-l,t=Math.max(h,c),i=Math.min(h,c);if(t===i)return void(this.qa=[]);let f=this.Ua(t,i),e=t%f;e+=e<0?f:0;const y=t>=i?1:-1;let o=null,r=0;for(let s=t-e;s>i;s-=f){const t=this.Xa(s,u,!0);null!==o&&Math.abs(t-o)<this.Ka()||t<a||t>v||(r<this.qa.length?(this.qa[r].Va=t,this.qa[r].Ja=n.Qa(s)):this.qa.push({Va:t,Ja:n.Qa(s)}),r++,o=t,n.io()&&(f=this.Ua(s*y,i)))}this.qa.length=r}Na(){return this.qa}Ga(){return this.Ei.P()}Ka(){return Math.ceil(2.5*this.Ga())}}!function(n){n[n.Normal=0]="Normal";n[n.Logarithmic=1]="Logarithmic";n[n.Percentage=2]="Percentage";n[n.IndexedTo100=3]="IndexedTo100"}(wr||(wr={}));const pe=new af,we=new ii(100,1);class na{constructor(n,t,r,u){this.no=0;this.so=null;this.Oh=null;this.eo=null;this.ro={ho:!1,lo:null};this.ao=0;this.oo=0;this._o=new i;this.uo=new i;this.co=[];this.do=null;this.fo=null;this.vo=null;this.po=null;this.va=we;this.mo=yr(null);this.bo=n;this._n=t;this.wo=r;this.Mo=u;this.xo=new ve(this,100,this.So.bind(this),this.yo.bind(this))}ya(){return this.bo}W(){return this._n}Fh(n){if(o(this._n,n),this.ka(),void 0!==n.mode&&this.ko({Sr:n.mode}),void 0!==n.scaleMargins){const t=u(n.scaleMargins.top),i=u(n.scaleMargins.bottom);if(t<0||t>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${t}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(t+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${t+i}`);this.Co();this.fo=null}}To(){return this._n.autoScale}io(){return 1===this._n.mode}mh(){return 2===this._n.mode}Po(){return 3===this._n.mode}Sr(){return{Nn:this._n.autoScale,Ro:this._n.invertScale,Sr:this._n.mode}}ko(n){const t=this.Sr();let i=null;void 0!==n.Nn&&(this._n.autoScale=n.Nn);void 0!==n.Sr&&(this._n.mode=n.Sr,2!==n.Sr&&3!==n.Sr||(this._n.autoScale=!0),this.ro.ho=!1);1===t.Sr&&n.Sr!==t.Sr&&(function(n,t){if(null===n)return!1;const i=vt(n.yh(),t),r=vt(n.kh(),t);return isFinite(i)&&isFinite(r)}(this.Oh,this.mo)?(i=oi(this.Oh,this.mo),null!==i&&this.Do(i)):this._n.autoScale=!0);1===n.Sr&&n.Sr!==t.Sr&&(i=yt(this.Oh,this.mo),null!==i&&this.Do(i));const r=t.Sr!==this._n.mode;r&&(2===t.Sr||this.mh())&&this.ka();r&&(3===t.Sr||this.Po())&&this.ka();void 0!==n.Ro&&t.Ro!==n.Ro&&(this._n.invertScale=n.Ro,this.Oo());this.uo.m(t,this.Sr())}Bo(){return this.uo}P(){return this.wo.fontSize}Vt(){return this.no}Ao(n){this.no!==n&&(this.no=n,this.Co(),this.fo=null)}Vo(){if(this.so)return this.so;const n=this.Vt()-this.zo()-this.Eo();return this.so=n,n}Ah(){return this.Io(),this.Oh}Do(n,t){const i=this.Oh;(t||null===i&&null!==n||null!==i&&!i.xh(n))&&(this.fo=null,this.Oh=n)}Li(){return this.Io(),0===this.no||!this.Oh||this.Oh.Li()}Lo(n){return this.Ro()?n:this.Vt()-1-n}Rt(n,t){return this.mh()?n=it(n,t):this.Po()&&(n=at(n,t)),this.yo(n,t)}Gs(t,i,r){this.Io();const o=this.Eo(),u=n(this.Ah()),f=u.yh(),s=u.kh(),h=this.Vo()-1,c=this.Ro(),l=h/(s-f),a=void 0===r?0:r.from,v=void 0===r?t.length:r.to,e=this.No();for(let n=a;n<v;n++){const r=t[n],u=r._t;if(!isNaN(u)){let s=u;null!==e&&(s=e(r._t,i));const h=o+l*(s-f),a=c?h:this.no-1-h;r.st=a}}}ve(t,i,r){this.Io();const e=this.Eo(),h=n(this.Ah()),u=h.yh(),c=h.kh(),l=this.Vo()-1,o=this.Ro(),s=l/(c-u),a=void 0===r?0:r.from,v=void 0===r?t.length:r.to,f=this.No();for(let n=a;n<v;n++){const r=t[n];let l=r.me,a=r.be,v=r.we,y=r.ge;null!==f&&(l=f(r.me,i),a=f(r.be,i),v=f(r.we,i),y=f(r.ge,i));let h=e+s*(l-u),c=o?h:this.no-1-h;r.de=c;h=e+s*(a-u);c=o?h:this.no-1-h;r._e=c;h=e+s*(v-u);c=o?h:this.no-1-h;r.ue=c;h=e+s*(y-u);c=o?h:this.no-1-h;r.fe=c}}fn(n,t){const i=this.So(n,t);return this.Fo(i,t)}Fo(n,t){let i=n;return this.mh()?i=function(n,t){return t<0&&(n=-n),n/100*t+t}(i,t):this.Po()&&(i=function(n,t){return n-=100,t<0&&(n=-n),n/100*t+t}(i,t)),i}Ra(){return this.co}Wo(){if(this.do)return this.do;let n=[];for(let t=0;t<this.co.length;t++){const i=this.co[t];null===i.Xi()&&i.Ki(t+1);n.push(i)}return n=ye(n),this.do=n,this.do}jo(n){-1===this.co.indexOf(n)&&(this.co.push(n),this.ka(),this.Ho())}$o(n){const t=this.co.indexOf(n);if(-1===t)throw new Error("source is not attached to scale");this.co.splice(t,1);0===this.co.length&&(this.ko({Nn:!0}),this.Do(null));this.ka();this.Ho()}Ct(){let n=null;for(const t of this.co){const i=t.Ct();null!==i&&(null===n||i.sa<n.sa)&&(n=i)}return null===n?null:n.Ot}Ro(){return this._n.invertScale}Na(){const n=null===this.Ct();if(null!==this.fo&&(n||this.fo.Uo===n))return this.fo.Na;this.xo.Za();const t=this.xo.Na();return this.fo={Na:t,Uo:n},this._o.m(),t}qo(){return this._o}Yo(t){this.mh()||this.Po()||null===this.vo&&null===this.eo&&(this.Li()||(this.vo=this.no-t,this.eo=n(this.Ah()).Sh()))}Xo(t){if(!this.mh()&&!this.Po()&&null!==this.vo){this.ko({Nn:!1});(t=this.no-t)<0&&(t=0);let i=(this.vo+.2*(this.no-1))/(t+.2*(this.no-1));const r=n(this.eo).Sh();i=Math.max(i,.1);r.Th(i);this.Do(r)}}Ko(){this.mh()||this.Po()||(this.vo=null,this.eo=null)}Zo(t){this.To()||null===this.po&&null===this.eo&&(this.Li()||(this.po=t,this.eo=n(this.Ah()).Sh()))}Go(t){if(!this.To()&&null!==this.po){const u=n(this.Ah()).Ch()/(this.Vo()-1);let i=t-this.po;this.Ro()&&(i*=-1);const f=i*u,r=n(this.eo).Sh();r.Ph(f);this.Do(r,!0);this.fo=null}}Jo(){this.To()||null!==this.po&&(this.po=null,this.eo=null)}fa(){return this.va||this.ka(),this.va}Ni(n,t){switch(this._n.mode){case 2:return this.Qo(it(n,t));case 3:return this.fa().format(at(n,t));default:return this.Ih(n)}}Qa(n){switch(this._n.mode){case 2:return this.Qo(n);case 3:return this.fa().format(n);default:return this.Ih(n)}}Hl(t){return this.Ih(t,n(this.t_()).fa())}$l(n,t){return n=it(n,t),this.Qo(n,pe)}i_(){return this.co}n_(n){this.ro={lo:n,ho:!1}}Rn(){this.co.forEach(n=>n.Rn())}ka(){this.fo=null;const n=this.t_();let t=100;null!==n&&(t=Math.round(1/n.da()));this.va=we;this.mh()?(this.va=pe,t=100):this.Po()?(this.va=new ii(100,1),t=100):null!==n&&(this.va=n.fa());this.xo=new ve(this,t,this.So.bind(this),this.yo.bind(this));this.xo.Za()}Ho(){this.do=null}t_(){return this.co[0]||null}zo(){return this.Ro()?this._n.scaleMargins.bottom*this.Vt()+this.oo:this._n.scaleMargins.top*this.Vt()+this.ao}Eo(){return this.Ro()?this._n.scaleMargins.top*this.Vt()+this.ao:this._n.scaleMargins.bottom*this.Vt()+this.oo}Io(){this.ro.ho||(this.ro.ho=!0,this.s_())}Co(){this.so=null}yo(t){if(this.Io(),this.Li())return 0;t=this.io()&&t?ei(t,this.mo):t;const i=n(this.Ah()),r=this.Eo()+(this.Vo()-1)*(t-i.yh())/i.Ch();return this.Lo(r)}So(t){if(this.Io(),this.Li())return 0;const u=this.Lo(t),i=n(this.Ah()),r=i.yh()+i.Ch()*((u-this.Eo())/(this.Vo()-1));return this.io()?vt(r,this.mo):r}Oo(){this.fo=null;this.xo.Za()}s_(){const u=this.ro.lo;if(null!==u){let t=null;const s=this.i_();let i=0,r=0;for(const f of s)if(f.kt()){const s=f.Ct();if(null!==s){const o=f.Ol(u.Rs(),u.ui());let e=o&&o.Ah();if(null!==e){switch(this._n.mode){case 1:e=yt(e,this.mo);break;case 2:e=dl(e,s.Ot);break;case 3:e=gl(e,s.Ot)}if(t=null===t?e:t.Jn(n(e)),null!==o){const n=o.Vh();null!==n&&(i=Math.max(i,n.above),r=Math.max(r,n.below))}}}}if(i===this.ao&&r===this.oo||(this.ao=i,this.oo=r,this.fo=null,this.Co()),null!==t){if(t.yh()===t.kh()){const n=this.t_(),i=5*(null===n||this.mh()||this.Po()?1:n.da());this.io()&&(t=oi(t,this.mo));t=new f(t.yh()-i,t.kh()+i);this.io()&&(t=yt(t,this.mo))}if(this.io()){const i=oi(t,this.mo),n=yr(i);if(e=n,o=this.mo,e.Fa!==o.Fa||e.Wa!==o.Wa){const r=null!==this.eo?oi(this.eo,this.mo):null;this.mo=n;t=yt(i,n);null!==r&&(this.eo=yt(r,n))}}this.Do(t)}else null===this.Oh&&(this.Do(new f(-.5,.5)),this.mo=yr(null));var e,o;this.ro.ho=!0}}No(){return this.mh()?it:this.Po()?at:this.io()?n=>ei(n,this.mo):null}e_(n,t,i){return void 0===t?(void 0===i&&(i=this.fa()),i.format(n)):t(n)}Ih(n,t){return this.e_(n,this.Mo.priceFormatter,t)}Qo(n,t){return this.e_(n,this.Mo.percentageFormatter,t)}}class ta{constructor(n,t){this.co=[];this.r_=new Map;this.no=0;this.h_=0;this.l_=1e3;this.do=null;this.a_=new i;this.Ml=n;this.Hi=t;this.o_=new kl(this);const r=t.W();this.__=this.u_("left",r.leftPriceScale);this.c_=this.u_("right",r.rightPriceScale);this.__.Bo().l(this.d_.bind(this,this.__),this);this.c_.Bo().l(this.d_.bind(this,this.c_),this);this.f_(r)}f_(t){if(t.leftPriceScale&&this.__.Fh(t.leftPriceScale),t.rightPriceScale&&this.c_.Fh(t.rightPriceScale),t.localization&&(this.__.ka(),this.c_.ka()),t.overlayPriceScales){const i=Array.from(this.r_.values());for(const i of i){const r=n(i[0].Dt());r.Fh(t.overlayPriceScales);t.localization&&r.ka()}}}v_(n){switch(n){case"left":return this.__;case"right":return this.c_}return this.r_.has(n)?u(this.r_.get(n))[0].Dt():null}S(){this.$t().p_().p(this);this.__.Bo().p(this);this.c_.Bo().p(this);this.co.forEach(n=>{n.S&&n.S()});this.a_.m()}m_(){return this.l_}b_(n){this.l_=n}$t(){return this.Hi}ji(){return this.h_}Vt(){return this.no}w_(n){this.h_=n;this.g_()}Ao(n){this.no=n;this.__.Ao(n);this.c_.Ao(n);this.co.forEach(t=>{if(this.ur(t)){const i=t.Dt();null!==i&&i.Ao(n)}});this.g_()}Ra(){return this.co}ur(n){const t=n.Dt();return null===t||this.__!==t&&this.c_!==t}jo(n,t,i){const r=void 0!==i?i:this.x_().M_+1;this.S_(n,t,r)}$o(t){const f=this.co.indexOf(t);v(-1!==f,"removeDataSource: invalid data source");this.co.splice(f,1);const r=n(t.Dt()).ya();if(this.r_.has(r)){const n=u(this.r_.get(r)),i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&this.r_.delete(r))}const i=t.Dt();i&&i.Ra().indexOf(t)>=0&&i.$o(t);null!==i&&(i.Ho(),this.y_(i));this.do=null}dr(n){return n===this.__?"left":n===this.c_?"right":"overlay"}k_(){return this.__}C_(){return this.c_}T_(n,t){n.Yo(t)}P_(n,t){n.Xo(t);this.g_()}R_(n){n.Ko()}D_(n,t){n.Zo(t)}O_(n,t){n.Go(t);this.g_()}B_(n){n.Jo()}g_(){this.co.forEach(n=>{n.Rn()})}dn(){let n=null;return this.Hi.W().rightPriceScale.visible&&0!==this.c_.Ra().length?n=this.c_:this.Hi.W().leftPriceScale.visible&&0!==this.__.Ra().length?n=this.__:0!==this.co.length&&(n=this.co[0].Dt()),null===n&&(n=this.c_),n}cr(){let n=null;return this.Hi.W().rightPriceScale.visible?n=this.c_:this.Hi.W().leftPriceScale.visible&&(n=this.__),n}y_(n){null!==n&&n.To()&&this.A_(n)}V_(n){const t=this.Ml.qs();n.ko({Nn:!0});null!==t&&n.n_(t);this.g_()}z_(){this.A_(this.__);this.A_(this.c_)}E_(){this.y_(this.__);this.y_(this.c_);this.co.forEach(n=>{this.ur(n)&&this.y_(n.Dt())});this.g_();this.Hi.Wh()}Wo(){return null===this.do&&(this.do=ye(this.co)),this.do}I_(){return this.a_}L_(){return this.o_}A_(n){const t=n.i_();if(t&&t.length>0&&!this.Ml.Li()){const t=this.Ml.qs();null!==t&&n.n_(t)}n.Rn()}x_(){const n=this.Wo();if(0===n.length)return{N_:0,M_:0};let t=0,i=0;for(let r=0;r<n.length;r++){const u=n[r].Xi();null!==u&&(u<t&&(t=u),u>i&&(i=u))}return{N_:t,M_:i}}S_(n,t,i){let r=this.v_(t);if(null===r&&(r=this.u_(t,this.Hi.W().overlayPriceScales)),this.co.push(n),!ti(t)){const i=this.r_.get(t)||[];i.push(n);this.r_.set(t,i)}r.jo(n);n.Zi(r);n.Ki(i);this.y_(r);this.do=null}d_(n,t,i){t.Sr!==i.Sr&&this.A_(n)}u_(n,t){const r=Object.assign({visible:!0,autoScale:!0},l(t)),i=new na(n,r,this.Hi.W().layout,this.Hi.W().localization);return i.Ao(this.Vt()),i}}class ia{constructor(n,t,i=50){this.Ye=0;this.Xe=1;this.Ke=1;this.Ge=new Map;this.Ze=new Map;this.F_=n;this.W_=t;this.Je=i}j_(n){const f=n.time,t=this.W_.cacheKey(f),i=this.Ge.get(t);if(void 0!==i)return i.H_;if(this.Ye===this.Je){const n=this.Ze.get(this.Ke);this.Ze.delete(this.Ke);this.Ge.delete(u(n));this.Ke++;this.Ye--}const r=this.F_(n);return this.Ge.set(t,{H_:r,nr:this.Xe}),this.Ze.set(this.Xe,t),this.Ye++,this.Xe++,r}}class pt{constructor(n,t){v(n<=t,"right should be >= left");this.U_=n;this.q_=t}Rs(){return this.U_}ui(){return this.q_}Y_(){return this.q_-this.U_+1}Yr(n){return this.U_<=n&&n<=this.q_}xh(n){return this.U_===n.Rs()&&this.q_===n.ui()}}class ra{constructor(){this.X_=new Map;this.Ge=null;this.K_=!1}Z_(n){this.K_=n;this.Ge=null}G_(n,t){this.J_(t);this.Ge=null;for(let i=t;i<n.length;++i){const t=n[i];let r=this.X_.get(t.timeWeight);void 0===r&&(r=[],this.X_.set(t.timeWeight,r));r.push({index:i,time:t.time,weight:t.timeWeight,originalTime:t.originalTime})}}Q_(n,t){const i=Math.ceil(t/n);return null!==this.Ge&&this.Ge.tu===i||(this.Ge={Na:this.iu(i),tu:i}),this.Ge.Na}J_(n){if(0===n)return void this.X_.clear();const t=[];this.X_.forEach((i,r)=>{n<=i[0].index?t.push(r):i.splice(st(i,n,t=>t.index<n),1/0)});for(const n of t)this.X_.delete(n)}iu(n){let t=[];for(const i of Array.from(this.X_.keys()).sort((n,t)=>t-n))if(this.X_.get(i)){const f=t;t=[];const s=f.length;let r=0;const h=u(this.X_.get(i)),c=h.length;let e=1/0,o=-1/0;for(let i=0;i<c;i++){const c=h[i],u=c.index;for(;r<s;){const i=f[r],n=i.index;if(!(n<u)){e=n;break}r++;t.push(i);o=n;e=1/0}if(e-u>=n&&u-o>=n)t.push(c),o=u;else if(this.K_)return f}for(;r<s;r++)t.push(f[r])}return t}}class wt{constructor(n){this.nu=n}su(){return null===this.nu?null:new pt(Math.floor(this.nu.Rs()),Math.ceil(this.nu.ui()))}eu(){return this.nu}static ru(){return new wt(null)}}class fa{constructor(n,t,r,u){this.h_=0;this.hu=null;this.lu=[];this.po=null;this.vo=null;this.au=new ra;this.ou=new Map;this._u=wt.ru();this.uu=!0;this.cu=new i;this.du=new i;this.fu=new i;this.vu=null;this.pu=null;this.mu=[];this._n=t;this.Mo=r;this.bu=t.rightOffset;this.wu=t.barSpacing;this.Hi=n;this.W_=u;this.gu();this.au.Z_(t.uniformDistribution)}W(){return this._n}Mu(n){o(this.Mo,n);this.xu();this.gu()}Fh(n){var t;o(this._n,n);this._n.fixLeftEdge&&this.Su();this._n.fixRightEdge&&this.yu();void 0!==n.barSpacing&&this.Hi.Kn(n.barSpacing);void 0!==n.rightOffset&&this.Hi.Zn(n.rightOffset);void 0!==n.minBarSpacing&&this.Hi.Kn(null!==(t=n.barSpacing)&&void 0!==t?t:this.wu);this.xu();this.gu();this.fu.m()}vn(n){var t,i;return null!==(i=null===(t=this.lu[n])||void 0===t?void 0:t.time)&&void 0!==i?i:null}$i(n){var t;return null!==(t=this.lu[n])&&void 0!==t?t:null}Ta(n,t){if(this.lu.length<1)return null;if(this.W_.key(n)>this.W_.key(this.lu[this.lu.length-1].time))return t?this.lu.length-1:null;const i=st(this.lu,this.W_.key(n),(n,t)=>this.W_.key(n.time)<t);return this.W_.key(n)<this.W_.key(this.lu[i].time)?t?i:null:i}Li(){return 0===this.h_||0===this.lu.length||null===this.hu}Ca(){return this.lu.length>0}qs(){return this.ku(),this._u.su()}Cu(){return this.ku(),this._u.eu()}Tu(){const n=this.qs();if(null===n)return null;const t={from:n.Rs(),to:n.ui()};return this.Pu(t)}Pu(t){const i=Math.round(t.from),r=Math.round(t.to),u=n(this.Ru()),f=n(this.Du());return{from:n(this.$i(Math.max(u,i))),to:n(this.$i(Math.min(f,r)))}}Ou(t){return{from:n(this.Ta(t.from,!0)),to:n(this.Ta(t.to,!0))}}ji(){return this.h_}w_(n){if(isFinite(n)&&!(n<=0)&&this.h_!==n){const i=this.Cu(),t=this.h_;if(this.h_=n,this.uu=!0,this._n.lockVisibleTimeRangeOnResize&&0!==t){const i=this.wu*n/t;this.wu=i}if(this._n.fixLeftEdge&&null!==i&&i.Rs()<=0){const i=t-n;this.bu-=Math.round(i/this.wu)+1;this.uu=!0}this.Bu();this.Au()}}zt(n){if(this.Li()||!ft(n))return 0;const t=this.Vu()+this.bu-n;return this.h_-(t+.5)*this.wu-1}Zs(n,t){const i=this.Vu(),r=void 0===t?0:t.from,u=void 0===t?n.length:t.to;for(let t=r;t<u;t++){const r=n[t].ot,u=i+this.bu-r,f=this.h_-(u+.5)*this.wu-1;n[t].nt=f}}zu(n){return Math.ceil(this.Eu(n))}Zn(n){this.uu=!0;this.bu=n;this.Au();this.Hi.Iu();this.Hi.Wh()}ee(){return this.wu}Kn(n){this.Lu(n);this.Au();this.Hi.Iu();this.Hi.Wh()}Nu(){return this.bu}Na(){if(this.Li())return null;if(null!==this.pu)return this.pu;const e=this.wu,u=5*(this.Hi.W().layout.fontSize+4)/8*(this._n.tickMarkMaxCharacterLength||8),t=Math.round(u/e),i=n(this.qs()),o=Math.max(i.Rs(),i.Rs()-t),s=Math.max(i.ui(),i.ui()-t),h=this.au.Q_(e,u),c=this.Ru()+t,l=this.Du()-t,f=this.Fu(),a=this._n.fixLeftEdge||f,v=this._n.fixRightEdge||f;let r=0;for(const n of h)if(o<=n.index&&n.index<=s){let t;r<this.mu.length?(t=this.mu[r],t.coord=this.zt(n.index),t.label=this.Wu(n),t.weight=n.weight):(t={needAlignCoordinate:!1,coord:this.zt(n.index),label:this.Wu(n),weight:n.weight},this.mu.push(t));t.needAlignCoordinate=this.wu>u/2&&!f?!1:a&&n.index<=c||v&&n.index>=l;r++}return this.mu.length=r,this.pu=this.mu,this.mu}ju(){this.uu=!0;this.Kn(this._n.barSpacing);this.Zn(this._n.rightOffset)}Hu(n){this.uu=!0;this.hu=n;this.Au();this.Su()}$u(n,t){const r=this.Eu(n),i=this.ee(),u=i+t*(i/10);this.Kn(u);this._n.rightBarStaysOnScroll||this.Zn(this.Nu()+(r-this.Eu(n)))}Yo(n){this.po&&this.Jo();null===this.vo&&null===this.vu&&(this.Li()||(this.vo=n,this.Uu()))}Xo(t){if(null!==this.vu){const i=ir(this.h_-t,0,this.h_),r=ir(this.h_-n(this.vo),0,this.h_);0!==i&&0!==r&&this.Kn(this.vu.ee*i/r)}}Ko(){null!==this.vo&&(this.vo=null,this.qu())}Zo(n){null===this.po&&null===this.vu&&(this.Li()||(this.po=n,this.Uu()))}Go(t){if(null!==this.po){const i=(this.po-t)/this.ee();this.bu=n(this.vu).Nu+i;this.uu=!0;this.Au()}}Jo(){null!==this.po&&(this.po=null,this.qu())}Yu(){this.Xu(this._n.rightOffset)}Xu(n,t=400){if(!isFinite(n))throw new RangeError("offset is required and must be finite number");if(!isFinite(t)||t<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.bu,r=performance.now();this.Hi.qn({Ku:n=>(n-r)/t>=1,Zu:u=>{const f=(u-r)/t;return f>=1?n:i+(n-i)*f}})}bt(n,t){this.uu=!0;this.lu=n;this.au.G_(n,t);this.Au()}Gu(){return this.cu}Ju(){return this.du}Qu(){return this.fu}Vu(){return this.hu||0}tc(n){const t=n.Y_();this.Lu(this.h_/t);this.bu=n.ui()-this.Vu();this.Au();this.uu=!0;this.Hi.Iu();this.Hi.Wh()}ic(){const n=this.Ru(),t=this.Du();null!==n&&null!==t&&this.tc(new pt(n,t+this._n.rightOffset))}nc(n){const t=new pt(n.from,n.to);this.tc(t)}Ui(n){return void 0!==this.Mo.timeFormatter?this.Mo.timeFormatter(n.originalTime):this.W_.formatHorzItem(n.time)}Fu(){const{handleScroll:n,handleScale:t}=this.Hi.W();return!(n.horzTouchDrag||n.mouseWheel||n.pressedMouseMove||n.vertTouchDrag||t.axisDoubleClickReset.time||t.axisPressedMouseMove.time||t.mouseWheel||t.pinch)}Ru(){return 0===this.lu.length?null:0}Du(){return 0===this.lu.length?null:this.lu.length-1}sc(n){return(this.h_-1-n)/this.wu}Eu(n){const t=this.sc(n),i=this.Vu()+this.bu-t;return Math.round(1e6*i)/1e6}Lu(n){const t=this.wu;this.wu=n;this.Bu();t!==this.wu&&(this.uu=!0,this.ec())}ku(){if(this.uu){if(this.uu=!1,this.Li())return void this.rc(wt.ru());const t=this.Vu(),i=this.h_/this.wu,n=this.bu+t,r=new pt(n-i+1,n);this.rc(new wt(r))}}Bu(){const n=this.hc();if(this.wu<n&&(this.wu=n,this.uu=!0),0!==this.h_){const n=.5*this.h_;this.wu>n&&(this.wu=n,this.uu=!0)}}hc(){return this._n.fixLeftEdge&&this._n.fixRightEdge&&0!==this.lu.length?this.h_/this.lu.length:this._n.minBarSpacing}Au(){const t=this.lc();this.bu>t&&(this.bu=t,this.uu=!0);const n=this.ac();null!==n&&this.bu<n&&(this.bu=n,this.uu=!0)}ac(){const n=this.Ru(),t=this.hu;return null===n||null===t?null:n-t-1+(this._n.fixLeftEdge?this.h_/this.wu:Math.min(2,this.lu.length))}lc(){return this._n.fixRightEdge?0:this.h_/this.wu-Math.min(2,this.lu.length)}Uu(){this.vu={ee:this.ee(),Nu:this.Nu()}}qu(){this.vu=null}Wu(n){let t=this.ou.get(n.weight);return void 0===t&&(t=new ia(n=>this.oc(n),this.W_),this.ou.set(n.weight,t)),t.j_(n)}oc(n){return this.W_.formatTickmark(n,this.Mo)}rc(n){const t=this._u;this._u=n;be(t.su(),this._u.su())||this.cu.m();be(t.eu(),this._u.eu())||this.du.m();this.ec()}ec(){this.pu=null}xu(){this.ec();this.ou.clear()}gu(){this.W_.updateFormatter(this.Mo)}Su(){if(this._n.fixLeftEdge){const n=this.Ru();if(null!==n){const t=this.qs();if(null!==t){const i=t.Rs()-n;if(i<0){const n=this.bu-i-1;this.Zn(n)}this.Bu()}}}}yu(){this.Au();this.Bu()}}class ea{K(n,t,i){n.useMediaCoordinateSpace(n=>this.Z(n,t,i))}pl(n,t,i){n.useMediaCoordinateSpace(n=>this._c(n,t,i))}_c(){}}class oa extends ea{constructor(n){super();this.uc=new Map;this.Et=n}Z(){}_c(n){if(this.Et.kt){const{context:t,mediaSize:i}=n;let u=0;for(const n of this.Et.cc)if(0!==n.Zt.length){t.font=n.R;const r=this.dc(t,n.Zt);n.$u=r>i.width?i.width/r:1;u+=n.fc*n.$u}let r=0;switch(this.Et.vc){case"top":r=0;break;case"center":r=Math.max((i.height-u)/2,0);break;case"bottom":r=Math.max(i.height-u,0)}t.fillStyle=this.Et.O;for(const n of this.Et.cc){t.save();let u=0;switch(this.Et.mc){case"left":t.textAlign="left";u=n.fc/2;break;case"center":t.textAlign="center";u=i.width/2;break;case"right":t.textAlign="right";u=i.width-1-n.fc/2}t.translate(u,r);t.textBaseline="top";t.font=n.R;t.scale(n.$u,n.$u);t.fillText(n.Zt,0,n.bc);t.restore();r+=n.fc*n.$u}}}dc(n,t){const r=this.wc(n.font);let i=r.get(t);return void 0===i&&(i=n.measureText(t).width,r.set(t,i)),i}wc(n){let t=this.uc.get(n);return void 0===t&&(t=new Map,this.uc.set(n,t)),t}}class sa{constructor(n){this.ft=!0;this.Ft={kt:!1,O:"",cc:[],vc:"center",mc:"center"};this.Wt=new oa(this.Ft);this.jt=n}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const n=this.jt.W(),t=this.Ft;t.kt=n.visible;t.kt&&(t.O=n.color,t.mc=n.horzAlign,t.vc=n.vertAlign,t.cc=[{Zt:n.text,R:tt(n.fontSize,n.fontFamily,n.fontStyle),fc:1.2*n.fontSize,bc:0,$u:0}])}}class ha extends gi{constructor(n,t){super();this._n=t;this.mn=new sa(this)}Tn(){return[]}Cn(){return[this.mn]}W(){return this._n}Rn(){this.mn.bt()}}!function(n){n[n.OnTouchEnd=0]="OnTouchEnd";n[n.OnNextTap=1]="OnNextTap"}(br||(br={}));class ca{constructor(n,t,r){this.gc=[];this.Mc=[];this.h_=0;this.xc=null;this.Sc=new i;this.yc=new i;this.kc=null;this.Cc=n;this._n=t;this.W_=r;this.Tc=new ks(this);this.Ml=new fa(this,t.timeScale,this._n.localization,r);this.vt=new sh(this,t.crosshair);this.Pc=new pl(t.crosshair);this.Rc=new ha(this,t.watermark);this.Dc();this.gc[0].b_(2e3);this.Oc=this.Bc(0);this.Ac=this.Bc(1)}ql(){this.Vc(r.ns())}Wh(){this.Vc(r.ts())}ra(){this.Vc(new r(1))}Yl(n){const t=this.zc(n);this.Vc(t)}Ec(){return this.xc}Ic(n){const t=this.xc;this.xc=n;null!==t&&this.Yl(t.Lc);null!==n&&this.Yl(n.Lc)}W(){return this._n}Fh(n){o(this._n,n);this.gc.forEach(t=>t.f_(n));void 0!==n.timeScale&&this.Ml.Fh(n.timeScale);void 0!==n.localization&&this.Ml.Mu(n.localization);(n.leftPriceScale||n.rightPriceScale)&&this.Sc.m();this.Oc=this.Bc(0);this.Ac=this.Bc(1);this.ql()}Nc(n,t){if("left"===n)return void this.Fh({leftPriceScale:t});if("right"===n)return void this.Fh({rightPriceScale:t});const i=this.Fc(n);null!==i&&(i.Dt.Fh(t),this.Sc.m())}Fc(n){for(const t of this.gc){const i=t.v_(n);if(null!==i)return{Ht:t,Dt:i}}return null}St(){return this.Ml}Wc(){return this.gc}jc(){return this.Rc}Hc(){return this.vt}$c(){return this.yc}Uc(n,t){n.Ao(t);this.Iu()}w_(n){this.h_=n;this.Ml.w_(this.h_);this.gc.forEach(t=>t.w_(n));this.Iu()}Dc(n){const t=new ta(this.Ml,this);void 0!==n?this.gc.splice(n,0,t):this.gc.push(t);const u=void 0===n?this.gc.length-1:n,i=r.ns();return i.In(u,{Ln:0,Nn:!0}),this.Vc(i),t}T_(n,t,i){n.T_(t,i)}P_(n,t,i){n.P_(t,i);this.Xl();this.Vc(this.qc(n,2))}R_(n,t){n.R_(t);this.Vc(this.qc(n,2))}D_(n,t,i){t.To()||n.D_(t,i)}O_(n,t,i){t.To()||(n.O_(t,i),this.Xl(),this.Vc(this.qc(n,2)))}B_(n,t){t.To()||(n.B_(t),this.Vc(this.qc(n,2)))}V_(n,t){n.V_(t);this.Vc(this.qc(n,2))}Yc(n){this.Ml.Yo(n)}Xc(n,t){const i=this.St();if(!i.Li()&&0!==t){const r=i.ji();n=Math.max(1,Math.min(n,r));i.$u(n,t);this.Iu()}}Kc(n){this.Zc(0);this.Gc(n);this.Jc()}Qc(n){this.Ml.Xo(n);this.Iu()}td(){this.Ml.Ko();this.Wh()}Zc(n){this.Ml.Zo(n)}Gc(n){this.Ml.Go(n);this.Iu()}Jc(){this.Ml.Jo();this.Wh()}wt(){return this.Mc}nd(n,t,i,r,u){this.vt.bn(n,t);let f=NaN,e=this.Ml.zu(n);const o=this.Ml.qs();null!==o&&(e=Math.min(Math.max(o.Rs(),e),o.ui()));const s=r.dn(),h=s.Ct();null!==h&&(f=s.fn(t,h));f=this.Pc.Pa(f,e,r);this.vt.xn(e,f,r);this.ra();u||this.yc.m(this.vt.xt(),{x:n,y:t},i)}sd(t,i,r){const u=r.dn(),f=u.Ct(),e=u.Rt(t,n(f)),o=this.Ml.Ta(i,!0),s=this.Ml.zt(n(o));this.nd(s,e,null,r,!0)}ed(n){this.Hc().yn();this.ra();n||this.yc.m(null,null,null)}Xl(){const n=this.vt.Ht();if(null!==n){const t=this.vt.gn(),i=this.vt.Mn();this.nd(t,i,null,n)}this.vt.Rn()}rd(n,t,i){const u=this.Ml.vn(0);void 0!==t&&void 0!==i&&this.Ml.bt(t,i);const f=this.Ml.vn(0),r=this.Ml.Vu(),e=this.Ml.qs();if(null!==e&&null!==u&&null!==f){const t=e.Yr(r),o=this.W_.key(u)>this.W_.key(f),s=null!==n&&n>r&&!o,h=this.Ml.W().allowShiftVisibleRangeOnWhitespaceReplacement,c=t&&(!(void 0===i)||h)&&this.Ml.W().shiftVisibleRangeOnNewBar;if(s&&!c){const t=n-r;this.Ml.Zn(this.Ml.Nu()-t)}}this.Ml.Hu(n)}Gl(n){null!==n&&n.E_()}_r(n){const t=this.gc.find(t=>t.Wo().includes(n));return void 0===t?null:t}Iu(){this.Rc.Rn();this.gc.forEach(n=>n.E_());this.Xl()}S(){this.gc.forEach(n=>n.S());this.gc.length=0;this._n.localization.priceFormatter=void 0;this._n.localization.percentageFormatter=void 0;this._n.localization.timeFormatter=void 0}hd(){return this.Tc}vr(){return this.Tc.W()}p_(){return this.Sc}ld(n,t,i){const u=this.gc[0],r=this.ad(t,n,u,i);return this.Mc.push(r),1===this.Mc.length?this.ql():this.Wh(),r}od(t){const r=this._r(t),i=this.Mc.indexOf(t);v(-1!==i,"Series not found");this.Mc.splice(i,1);n(r).$o(t);t.S&&t.S()}Ul(t,i){const r=n(this._r(t));r.$o(t);const u=this.Fc(i);if(null===u){const n=t.Xi();r.jo(t,i,n)}else{const n=u.Ht===r?t.Xi():void 0;u.Ht.jo(t,i,n)}}ic(){const n=r.ts();n.jn();this.Vc(n)}_d(n){const t=r.ts();t.Un(n);this.Vc(t)}Xn(){const n=r.ts();n.Xn();this.Vc(n)}Kn(n){const t=r.ts();t.Kn(n);this.Vc(t)}Zn(n){const t=r.ts();t.Zn(n);this.Vc(t)}qn(n){const t=r.ts();t.qn(n);this.Vc(t)}Hn(){const n=r.ts();n.Hn();this.Vc(n)}ud(){return this._n.rightPriceScale.visible?"right":"left"}dd(){return this.Ac}q(){return this.Oc}At(n){const t=this.Ac,i=this.Oc;if(t===i)return t;if(n=Math.max(0,Math.min(100,Math.round(100*n))),null===this.kc||this.kc.ks!==i||this.kc.Cs!==t)this.kc={ks:i,Cs:t,fd:new Map};else{const t=this.kc.fd.get(n);if(void 0!==t)return t}const r=function(n,t,i){const[u,f,o,s]=bt(n),[h,c,l,a]=bt(t),r=[e(u+i*(h-u)),e(f+i*(c-f)),e(o+i*(l-o)),ff(s+i*(a-s))];return`rgba(${r[0]}, ${r[1]}, ${r[2]}, ${r[3]})`}(i,t,n/100);return this.kc.fd.set(n,r),r}qc(n,t){const i=new r(t);if(null!==n){const r=this.gc.indexOf(n);i.In(r,{Ln:t})}return i}zc(n,t){return void 0===t&&(t=2),this.qc(this._r(n),t)}Vc(n){this.Cc&&this.Cc(n);this.gc.forEach(n=>n.L_().jh().bt())}ad(n,t,i,r){const u=new ar(this,n,t,i,r),f=void 0!==n.priceScaleId?n.priceScaleId:this.ud();return i.jo(u,f),ti(f)||u.Fh(n),u}Bc(n){const t=this._n.layout;return"gradient"===t.background.type?0===n?t.background.topColor:t.background.bottomColor:t.background.color}}!function(n){n[n.Disabled=0]="Disabled";n[n.Continuous=1]="Continuous";n[n.OnDataUpdate=2]="OnDataUpdate"}(kr||(kr={})),function(n){n[n.LastBar=0]="LastBar";n[n.LastVisible=1]="LastVisible"}(dr||(dr={})),function(n){n.Solid="solid";n.VerticalGradient="gradient"}(gr||(gr={})),function(n){n[n.Year=0]="Year";n[n.Month=1]="Month";n[n.DayOfMonth=2]="DayOfMonth";n[n.Time=3]="Time";n[n.TimeWithSeconds=4]="TimeWithSeconds"}(nu||(nu={}));const ke=n=>n.getUTCFullYear();class de{constructor(n="yyyy-MM-dd",t="default"){this.vd=n;this.pd=t}j_(n){return la(n,this.vd,this.pd)}}class aa{constructor(n){this.md=n||"%h:%m:%s"}j_(n){return this.md.replace("%h",a(n.getUTCHours(),2)).replace("%m",a(n.getUTCMinutes(),2)).replace("%s",a(n.getUTCSeconds(),2))}}const va={bd:"yyyy-MM-dd",wd:"%h:%m:%s",gd:" ",Md:"default"};class ya{constructor(n={}){const t=Object.assign(Object.assign({},va),n);this.xd=new de(t.bd,t.Md);this.Sd=new aa(t.wd);this.yd=t.gd}j_(n){return`${this.xd.j_(n)}${this.yd}${this.Sd.j_(n)}`}}const ci=[{kd:(ge=1,1e3*ge),Cd:10},{kd:iu(1),Cd:20},{kd:iu(5),Cd:21},{kd:iu(30),Cd:22},{kd:hi(1),Cd:30},{kd:hi(3),Cd:31},{kd:hi(6),Cd:32},{kd:hi(12),Cd:33}];class ro{options(){return this._n}setOptions(n){this._n=n;this.updateFormatter(n.localization)}preprocessData(n){Array.isArray(n)?function(n){n.forEach(io)}(n):io(n)}createConverterToInternalObj(t){return n(function(n){return 0===n.length?null:si(n[0].time)||et(n[0].time)?ru:to}(t))}key(n){return"object"==typeof n&&"Td"in n?n.Td:this.key(this.convertHorzItemToInternal(n))}cacheKey(n){const t=n;return void 0===t.Pd?new Date(1e3*t.Td).getTime():new Date(Date.UTC(t.Pd.year,t.Pd.month-1,t.Pd.day)).getTime()}convertHorzItemToInternal(n){return tu(t=n)?to(t):si(t)?ru(t):ru(uu(t));var t}updateFormatter(n){if(this._n){const t=n.dateFormat;this.Rd=this._n.timeScale.timeVisible?new ya({bd:t,wd:this._n.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",gd:"   ",Md:n.locale}):new de(t,n.locale)}}formatHorzItem(n){const t=n;return this.Rd.j_(new Date(1e3*t.Td))}formatTickmark(n,t){const i=function(n,t,i){switch(n){case 0:case 10:return t?i?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return t?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(n.weight,this._n.timeScale.timeVisible,this._n.timeScale.secondsVisible),r=this._n.timeScale;if(void 0!==r.tickMarkFormatter){const u=r.tickMarkFormatter(n.originalTime,i,t.locale);if(null!==u)return u}return function(n,t,i){const r={};switch(t){case 0:r.year="numeric";break;case 1:r.month="short";break;case 2:r.day="numeric";break;case 3:r.hour12=!1;r.hour="2-digit";r.minute="2-digit";break;case 4:r.hour12=!1;r.hour="2-digit";r.minute="2-digit";r.second="2-digit"}const u=void 0===n.Pd?new Date(1e3*n.Td):new Date(Date.UTC(n.Pd.year,n.Pd.month-1,n.Pd.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(i,r)}(n.time,i,t.locale)}maxTickMarkWeight(n){let t=n.reduce(ua,n[0]).weight;return t>30&&t<50&&(t=30),t}fillWeightsForPoints(n,t){!function(n,t=0){if(0!==n.length){let i=0===t?null:n[t-1].time.Td,r=null!==i?new Date(1e3*i):null,u=0;for(let f=t;f<n.length;++f){const t=n[f],e=new Date(1e3*t.time.Td);null!==r&&(t.timeWeight=no(e,r));u+=t.time.Td-(i||t.time.Td);i=t.time.Td;r=e}if(0===t&&n.length>1){const t=Math.ceil(u/(n.length-1)),i=new Date(1e3*(n[0].time.Td-t));n[0].timeWeight=no(new Date(1e3*n[0].time.Td),i)}}}(n,t)}static Dd(n){return o({localization:{dateFormat:"dd MMM 'yy"}},null!=n?n:{})}}uo=function(){function n(n){var t=this;this._resolutionListener=function(){return t._onResolutionChanged()};this._resolutionMediaQueryList=null;this._observers=[];this._window=n;this._installResolutionListener()}return n.prototype.dispose=function(){this._uninstallResolutionListener();this._window=null},Object.defineProperty(n.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(n){var t=this,i={next:n};return this._observers.push(i),{unsubscribe:function(){t._observers=t._observers.filter(function(n){return n!==i})}}},n.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var n=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(n,"dppx)"));this._resolutionMediaQueryList.addListener(this._resolutionListener)},n.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},n.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener();this._installResolutionListener()},n.prototype._onResolutionChanged=function(){var n=this;this._observers.forEach(function(t){return t.next(n._window.devicePixelRatio)});this._reinstallResolutionListener()},n}();fo=function(){function n(n,i,r){var u;this._canvasElement=null;this._bitmapSizeChangedListeners=[];this._suggestedBitmapSize=null;this._suggestedBitmapSizeChangedListeners=[];this._devicePixelRatioObservable=null;this._canvasElementResizeObserver=null;this._canvasElement=n;this._canvasElementClientSize=t({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight});this._transformBitmapSize=null!=i?i:function(n){return n};this._allowResizeObserver=null===(u=null==r?void 0:r.allowResizeObserver)||void 0===u||u;this._chooseAndInitObserver()}return n.prototype.dispose=function(){var n,t;if(null===this._canvasElement)throw new Error("Object is disposed");null===(n=this._canvasElementResizeObserver)||void 0===n||n.disconnect();this._canvasElementResizeObserver=null;null===(t=this._devicePixelRatioObservable)||void 0===t||t.dispose();this._devicePixelRatioObservable=null;this._suggestedBitmapSizeChangedListeners.length=0;this._bitmapSizeChangedListeners.length=0;this._canvasElement=null},Object.defineProperty(n.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitmapSize",{get:function(){return t({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),n.prototype.resizeCanvasElement=function(n){this._canvasElementClientSize=t(n);this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px");this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px");this._invalidateBitmapSize()},n.prototype.subscribeBitmapSizeChanged=function(n){this._bitmapSizeChangedListeners.push(n)},n.prototype.unsubscribeBitmapSizeChanged=function(n){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(t){return t!==n})},Object.defineProperty(n.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),n.prototype.subscribeSuggestedBitmapSizeChanged=function(n){this._suggestedBitmapSizeChangedListeners.push(n)},n.prototype.unsubscribeSuggestedBitmapSizeChanged=function(n){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(t){return t!==n})},n.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var n=this._suggestedBitmapSize;this._suggestedBitmapSize=null;this._resizeBitmap(n);this._emitSuggestedBitmapSizeChanged(n,this._suggestedBitmapSize)}},n.prototype._resizeBitmap=function(n){var t=this.bitmapSize;w(t,n)||(this.canvasElement.width=n.width,this.canvasElement.height=n.height,this._emitBitmapSizeChanged(t,n))},n.prototype._emitBitmapSizeChanged=function(n,t){var i=this;this._bitmapSizeChangedListeners.forEach(function(r){return r.call(i,n,t)})},n.prototype._suggestNewBitmapSize=function(n){var r=this._suggestedBitmapSize,u=t(this._transformBitmapSize(n,this._canvasElementClientSize)),i=w(this.bitmapSize,u)?null:u;null===r&&null===i||null!==r&&null!==i&&w(r,i)||(this._suggestedBitmapSize=i,this._emitSuggestedBitmapSizeChanged(r,i))},n.prototype._emitSuggestedBitmapSizeChanged=function(n,t){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(r){return r.call(i,n,t)})},n.prototype._chooseAndInitObserver=function(){var n=this;this._allowResizeObserver?new Promise(function(n){var t=new ResizeObserver(function(i){n(i.every(function(n){return"devicePixelContentBoxSize"in n}));t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1}).then(function(t){return t?n._initResizeObserver():n._initDevicePixelRatioObservable()}):this._initDevicePixelRatioObservable()},n.prototype._initDevicePixelRatioObservable=function(){var t=this,n;if(null!==this._canvasElement){if(n=eo(this._canvasElement),null===n)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=function(n){return new uo(n)}(n);this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()});this._invalidateBitmapSize()}},n.prototype._invalidateBitmapSize=function(){var n,i,r;if(null!==this._canvasElement&&(r=eo(this._canvasElement),null!==r)){var u=null!==(i=null===(n=this._devicePixelRatioObservable)||void 0===n?void 0:n.value)&&void 0!==i?i:r.devicePixelRatio,f=this._canvasElement.getClientRects(),e=void 0!==f[0]?function(n,i){return t({width:Math.round(n.left*i+n.width*i)-Math.round(n.left*i),height:Math.round(n.top*i+n.height*i)-Math.round(n.top*i)})}(f[0],u):t({width:this._canvasElementClientSize.width*u,height:this._canvasElementClientSize.height*u});this._suggestNewBitmapSize(e)}},n.prototype._initResizeObserver=function(){var n=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver(function(i){var r=i.find(function(t){return t.target===n._canvasElement}),u,f;r&&r.devicePixelContentBoxSize&&r.devicePixelContentBoxSize[0]&&(u=r.devicePixelContentBoxSize[0],f=t({width:u.inlineSize,height:u.blockSize}),n._suggestNewBitmapSize(f))}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},n}();oo=function(){function n(n,t,i){if(0===t.width||0===t.height)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=t,0===i.width||0===i.height)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i;this._context=n}return n.prototype.useMediaCoordinateSpace=function(n){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),n({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},n.prototype.useBitmapCoordinateSpace=function(n){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),n({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(n.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),n}();const rt="undefined"!=typeof window;class pa{constructor(n,t,i,r){this.Bd=null;this.Ad=null;this.Vd=null;this.zd=null;this.Ed=null;this.Id=0;this.Ld=0;this.Nd=n;this.Fd=t;this.Wd=i;this.ss=r}jd(n,t){if(null!==this.Bd){if(this.Bd.ot===t)return void(this.Bd.Od=n);if(Math.abs(this.Bd.Od-n)<this.ss)return}this.zd=this.Vd;this.Vd=this.Ad;this.Ad=this.Bd;this.Bd={ot:t,Od:n}}Pr(n,t){if(null!==this.Bd&&null!==this.Ad&&!(t-this.Bd.ot>50)){let i=0;const f=su(this.Bd,this.Ad,this.Fd),o=ou(this.Bd,this.Ad),r=[f],e=[o];if(i+=o,null!==this.Vd){const n=su(this.Ad,this.Vd,this.Fd);if(Math.sign(n)===Math.sign(f)){const t=ou(this.Ad,this.Vd);if(r.push(n),e.push(t),i+=t,null!==this.zd){const n=su(this.Vd,this.zd,this.Fd);if(Math.sign(n)===Math.sign(f)){const t=ou(this.Vd,this.zd);r.push(n);e.push(t);i+=t}}}}let u=0;for(let n=0;n<r.length;++n)u+=e[n]/i*r[n];Math.abs(u)<this.Nd||(this.Ed={Od:n,ot:t},this.Ld=u,this.Id=function(n,t){const i=Math.log(t);return Math.log(1*i/-n)/i}(Math.abs(u),this.Wd))}}Zu(t){const i=n(this.Ed),r=t-i.ot;return i.Od+this.Ld*(Math.pow(this.Wd,r)-1)/Math.log(this.Wd)}Ku(n){return null===this.Ed||this.Hd(n)===this.Id}Hd(t){const i=t-n(this.Ed).ot;return Math.min(i,this.Id)}}class lu{constructor(n,t,i){this.$d=0;this.Ud=null;this.qd={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY};this.Yd=0;this.Xd=null;this.Kd={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY};this.Zd=null;this.Gd=!1;this.Jd=null;this.Qd=null;this.tf=!1;this.if=!1;this.nf=!1;this.sf=null;this.ef=null;this.rf=null;this.hf=null;this.lf=null;this.af=null;this._f=null;this.uf=0;this.cf=!1;this.df=!1;this.ff=!1;this.vf=0;this.pf=null;this.mf=!fu();this.bf=n=>{this.wf(n)};this.gf=n=>{if(this.Mf(n)){const t=this.xf(n);if(++this.Yd,this.Xd&&this.Yd>1){const{Sf:i}=this.yf(c(n),this.Kd);i<30&&!this.nf&&this.kf(t,this.Tf.Cf);this.Pf()}}else{const t=this.xf(n);if(++this.$d,this.Ud&&this.$d>1){const{Sf:i}=this.yf(c(n),this.qd);i<5&&!this.if&&this.Rf(t,this.Tf.Df);this.Of()}}};this.Bf=n;this.Tf=t;this._n=i;this.Af()}S(){null!==this.sf&&(this.sf(),this.sf=null);null!==this.ef&&(this.ef(),this.ef=null);null!==this.hf&&(this.hf(),this.hf=null);null!==this.lf&&(this.lf(),this.lf=null);null!==this.af&&(this.af(),this.af=null);null!==this.rf&&(this.rf(),this.rf=null);this.Vf();this.Of()}zf(n){this.hf&&this.hf();const t=this.Ef.bind(this);if(this.hf=()=>{this.Bf.removeEventListener("mousemove",t)},this.Bf.addEventListener("mousemove",t),!this.Mf(n)){const i=this.xf(n);this.Rf(i,this.Tf.If);this.mf=!0}}Of(){null!==this.Ud&&clearTimeout(this.Ud);this.$d=0;this.Ud=null;this.qd={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Pf(){null!==this.Xd&&clearTimeout(this.Xd);this.Yd=0;this.Xd=null;this.Kd={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Ef(n){if(!this.ff&&null===this.Qd&&!this.Mf(n)){const t=this.xf(n);this.Rf(t,this.Tf.Lf);this.mf=!0}}Nf(t){const i=au(t.changedTouches,n(this.pf));if(null!==i&&(this.vf=ai(t),null===this._f)&&!this.df){this.cf=!0;const u=this.yf(c(i),n(this.Qd)),{Ff:f,Wf:r,Sf:e}=u;if(this.tf||!(e<5)){if(!this.tf){const n=.5*f,t=r>=n&&!this._n.jf(),i=n>r&&!this._n.Hf();t||i||(this.df=!0);this.tf=!0;this.nf=!0;this.Vf();this.Pf()}if(!this.df){const n=this.xf(t,i);this.kf(n,this.Tf.$f);ut(t)}}}}Uf(t){if(0===t.button){const i=this.yf(c(t),n(this.Jd)),{Sf:r}=i;if(r>=5&&(this.if=!0,this.Of()),this.if){const n=this.xf(t);this.Rf(n,this.Tf.qf)}}}yf(n,t){const i=Math.abs(t.nt-n.nt),r=Math.abs(t.st-n.st);return{Ff:i,Wf:r,Sf:i+r}}Yf(t){let i=au(t.changedTouches,n(this.pf));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null!==i){this.pf=null;this.vf=ai(t);this.Vf();this.Qd=null;this.af&&(this.af(),this.af=null);const r=this.xf(t,i);if(this.kf(r,this.Tf.Xf),++this.Yd,this.Xd&&this.Yd>1){const{Sf:n}=this.yf(c(i),this.Kd);n<30&&!this.nf&&this.kf(r,this.Tf.Cf);this.Pf()}else this.nf||(this.kf(r,this.Tf.Kf),this.Tf.Kf&&ut(t));0===this.Yd&&ut(t);0===t.touches.length&&this.Gd&&(this.Gd=!1,ut(t))}}wf(n){if(0===n.button){const t=this.xf(n);if((this.Jd=null,this.ff=!1,this.lf&&(this.lf(),this.lf=null),so())&&this.Bf.ownerDocument.documentElement.removeEventListener("mouseleave",this.bf),!this.Mf(n))if(this.Rf(t,this.Tf.Zf),++this.$d,this.Ud&&this.$d>1){const{Sf:i}=this.yf(c(n),this.qd);i<5&&!this.if&&this.Rf(t,this.Tf.Df);this.Of()}else this.if||this.Rf(t,this.Tf.Gf)}}Vf(){null!==this.Zd&&(clearTimeout(this.Zd),this.Zd=null)}Jf(n){if(null===this.pf){const t=n.changedTouches[0];this.pf=t.identifier;this.vf=ai(n);const i=this.Bf.ownerDocument.documentElement;this.nf=!1;this.tf=!1;this.df=!1;this.Qd=c(t);this.af&&(this.af(),this.af=null);{const t=this.Nf.bind(this),r=this.Yf.bind(this);this.af=()=>{i.removeEventListener("touchmove",t),i.removeEventListener("touchend",r)};i.addEventListener("touchmove",t,{passive:!1});i.addEventListener("touchend",r,{passive:!1});this.Vf();this.Zd=setTimeout(this.Qf.bind(this,n),240)}const r=this.xf(n,t);this.kf(r,this.Tf.tv);this.Xd||(this.Yd=0,this.Xd=setTimeout(this.Pf.bind(this),500),this.Kd=c(t))}}iv(n){if(0===n.button){const t=this.Bf.ownerDocument.documentElement;so()&&t.addEventListener("mouseleave",this.bf);this.if=!1;this.Jd=c(n);this.lf&&(this.lf(),this.lf=null);{const n=this.Uf.bind(this),i=this.wf.bind(this);this.lf=()=>{t.removeEventListener("mousemove",n),t.removeEventListener("mouseup",i)};t.addEventListener("mousemove",n);t.addEventListener("mouseup",i)}if(this.ff=!0,!this.Mf(n)){const i=this.xf(n);this.Rf(i,this.Tf.nv);this.Ud||(this.$d=0,this.Ud=setTimeout(this.Of.bind(this),500),this.qd=c(n))}}}Af(){this.Bf.addEventListener("mouseenter",this.zf.bind(this));this.Bf.addEventListener("touchcancel",this.Vf.bind(this));{const n=this.Bf.ownerDocument,t=n=>{this.Tf.sv&&(n.composed&&this.Bf.contains(n.composedPath()[0])||n.target&&this.Bf.contains(n.target)||this.Tf.sv())};this.ef=()=>{n.removeEventListener("touchstart",t)};this.sf=()=>{n.removeEventListener("mousedown",t)};n.addEventListener("mousedown",t);n.addEventListener("touchstart",t,{passive:!0})}fu()&&(this.rf=()=>{this.Bf.removeEventListener("dblclick",this.gf)},this.Bf.addEventListener("dblclick",this.gf));this.Bf.addEventListener("mouseleave",this.ev.bind(this));this.Bf.addEventListener("touchstart",this.Jf.bind(this),{passive:!0});wa(this.Bf);this.Bf.addEventListener("mousedown",this.iv.bind(this));this.rv();this.Bf.addEventListener("touchmove",()=>{},{passive:!1})}rv(){void 0===this.Tf.hv&&void 0===this.Tf.lv&&void 0===this.Tf.av||(this.Bf.addEventListener("touchstart",n=>this.ov(n.touches),{passive:!0}),this.Bf.addEventListener("touchmove",n=>{if(2===n.touches.length&&null!==this._f&&void 0!==this.Tf.lv){const t=ho(n.touches[0],n.touches[1])/this.uf;this.Tf.lv(this._f,t);ut(n)}},{passive:!1}),this.Bf.addEventListener("touchend",n=>{this.ov(n.touches)}))}ov(n){1===n.length&&(this.cf=!1);2!==n.length||this.cf||this.Gd?this._v():this.uv(n)}uv(n){const t=this.Bf.getBoundingClientRect()||{left:0,top:0};this._f={nt:(n[0].clientX-t.left+(n[1].clientX-t.left))/2,st:(n[0].clientY-t.top+(n[1].clientY-t.top))/2};this.uf=ho(n[0],n[1]);void 0!==this.Tf.hv&&this.Tf.hv();this.Vf()}_v(){null!==this._f&&(this._f=null,void 0!==this.Tf.av&&this.Tf.av())}ev(n){if((this.hf&&this.hf(),!this.Mf(n))&&this.mf){const t=this.xf(n);this.Rf(t,this.Tf.cv);this.mf=!fu()}}Qf(t){const i=au(t.touches,n(this.pf));if(null!==i){const r=this.xf(t,i);this.kf(r,this.Tf.dv);this.nf=!0;this.Gd=!0}}Mf(n){return n.sourceCapabilities&&void 0!==n.sourceCapabilities.firesTouchEvents?n.sourceCapabilities.firesTouchEvents:ai(n)<this.vf+500}kf(n,t){t&&t.call(this.Tf,n)}Rf(n,t){t&&t.call(this.Tf,n)}xf(n,t){const i=t||n,r=this.Bf.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-r.left,localY:i.clientY-r.top,ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey,fv:!n.type.startsWith("mouse")&&"contextmenu"!==n.type&&"click"!==n.type,vv:n.type,pv:i.target,mv:n.view,bv:()=>{"touchstart"!==n.type&&ut(n)}}}}class co{constructor(n,i,r,u){this.Ei=null;this.xv=null;this.Sv=!1;this.yv=new ht(200);this.Zr=null;this.kv=0;this.Cv=!1;this.Tv=()=>{this.Cv||this.Qi.Pv().$t().Wh()};this.Rv=()=>{this.Cv||this.Qi.Pv().$t().Wh()};this.Qi=n;this._n=i;this.wo=i.layout;this.Tc=r;this.Dv="left"===u;this.Ov=vu("normal",u);this.Bv=vu("top",u);this.Av=vu("bottom",u);this.Vv=document.createElement("div");this.Vv.style.height="100%";this.Vv.style.overflow="hidden";this.Vv.style.width="25px";this.Vv.style.left="0";this.Vv.style.position="relative";this.zv=k(this.Vv,t({width:16,height:16}));this.zv.subscribeSuggestedBitmapSizeChanged(this.Tv);const f=this.zv.canvasElement;f.style.position="absolute";f.style.zIndex="1";f.style.left="0";f.style.top="0";this.Ev=k(this.Vv,t({width:16,height:16}));this.Ev.subscribeSuggestedBitmapSizeChanged(this.Rv);const e=this.Ev.canvasElement;e.style.position="absolute";e.style.zIndex="2";e.style.left="0";e.style.top="0";const o={nv:this.Iv.bind(this),tv:this.Iv.bind(this),qf:this.Lv.bind(this),$f:this.Lv.bind(this),sv:this.Nv.bind(this),Zf:this.Fv.bind(this),Xf:this.Fv.bind(this),Df:this.Wv.bind(this),Cf:this.Wv.bind(this),If:this.jv.bind(this),cv:this.Hv.bind(this)};this.$v=new lu(this.Ev.canvasElement,o,{jf:()=>!this._n.handleScroll.vertTouchDrag,Hf:()=>!0})}S(){this.$v.S();this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Rv);d(this.Ev.canvasElement);this.Ev.dispose();this.zv.unsubscribeSuggestedBitmapSizeChanged(this.Tv);d(this.zv.canvasElement);this.zv.dispose();null!==this.Ei&&this.Ei.qo().p(this);this.Ei=null}Uv(){return this.Vv}P(){return this.wo.fontSize}qv(){const n=this.Tc.W();return this.Zr!==n.R&&(this.yv.Qe(),this.Zr=n.R),n}Yv(){if(null===this.Ei)return 0;let i=0;const u=this.qv(),t=n(this.zv.canvasElement.getContext("2d"));t.save();const f=this.Ei.Na();t.font=this.Xv();f.length>0&&(i=Math.max(this.yv.Mi(t,f[0].Ja),this.yv.Mi(t,f[f.length-1].Ja)));const e=this.Kv();for(let n=e.length;n--;){const r=this.yv.Mi(t,e[n].Zt());r>i&&(i=r)}const r=this.Ei.Ct();if(null!==r&&null!==this.xv){const n=this.Ei.fn(1,r),u=this.Ei.fn(this.xv.height-2,r);i=Math.max(i,this.yv.Mi(t,this.Ei.Ni(Math.floor(Math.min(n,u))+.11111111111111,r)),this.yv.Mi(t,this.Ei.Ni(Math.ceil(Math.max(n,u))-.11111111111111,r)))}t.restore();const o=i||34;return eu(Math.ceil(u.C+u.T+u.V+u.I+5+o))}Zv(n){null!==this.xv&&w(this.xv,n)||(this.xv=n,this.Cv=!0,this.zv.resizeCanvasElement(n),this.Ev.resizeCanvasElement(n),this.Cv=!1,this.Vv.style.width=`${n.width}px`,this.Vv.style.height=`${n.height}px`)}Gv(){return n(this.xv).width}Zi(n){this.Ei!==n&&(null!==this.Ei&&this.Ei.qo().p(this),this.Ei=n,n.qo().l(this._o.bind(this),this))}Dt(){return this.Ei}Qe(){const t=this.Qi.Jv();this.Qi.Pv().$t().V_(t,n(this.Dt()))}Qv(n){if(null!==this.xv){if(1!==n){this.tp();this.zv.applySuggestedBitmapSize();const n=b(this.zv);null!==n&&(n.useBitmapCoordinateSpace(n=>{this.ip(n),this.Be(n)}),this.Qi.np(n,this.Av),this.sp(n),this.Qi.np(n,this.Ov),this.ep(n))}this.Ev.applySuggestedBitmapSize();const t=b(this.Ev);null!==t&&(t.useBitmapCoordinateSpace({context:t,bitmapSize:n}=>{t.clearRect(0,0,n.width,n.height)}),this.rp(t),this.Qi.np(t,this.Bv))}}hp(){return this.zv.bitmapSize}lp(n,t,i){const r=this.hp();r.width>0&&r.height>0&&n.drawImage(this.zv.canvasElement,t,i)}bt(){var n;null===(n=this.Ei)||void 0===n||n.Na()}Iv(n){if(null!==this.Ei&&!this.Ei.Li()&&this._n.handleScale.axisPressedMouseMove.price){const t=this.Qi.Pv().$t(),i=this.Qi.Jv();this.Sv=!0;t.T_(i,this.Ei,n.localY)}}Lv(n){if(null!==this.Ei&&this._n.handleScale.axisPressedMouseMove.price){const t=this.Qi.Pv().$t(),i=this.Qi.Jv(),r=this.Ei;t.P_(i,r,n.localY)}}Nv(){if(null!==this.Ei&&this._n.handleScale.axisPressedMouseMove.price){const n=this.Qi.Pv().$t(),t=this.Qi.Jv(),i=this.Ei;this.Sv&&(this.Sv=!1,n.R_(t,i))}}Fv(){if(null!==this.Ei&&this._n.handleScale.axisPressedMouseMove.price){const n=this.Qi.Pv().$t(),t=this.Qi.Jv();this.Sv=!1;n.R_(t,this.Ei)}}Wv(){this._n.handleScale.axisDoubleClickReset.price&&this.Qe()}jv(){null!==this.Ei&&(!this.Qi.Pv().$t().W().handleScale.axisPressedMouseMove.price||this.Ei.mh()||this.Ei.Po()||this.ap(1))}Hv(){this.ap(0)}Kv(){const n=[],t=null===this.Ei?void 0:this.Ei;return(i=>{for(let r=0;r<i.length;++r){const u=i[r].Tn(this.Qi.Jv(),t);for(let t=0;t<u.length;t++)n.push(u[t])}})(this.Qi.Jv().Wo()),n}ip({context:t,bitmapSize:n}){const{width:r,height:u}=n,f=this.Qi.Jv().$t(),i=f.q(),e=f.dd();i===e?gt(t,0,0,r,u,i):sf(t,0,0,r,u,i,e)}Be({context:i,bitmapSize:n,horizontalPixelRatio:t}){if(null!==this.xv&&null!==this.Ei&&this.Ei.W().borderVisible){i.fillStyle=this.Ei.W().borderColor;const r=Math.max(1,Math.floor(this.qv().C*t));let u;u=this.Dv?n.width-r:0;i.fillRect(u,0,r,n.height)}}sp(n){if(null!==this.xv&&null!==this.Ei){const i=this.Ei.Na(),r=this.Ei.W(),t=this.qv(),u=this.Dv?this.xv.width-t.T:0;r.borderVisible&&r.ticksVisible&&n.useBitmapCoordinateSpace({context:e,horizontalPixelRatio:f,verticalPixelRatio:n}=>{e.fillStyle=r.borderColor;const o=Math.max(1,Math.floor(n)),s=Math.floor(.5*n),h=Math.round(t.T*f);e.beginPath();for(const t of i)e.rect(Math.floor(u*f),Math.round(t.Va*n)-s,h,o);e.fill()});n.useMediaCoordinateSpace({context:n}=>{var f;n.font=this.Xv();n.fillStyle=null!==(f=r.textColor)&&void 0!==f?f:this.wo.textColor;n.textAlign=this.Dv?"right":"left";n.textBaseline="middle";const e=this.Dv?Math.round(u-t.V):Math.round(u+t.T+t.V),o=i.map(t=>this.yv.gi(n,t.Ja));for(let t=i.length;t--;){const r=i[t];n.fillText(r.Ja,e,r.Va+o[t])}})}}tp(){if(null!==this.xv&&null!==this.Ei){let i=this.xv.height/2;const n=[],r=this.Ei.Wo().slice(),t=this.Qi.Jv(),u=this.qv();this.Ei===t.cr()&&this.Qi.Jv().Wo().forEach(n=>{t.ur(n)&&r.push(n)});const f=this.Ei.Ra()[0],e=this.Ei;r.forEach(r=>{const u=r.Tn(t,e);u.forEach(t=>{t.Oi(null),t.Bi()&&n.push(t)});f===r&&u.length>0&&(i=u[0].Si())});n.forEach(n=>n.Oi(n.Si()));this.Ei.W().alignLabels&&this.op(n,u,i)}}op(n,t,i){if(null!==this.xv){const r=n.filter(n=>n.Si()<=i),u=n.filter(n=>n.Si()>i);r.sort((n,t)=>t.Si()-n.Si());r.length&&u.length&&u.push(r[0]);u.sort((n,t)=>n.Si()-t.Si());for(const n of n){const i=Math.floor(n.Vt(t)/2),r=n.Si();r>-i&&r<i&&n.Oi(i);r>this.xv.height-i&&r<this.xv.height+i&&n.Oi(this.xv.height-i)}for(let n=1;n<r.length;n++){const i=r[n],u=r[n-1],f=u.Vt(t,!1),o=i.Si(),e=u.Di();o>e-f&&i.Oi(e-f)}for(let n=1;n<u.length;n++){const i=u[n],r=u[n-1],f=r.Vt(t,!0),o=i.Si(),e=r.Di();o<e+f&&i.Oi(e+f)}}}ep(t){if(null!==this.xv){const i=this.Kv(),r=this.qv(),u=this.Dv?"right":"left";i.forEach(i=>{i.Ai()&&i.gt(n(this.Ei)).K(t,r,this.yv,u)})}}rp(t){if(null!==this.xv&&null!==this.Ei){const u=this.Qi.Pv().$t(),i=[],f=this.Qi.Jv(),r=u.Hc().Tn(f,this.Ei);r.length&&i.push(r);const e=this.qv(),o=this.Dv?"right":"left";i.forEach(i=>{i.forEach(i=>{i.gt(n(this.Ei)).K(t,e,this.yv,o)})})}}ap(n){this.Vv.style.cursor=1===n?"ns-resize":"default"}_o(){const n=this.Yv();this.kv<n&&this.Qi.Pv().$t().ql();this.kv=n}Xv(){return tt(this.wo.fontSize,this.wo.fontFamily)}}class lo{constructor(n,r){this.xv=t({width:0,height:0});this._p=null;this.up=null;this.cp=null;this.dp=!1;this.fp=new i;this.vp=new i;this.pp=0;this.mp=!1;this.bp=null;this.wp=!1;this.gp=null;this.Mp=null;this.Cv=!1;this.Tv=()=>{this.Cv||null===this.xp||this.Hi().Wh()};this.Rv=()=>{this.Cv||null===this.xp||this.Hi().Wh()};this.Sp=n;this.xp=r;this.xp.I_().l(this.yp.bind(this),this,!0);this.kp=document.createElement("td");this.kp.style.padding="0";this.kp.style.position="relative";const u=document.createElement("div");u.style.width="100%";u.style.height="100%";u.style.position="relative";u.style.overflow="hidden";this.Cp=document.createElement("td");this.Cp.style.padding="0";this.Tp=document.createElement("td");this.Tp.style.padding="0";this.kp.appendChild(u);this.zv=k(u,t({width:16,height:16}));this.zv.subscribeSuggestedBitmapSizeChanged(this.Tv);const f=this.zv.canvasElement;f.style.position="absolute";f.style.zIndex="1";f.style.left="0";f.style.top="0";this.Ev=k(u,t({width:16,height:16}));this.Ev.subscribeSuggestedBitmapSizeChanged(this.Rv);const e=this.Ev.canvasElement;e.style.position="absolute";e.style.zIndex="2";e.style.left="0";e.style.top="0";this.Pp=document.createElement("tr");this.Pp.appendChild(this.Cp);this.Pp.appendChild(this.kp);this.Pp.appendChild(this.Tp);this.Rp();this.$v=new lu(this.Ev.canvasElement,this,{jf:()=>null===this.bp&&!this.Sp.W().handleScroll.vertTouchDrag,Hf:()=>null===this.bp&&!this.Sp.W().handleScroll.horzTouchDrag})}S(){null!==this._p&&this._p.S();null!==this.up&&this.up.S();this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Rv);d(this.Ev.canvasElement);this.Ev.dispose();this.zv.unsubscribeSuggestedBitmapSizeChanged(this.Tv);d(this.zv.canvasElement);this.zv.dispose();null!==this.xp&&this.xp.I_().p(this);this.$v.S()}Jv(){return n(this.xp)}Dp(n){null!==this.xp&&this.xp.I_().p(this);this.xp=n;null!==this.xp&&this.xp.I_().l(lo.prototype.yp.bind(this),this,!0);this.Rp()}Pv(){return this.Sp}Uv(){return this.Pp}Rp(){if(null!==this.xp&&(this.Op(),0!==this.Hi().wt().length)){if(null!==this._p){const t=this.xp.k_();this._p.Zi(n(t))}if(null!==this.up){const t=this.xp.C_();this.up.Zi(n(t))}}}Bp(){null!==this._p&&this._p.bt();null!==this.up&&this.up.bt()}m_(){return null!==this.xp?this.xp.m_():0}b_(n){this.xp&&this.xp.b_(n)}If(n){if(this.xp){this.Ap();const t=n.localX,i=n.localY;this.Vp(t,i,n)}}nv(n){this.Ap();this.zp();this.Vp(n.localX,n.localY,n)}Lf(n){var i;if(this.xp){this.Ap();const r=n.localX,u=n.localY;this.Vp(r,u,n);const t=this.pr(r,u);this.Sp.Ep(null!==(i=null==t?void 0:t.Mv)&&void 0!==i?i:null);this.Hi().Ic(t&&{Lc:t.Lc,wv:t.wv})}}Gf(n){null!==this.xp&&(this.Ap(),this.Ip(n))}Df(n){null!==this.xp&&this.Lp(this.vp,n)}Cf(n){this.Df(n)}qf(n){this.Ap();this.Np(n);this.Vp(n.localX,n.localY,n)}Zf(n){null!==this.xp&&(this.Ap(),this.mp=!1,this.Fp(n))}Kf(n){null!==this.xp&&this.Ip(n)}dv(n){if(this.mp=!0,null===this.bp){const t={x:n.localX,y:n.localY};this.Wp(t,t,n)}}cv(){null!==this.xp&&(this.Ap(),this.xp.$t().Ic(null),this.jp())}Hp(){return this.fp}$p(){return this.vp}hv(){this.pp=1;this.Hi().Hn()}lv(n,t){if(this.Sp.W().handleScale.pinch){const i=5*(t-this.pp);this.pp=t;this.Hi().Xc(n.nt,i)}}tv(n){this.mp=!1;this.wp=null!==this.bp;this.zp();const t=this.Hi().Hc();null!==this.bp&&t.kt()&&(this.gp={x:t.Yt(),y:t.Xt()},this.bp={x:n.localX,y:n.localY})}$f(t){if(null!==this.xp){const i=t.localX,r=t.localY;if(null===this.bp)this.Np(t);else{this.wp=!1;const u=n(this.gp),f=u.x+(i-this.bp.x),e=u.y+(r-this.bp.y);this.Vp(f,e,t)}}}Xf(n){0===this.Pv().W().trackingMode.exitMode&&(this.wp=!0);this.Up();this.Fp(n)}pr(n,t){const i=this.xp;return null===i?null:function(n,t,i){const u=n.Wo(),r=function(n,t,i){var u,f,o,s;let r,e;for(const n of n){const h=null!==(f=null===(u=n.ua)||void 0===u?void 0:u.call(n,t,i))&&void 0!==f?f:[];for(const t of h)o=t.zOrder,(s=null==r?void 0:r.zOrder)&&("top"!==o||"top"===s)&&("normal"!==o||"bottom"!==s)||(r=t,e=n)}return r&&e?{gv:r,Lc:e}:null}(u,t,i);if("top"===(null==r?void 0:r.gv.zOrder))return vi(r);for(const u of u){if(r&&r.Lc===u&&"bottom"!==r.gv.zOrder&&!r.gv.isBackground)return vi(r);const f=ba(u.Cn(n),t,i);if(null!==f)return{Lc:u,mv:f.mv,wv:f.wv};if(r&&r.Lc===u&&"bottom"!==r.gv.zOrder&&r.gv.isBackground)return vi(r)}return(null==r?void 0:r.gv)?vi(r):null}(i,n,t)}qp(i,r){n("left"===r?this._p:this.up).Zv(t({width:i,height:this.xv.height}))}Yp(){return this.xv}Zv(n){w(this.xv,n)||(this.xv=n,this.Cv=!0,this.zv.resizeCanvasElement(n),this.Ev.resizeCanvasElement(n),this.Cv=!1,this.kp.style.width=n.width+"px",this.kp.style.height=n.height+"px")}Xp(){const t=n(this.xp);t.y_(t.k_());t.y_(t.C_());for(const n of t.Ra())if(t.ur(n)){const i=n.Dt();null!==i&&t.y_(i);n.Rn()}}hp(){return this.zv.bitmapSize}lp(n,t,i){const r=this.hp();r.width>0&&r.height>0&&n.drawImage(this.zv.canvasElement,t,i)}Qv(n){if(0!==n&&null!==this.xp){if(n>1&&this.Xp(),null!==this._p&&this._p.Qv(n),null!==this.up&&this.up.Qv(n),1!==n){this.zv.applySuggestedBitmapSize();const n=b(this.zv);null!==n&&(n.useBitmapCoordinateSpace(n=>{this.ip(n)}),this.xp&&(this.Kp(n,ka),this.Zp(n),this.Gp(n),this.Kp(n,yi),this.Kp(n,da)))}this.Ev.applySuggestedBitmapSize();const t=b(this.Ev);null!==t&&(t.useBitmapCoordinateSpace({context:t,bitmapSize:n}=>{t.clearRect(0,0,n.width,n.height)}),this.Jp(t),this.Kp(t,ga))}}Qp(){return this._p}tm(){return this.up}np(n,t){this.Kp(n,t)}yp(){null!==this.xp&&this.xp.I_().p(this);this.xp=null}Ip(n){this.Lp(this.fp,n)}Lp(n,t){const i=t.localX,r=t.localY;n.M()&&n.m(this.Hi().St().zu(i),{x:i,y:r},t)}ip({context:t,bitmapSize:n}){const{width:r,height:u}=n,f=this.Hi(),e=f.q(),i=f.dd();e===i?gt(t,0,0,r,u,i):sf(t,0,0,r,u,e,i)}Zp(t){const i=n(this.xp).L_().jh().gt();null!==i&&i.K(t,!1)}Gp(n){const t=this.Hi().jc();this.im(n,yi,hu,t);this.im(n,yi,li,t)}Jp(n){this.im(n,yi,li,this.Hi().Hc())}Kp(t,i){const r=n(this.xp).Wo();for(const n of r)this.im(t,i,hu,n);for(const n of r)this.im(t,i,li,n)}im(t,i,r,u){const e=n(this.xp),f=e.$t().Ec(),o=null!==f&&f.Lc===u,s=null!==f&&o&&void 0!==f.wv?f.wv.br:void 0;cu(i,n=>r(n,t,o,s),u,e)}Op(){if(null!==this.xp){const n=this.Sp,t=this.xp.k_().W().visible,i=this.xp.C_().W().visible;t||null===this._p||(this.Cp.removeChild(this._p.Uv()),this._p.S(),this._p=null);i||null===this.up||(this.Tp.removeChild(this.up.Uv()),this.up.S(),this.up=null);const r=n.$t().hd();t&&null===this._p&&(this._p=new co(this,n.W(),r,"left"),this.Cp.appendChild(this._p.Uv()));i&&null===this.up&&(this.up=new co(this,n.W(),r,"right"),this.Tp.appendChild(this.up.Uv()))}}nm(n){return n.fv&&this.mp||null!==this.bp}sm(n){return Math.max(0,Math.min(n,this.xv.width-1))}rm(n){return Math.max(0,Math.min(n,this.xv.height-1))}Vp(t,i,r){this.Hi().nd(this.sm(t),this.rm(i),r,n(this.xp))}jp(){this.Hi().ed()}Up(){this.wp&&(this.bp=null,this.jp())}Wp(n,t,i){this.bp=n;this.wp=!1;this.Vp(t.x,t.y,i);const r=this.Hi().Hc();this.gp={x:r.Yt(),y:r.Xt()}}Hi(){return this.Sp.$t()}Fp(){if(this.dp){const n=this.Hi(),t=this.Jv();if(n.B_(t,t.dn()),this.cp=null,this.dp=!1,n.Jc(),null!==this.Mp){const t=performance.now(),i=n.St();this.Mp.Pr(i.Nu(),t);this.Mp.Ku(t)||n.qn(this.Mp)}}}Ap(){this.bp=null}zp(){if(this.xp){if(this.Hi().Hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)n(document.activeElement).blur();else{const n=document.getSelection();null!==n&&n.removeAllRanges()}this.xp.dn().Li()||this.Hi().St().Li()}}Np(n){if(null!==this.xp){const t=this.Hi(),i=t.St();if(!i.Li()){const f=this.Sp.W(),u=f.handleScroll,e=f.kineticScroll;if(u.pressedMouseMove&&!n.fv||(u.horzTouchDrag||u.vertTouchDrag)&&n.fv){const r=this.xp.dn(),o=performance.now();if(null!==this.cp||this.nm(n)||(this.cp={x:n.clientX,y:n.clientY,Td:o,hm:n.localX,lm:n.localY}),null!==this.cp&&!this.dp&&(this.cp.x!==n.clientX||this.cp.y!==n.clientY)){if(n.fv&&e.touch||!n.fv&&e.mouse){const n=i.ee();this.Mp=new pa(.2/n,7/n,.997,15/n);this.Mp.jd(i.Nu(),this.cp.Td)}else this.Mp=null;r.Li()||t.D_(this.xp,r,n.localY);t.Zc(n.localX);this.dp=!0}this.dp&&(r.Li()||t.O_(this.xp,r,n.localY),t.Gc(n.localX),null!==this.Mp&&this.Mp.jd(i.Nu(),o))}}}}}class ao{constructor(n,i,r,u,f){this.ft=!0;this.xv=t({width:0,height:0});this.Tv=()=>this.Qv(3);this.Dv="left"===n;this.Tc=r.hd;this._n=i;this.am=u;this.om=f;this.Vv=document.createElement("div");this.Vv.style.width="25px";this.Vv.style.height="100%";this.Vv.style.overflow="hidden";this.zv=k(this.Vv,t({width:16,height:16}));this.zv.subscribeSuggestedBitmapSizeChanged(this.Tv)}S(){this.zv.unsubscribeSuggestedBitmapSizeChanged(this.Tv);d(this.zv.canvasElement);this.zv.dispose()}Uv(){return this.Vv}Yp(){return this.xv}Zv(n){w(this.xv,n)||(this.xv=n,this.zv.resizeCanvasElement(n),this.Vv.style.width=`${n.width}px`,this.Vv.style.height=`${n.height}px`,this.ft=!0)}Qv(n){if((!(n<3)||this.ft)&&0!==this.xv.width&&0!==this.xv.height){this.ft=!1;this.zv.applySuggestedBitmapSize();const t=b(this.zv);null!==t&&t.useBitmapCoordinateSpace(n=>{this.ip(n),this.Be(n)})}}hp(){return this.zv.bitmapSize}lp(n,t,i){const r=this.hp();r.width>0&&r.height>0&&n.drawImage(this.zv.canvasElement,t,i)}Be({context:r,bitmapSize:n,horizontalPixelRatio:t,verticalPixelRatio:i}){if(this.am()){r.fillStyle=this._n.timeScale.borderColor;const u=Math.floor(this.Tc.W().C*t),f=Math.floor(this.Tc.W().C*i),e=this.Dv?n.width-u:0;r.fillRect(e,0,u,f)}}ip({context:t,bitmapSize:n}){gt(t,0,0,n.width,n.height,this.om())}}const nv=yu("normal"),tv=yu("top"),iv=yu("bottom");class rv{constructor(n,r){this._m=null;this.um=null;this.k=null;this.dm=!1;this.xv=t({width:0,height:0});this.fm=new i;this.yv=new ht(5);this.Cv=!1;this.Tv=()=>{this.Cv||this.Sp.$t().Wh()};this.Rv=()=>{this.Cv||this.Sp.$t().Wh()};this.Sp=n;this.W_=r;this._n=n.W().layout;this.vm=document.createElement("tr");this.pm=document.createElement("td");this.pm.style.padding="0";this.bm=document.createElement("td");this.bm.style.padding="0";this.Vv=document.createElement("td");this.Vv.style.height="25px";this.Vv.style.padding="0";this.wm=document.createElement("div");this.wm.style.width="100%";this.wm.style.height="100%";this.wm.style.position="relative";this.wm.style.overflow="hidden";this.Vv.appendChild(this.wm);this.zv=k(this.wm,t({width:16,height:16}));this.zv.subscribeSuggestedBitmapSizeChanged(this.Tv);const u=this.zv.canvasElement;u.style.position="absolute";u.style.zIndex="1";u.style.left="0";u.style.top="0";this.Ev=k(this.wm,t({width:16,height:16}));this.Ev.subscribeSuggestedBitmapSizeChanged(this.Rv);const f=this.Ev.canvasElement;f.style.position="absolute";f.style.zIndex="2";f.style.left="0";f.style.top="0";this.vm.appendChild(this.pm);this.vm.appendChild(this.Vv);this.vm.appendChild(this.bm);this.gm();this.Sp.$t().p_().l(this.gm.bind(this),this);this.$v=new lu(this.Ev.canvasElement,this,{jf:()=>!0,Hf:()=>!this.Sp.W().handleScroll.horzTouchDrag})}S(){this.$v.S();null!==this._m&&this._m.S();null!==this.um&&this.um.S();this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Rv);d(this.Ev.canvasElement);this.Ev.dispose();this.zv.unsubscribeSuggestedBitmapSizeChanged(this.Tv);d(this.zv.canvasElement);this.zv.dispose()}Uv(){return this.vm}Mm(){return this._m}xm(){return this.um}nv(n){if(!this.dm){this.dm=!0;const t=this.Sp.$t();!t.St().Li()&&this.Sp.W().handleScale.axisPressedMouseMove.time&&t.Yc(n.localX)}}tv(n){this.nv(n)}sv(){const n=this.Sp.$t();!n.St().Li()&&this.dm&&(this.dm=!1,this.Sp.W().handleScale.axisPressedMouseMove.time&&n.td())}qf(n){const t=this.Sp.$t();!t.St().Li()&&this.Sp.W().handleScale.axisPressedMouseMove.time&&t.Qc(n.localX)}$f(n){this.qf(n)}Zf(){this.dm=!1;const n=this.Sp.$t();n.St().Li()&&!this.Sp.W().handleScale.axisPressedMouseMove.time||n.td()}Xf(){this.Zf()}Df(){this.Sp.W().handleScale.axisDoubleClickReset.time&&this.Sp.$t().Xn()}Cf(){this.Df()}If(){this.Sp.$t().W().handleScale.axisPressedMouseMove.time&&this.ap(1)}cv(){this.ap(0)}Yp(){return this.xv}Sm(){return this.fm}ym(n,i,r){w(this.xv,n)||(this.xv=n,this.Cv=!0,this.zv.resizeCanvasElement(n),this.Ev.resizeCanvasElement(n),this.Cv=!1,this.Vv.style.width=`${n.width}px`,this.Vv.style.height=`${n.height}px`,this.fm.m(n));null!==this._m&&this._m.Zv(t({width:i,height:n.height}));null!==this.um&&this.um.Zv(t({width:r,height:n.height}))}km(){const n=this.Cm();return Math.ceil(n.C+n.T+n.P+n.L+n.A+n.Tm)}bt(){this.Sp.$t().St().Na()}hp(){return this.zv.bitmapSize}lp(n,t,i){const r=this.hp();r.width>0&&r.height>0&&n.drawImage(this.zv.canvasElement,t,i)}Qv(n){if(0!==n){if(1!==n){this.zv.applySuggestedBitmapSize();const t=b(this.zv);null!==t&&(t.useBitmapCoordinateSpace(n=>{this.ip(n),this.Be(n),this.Pm(t,iv)}),this.sp(t),this.Pm(t,nv));null!==this._m&&this._m.Qv(n);null!==this.um&&this.um.Qv(n)}this.Ev.applySuggestedBitmapSize();const t=b(this.Ev);null!==t&&(t.useBitmapCoordinateSpace({context:t,bitmapSize:n}=>{t.clearRect(0,0,n.width,n.height)}),this.Rm([...this.Sp.$t().wt(),this.Sp.$t().Hc()],t),this.Pm(t,tv))}}Pm(n,t){const i=this.Sp.$t().wt();for(const i of i)cu(t,t=>hu(t,n,!1,void 0),i,void 0);for(const i of i)cu(t,t=>li(t,n,!1,void 0),i,void 0)}ip({context:t,bitmapSize:n}){gt(t,0,0,n.width,n.height,this.Sp.$t().dd())}Be({context:i,bitmapSize:n,verticalPixelRatio:t}){if(this.Sp.W().timeScale.borderVisible){i.fillStyle=this.Dm();const r=Math.max(1,Math.floor(this.Cm().C*t));i.fillRect(0,0,n.width,r)}}sp(n){const r=this.Sp.$t().St(),t=r.Na();if(t&&0!==t.length){const u=this.W_.maxTickMarkWeight(t),i=this.Cm(),f=r.W();f.borderVisible&&f.ticksVisible&&n.useBitmapCoordinateSpace({context:u,horizontalPixelRatio:n,verticalPixelRatio:r}=>{u.strokeStyle=this.Dm();u.fillStyle=this.Dm();const f=Math.max(1,Math.floor(n)),e=Math.floor(.5*n);u.beginPath();const o=Math.round(i.T*r);for(let i=t.length;i--;){const r=Math.round(t[i].coord*n);u.rect(r-e,0,f,o)}u.fill()});n.useMediaCoordinateSpace({context:n}=>{const r=i.C+i.T+i.L+i.P/2;n.textAlign="center";n.textBaseline="middle";n.fillStyle=this.$();n.font=this.Xv();for(const t of t)if(t.weight<u){const i=t.needAlignCoordinate?this.Om(n,t.coord,t.label):t.coord;n.fillText(t.label,i,r)}this.Sp.W().timeScale.allowBoldLabels&&(n.font=this.Bm());for(const t of t)if(t.weight>=u){const i=t.needAlignCoordinate?this.Om(n,t.coord,t.label):t.coord;n.fillText(t.label,i,r)}})}}Om(n,t,i){const u=this.yv.Mi(n,i),f=u/2,r=Math.floor(t-f)+.5;return r<0?t+=Math.abs(0-r):r+u>this.xv.width&&(t-=Math.abs(this.xv.width-(r+u))),t}Rm(n,t){const i=this.Cm();for(const n of n)for(const n of n.Ji())n.gt().K(t,i)}Dm(){return this.Sp.W().timeScale.borderColor}$(){return this._n.textColor}j(){return this._n.fontSize}Xv(){return tt(this.j(),this._n.fontFamily)}Bm(){return tt(this.j(),this._n.fontFamily,"bold")}Cm(){null===this.k&&(this.k={C:1,N:NaN,L:NaN,A:NaN,Wi:NaN,T:5,P:NaN,R:"",Fi:new ht,Tm:0});const n=this.k,t=this.Xv();if(n.R!==t){const i=this.j();n.P=i;n.R=t;n.L=i/4;n.A=i/4;n.Wi=9*i/12;n.N=0;n.Tm=i/3;n.Fi.Qe()}return this.k}ap(n){this.Vv.style.cursor=1===n?"ew-resize":"default"}gm(){const t=this.Sp.$t(),n=t.W();n.leftPriceScale.visible||null===this._m||(this.pm.removeChild(this._m.Uv()),this._m.S(),this._m=null);n.rightPriceScale.visible||null===this.um||(this.bm.removeChild(this.um.Uv()),this.um.S(),this.um=null);const i={hd:this.Sp.$t().hd()},r=()=>n.leftPriceScale.borderVisible&&t.St().W().borderVisible,u=()=>t.dd();n.leftPriceScale.visible&&null===this._m&&(this._m=new ao("left",n,i,r,u),this.pm.appendChild(this._m.Uv()));n.rightPriceScale.visible&&null===this.um&&(this.um=new ao("right",n,i,r,u),this.bm.appendChild(this.um.Uv()))}}const uv=!!rt&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(n=>n.brand.includes("Chromium"))&&!!rt&&((null===(pu=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===pu?void 0:pu.platform)?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);class fv{constructor(n,t,r){var u;this.Am=[];this.Vm=0;this.no=0;this.h_=0;this.zm=0;this.Em=0;this.Im=null;this.Lm=!1;this.fp=new i;this.vp=new i;this.yc=new i;this.Nm=null;this.Fm=null;this.Wm=n;this._n=t;this.W_=r;this.vm=document.createElement("div");this.vm.classList.add("tv-lightweight-charts");this.vm.style.overflow="hidden";this.vm.style.direction="ltr";this.vm.style.width="100%";this.vm.style.height="100%";(u=this.vm).style.userSelect="none";u.style.webkitUserSelect="none";u.style.msUserSelect="none";u.style.MozUserSelect="none";u.style.webkitTapHighlightColor="transparent";this.jm=document.createElement("table");this.jm.setAttribute("cellspacing","0");this.vm.appendChild(this.jm);this.Hm=this.$m.bind(this);wu(this._n)&&this.Um(!0);this.Hi=new ca(this.Cc.bind(this),this._n,r);this.$t().$c().l(this.qm.bind(this),this);this.Ym=new rv(this,this.W_);this.jm.appendChild(this.Ym.Uv());const o=t.autoSize&&this.Xm();let f=this._n.width,e=this._n.height;if(o||0===f||0===e){const t=n.getBoundingClientRect();f=f||t.width;e=e||t.height}this.Km(f,e);this.Zm();n.appendChild(this.vm);this.Gm();this.Hi.St().Qu().l(this.Hi.ql.bind(this.Hi),this);this.Hi.p_().l(this.Hi.ql.bind(this.Hi),this)}$t(){return this.Hi}W(){return this._n}Jm(){return this.Am}Qm(){return this.Ym}S(){this.Um(!1);0!==this.Vm&&window.cancelAnimationFrame(this.Vm);this.Hi.$c().p(this);this.Hi.St().Qu().p(this);this.Hi.p_().p(this);this.Hi.S();for(const n of this.Am)this.jm.removeChild(n.Uv()),n.Hp().p(this),n.$p().p(this),n.S();this.Am=[];n(this.Ym).S();null!==this.vm.parentElement&&this.vm.parentElement.removeChild(this.vm);this.yc.S();this.fp.S();this.vp.S();this.tb()}Km(i,u,f=!1){if(this.no!==u||this.h_!==i){const e=function(n){const i=Math.floor(n.width),r=Math.floor(n.height);return t({width:i-i%2,height:r-r%2})}(t({width:i,height:u}));this.no=e.height;this.h_=e.width;const o=this.no+"px",s=this.h_+"px";n(this.vm).style.height=o;n(this.vm).style.width=s;this.jm.style.height=o;this.jm.style.width=s;f?this.ib(r.ns(),performance.now()):this.Hi.ql()}}Qv(n){void 0===n&&(n=r.ns());for(let t=0;t<this.Am.length;t++)this.Am[t].Qv(n.Wn(t).Ln);this._n.timeScale.visible&&this.Ym.Qv(n.Fn())}Fh(n){const i=wu(this._n);this.Hi.Fh(n);const t=wu(this._n);t!==i&&this.Um(t);this.Gm();this.nb(n)}Hp(){return this.fp}$p(){return this.vp}$c(){return this.yc}sb(){null!==this.Im&&(this.ib(this.Im,performance.now()),this.Im=null);const i=this.eb(null),t=document.createElement("canvas");t.width=i.width;t.height=i.height;const r=n(t.getContext("2d"));return this.eb(r),t}rb(t){return"left"===t&&!this.hb()?0:"right"===t&&!this.lb()?0:0===this.Am.length?0:n("left"===t?this.Am[0].Qp():this.Am[0].tm()).Gv()}ab(){return this._n.autoSize&&null!==this.Nm}ob(){return this.vm}Ep(n){this.Fm=n;this.Fm?this.ob().style.setProperty("cursor",n):this.ob().style.removeProperty("cursor")}_b(){return this.Fm}ub(){return u(this.Am[0]).Yp()}nb(n){void 0===n.autoSize&&this.Nm&&(void 0!==n.width||void 0!==n.height)||(n.autoSize&&!this.Nm&&this.Xm(),!1===n.autoSize&&null!==this.Nm&&this.tb(),n.autoSize||void 0===n.width&&void 0===n.height||this.Km(n.width||this.h_,n.height||this.no))}eb(i){let u=0,r=0;const f=this.Am[0],e=(t,r)=>{let u=0;for(let f=0;f<this.Am.length;f++){const e=this.Am[f],o=n("left"===t?e.Qp():e.tm()),s=o.hp();null!==i&&o.lp(i,r,u);u+=s.height}};this.hb()&&(e("left",0),u+=n(f.Qp()).hp().width);for(let n=0;n<this.Am.length;n++){const t=this.Am[n],f=t.hp();null!==i&&t.lp(i,u,r);r+=f.height}(u+=f.hp().width,this.lb())&&(e("right",u),u+=n(f.tm()).hp().width);const o=(t,r,u)=>{n("left"===t?this.Ym.Mm():this.Ym.xm()).lp(n(i),r,u)};if(this._n.timeScale.visible){const t=this.Ym.hp();if(null!==i){let u=0;this.hb()&&(o("left",u,r),u=n(f.Qp()).hp().width);this.Ym.lp(i,u,r);u+=t.width;this.lb()&&o("right",u,r)}r+=t.height}return t({width:u,height:r})}cb(){let o=0,i=0,r=0;for(const t of this.Am)this.hb()&&(i=Math.max(i,n(t.Qp()).Yv(),this._n.leftPriceScale.minimumWidth)),this.lb()&&(r=Math.max(r,n(t.tm()).Yv(),this._n.rightPriceScale.minimumWidth)),o+=t.m_();i=eu(i);r=eu(r);const v=this.h_,s=this.no,e=Math.max(v-i-r,0),u=this._n.timeScale.visible;let f=u?Math.max(this.Ym.km(),this._n.timeScale.minimumHeight):0;var h;f=(h=f)+h%2;const c=0+f,l=s<c?0:s-c,y=l/o;let a=0;for(let n=0;n<this.Am.length;++n){const u=this.Am[n];u.Dp(this.Hi.Wc()[n]);let f=0,o=0;o=n===this.Am.length-1?l-a:Math.round(u.m_()*y);f=Math.max(o,2);a+=f;u.Zv(t({width:e,height:f}));this.hb()&&u.qp(i,"left");this.lb()&&u.qp(r,"right");u.Jv()&&this.Hi.Uc(u.Jv(),f)}this.Ym.ym(t({width:u?e:0,height:f}),u?i:0,u?r:0);this.Hi.w_(e);this.zm!==i&&(this.zm=i);this.Em!==r&&(this.Em=r)}Um(n){n?this.vm.addEventListener("wheel",this.Hm,{passive:!1}):this.vm.removeEventListener("wheel",this.Hm)}fb(n){switch(n.deltaMode){case n.DOM_DELTA_PAGE:return 120;case n.DOM_DELTA_LINE:return 32}return uv?1/window.devicePixelRatio:1}$m(n){if(0!==n.deltaX&&this._n.handleScroll.mouseWheel||0!==n.deltaY&&this._n.handleScale.mouseWheel){const i=this.fb(n),r=i*n.deltaX/100,t=-i*n.deltaY/100;if(n.cancelable&&n.preventDefault(),0!==t&&this._n.handleScale.mouseWheel){const i=Math.sign(t)*Math.min(1,Math.abs(t)),r=n.clientX-this.vm.getBoundingClientRect().left;this.$t().Xc(r,i)}0!==r&&this._n.handleScroll.mouseWheel&&this.$t().Kc(-80*r)}}ib(n,t){var i;const r=n.Fn();3===r&&this.vb();3!==r&&2!==r||(this.pb(n),this.mb(n,t),this.Ym.bt(),this.Am.forEach(n=>{n.Bp()}),3===(null===(i=this.Im)||void 0===i?void 0:i.Fn())&&(this.Im.Jn(n),this.vb(),this.pb(this.Im),this.mb(this.Im,t),n=this.Im,this.Im=null));this.Qv(n)}mb(n,t){for(const n of n.Gn())this.Qn(n,t)}pb(n){const t=this.Hi.Wc();for(let i=0;i<t.length;i++)n.Wn(i).Nn&&t[i].z_()}Qn(n,t){const i=this.Hi.St();switch(n.$n){case 0:i.ic();break;case 1:i.nc(n.Ot);break;case 2:i.Kn(n.Ot);break;case 3:i.Zn(n.Ot);break;case 4:i.ju();break;case 5:n.Ot.Ku(t)||i.Zn(n.Ot.Zu(t))}}Cc(n){null!==this.Im?this.Im.Jn(n):this.Im=n;this.Lm||(this.Lm=!0,this.Vm=window.requestAnimationFrame(n=>{if(this.Lm=!1,this.Vm=0,null!==this.Im){const t=this.Im;this.Im=null;this.ib(t,n);for(const t of t.Gn())if(5===t.$n&&!t.Ot.Ku(n)){this.$t().qn(t.Ot);break}}}))}vb(){this.Zm()}Zm(){const n=this.Hi.Wc(),t=n.length,i=this.Am.length;for(let n=t;n<i;n++){const n=u(this.Am.pop());this.jm.removeChild(n.Uv());n.Hp().p(this);n.$p().p(this);n.S()}for(let r=i;r<t;r++){const t=new lo(this,n[r]);t.Hp().l(this.bb.bind(this),this);t.$p().l(this.wb.bind(this),this);this.Am.push(t);this.jm.insertBefore(t.Uv(),this.Ym.Uv())}for(let i=0;i<t;i++){const r=n[i],t=this.Am[i];t.Jv()!==r?t.Dp(r):t.Rp()}this.Gm();this.cb()}gb(n,t,i){var u;const f=new Map;null!==n&&this.Hi.wt().forEach(t=>{const i=t.An().sl(n);null!==i&&f.set(t,i)});let e;if(null!==n){const t=null===(u=this.Hi.St().$i(n))||void 0===u?void 0:u.originalTime;void 0!==t&&(e=t)}const r=this.$t().Ec(),o=null!==r&&r.Lc instanceof ar?r.Lc:void 0,s=null!==r&&void 0!==r.wv?r.wv.mr:void 0;return{Mb:e,ie:null!=n?n:void 0,xb:null!=t?t:void 0,Sb:o,yb:f,kb:s,Cb:null!=i?i:void 0}}bb(n,t,i){this.fp.m(()=>this.gb(n,t,i))}wb(n,t,i){this.vp.m(()=>this.gb(n,t,i))}qm(n,t,i){this.yc.m(()=>this.gb(n,t,i))}Gm(){const n=this._n.timeScale.visible?"":"none";this.Ym.Uv().style.display=n}hb(){return this.Am[0].Jv().k_().W().visible}lb(){return this.Am[0].Jv().C_().W().visible}Xm(){return"ResizeObserver"in window&&(this.Nm=new ResizeObserver(n=>{const t=n.find(n=>n.target===this.Wm);t&&this.Km(t.contentRect.width,t.contentRect.height)}),this.Nm.observe(this.Wm,{box:"border-box"}),!0)}tb(){null!==this.Nm&&this.Nm.disconnect();this.Nm=null}}class lv{constructor(n){this.Ob=new Map;this.Bb=new Map;this.Ab=new Map;this.Vb=[];this.W_=n}S(){this.Ob.clear();this.Bb.clear();this.Ab.clear();this.Vb=[]}zb(n,t){let r=0!==this.Ob.size,i=!1;const u=this.Bb.get(n);if(void 0!==u)if(1===this.Bb.size)r=!1,i=!0,this.Ob.clear();else for(const t of this.Vb)t.pointData.Pb.delete(n)&&(i=!0);let f=[];if(0!==t.length){const r=t.map(n=>n.time),u=this.W_.createConverterToInternalObj(t),e=wo(n.Kh()),o=n.xa(),s=n.Sa();f=t.map((t,f)=>{const c=u(t.time),l=this.W_.key(c);let h=this.Ob.get(l);void 0===h&&(h=bo(c),this.Ob.set(l,h),i=!0);const a=e(c,h.ie,t,r[f],o,s);return h.Pb.set(n,a),a})}r&&this.Eb();this.Ib(n,f);let e=-1;if(i){const n=[];this.Ob.forEach(t=>{n.push({timeWeight:0,time:t.sa,pointData:t,originalTime:go(t.Pb)})});n.sort((n,t)=>this.W_.key(n.time)-this.W_.key(t.time));e=this.Lb(n)}return this.Nb(n,e,function(n,t,i){const r=ko(n,i),u=ko(t,i);if(void 0!==r&&void 0!==u)return{Zl:r.Db>=u.Db&&r.Rb>=u.Rb}}(this.Bb.get(n),u,this.W_))}od(n){return this.zb(n,[])}Fb(n,t){const o=t;!function(n){void 0===n.Mb&&(n.Mb=n.time)}(o);this.W_.preprocessData(t);const r=this.W_.createConverterToInternalObj([t])(t.time),f=this.Ab.get(n);if(void 0!==f&&this.W_.key(r)<this.W_.key(f))throw new Error(`Cannot update oldest data, last time=${f}, new time=${r}`);let i=this.Ob.get(this.W_.key(r));const c=void 0===i;void 0===i&&(i=bo(r),this.Ob.set(this.W_.key(r),i));const l=wo(n.Kh()),a=n.xa(),v=n.Sa(),e=l(r,i.ie,t,o.Mb,a,v);i.Pb.set(n,e);this.Wb(n,e);const s={Zl:pi(e)};if(!c)return this.Nb(n,-1,s);const h={timeWeight:0,time:i.sa,pointData:i,originalTime:go(i.Pb)},u=st(this.Vb,this.W_.key(h.time),(n,t)=>this.W_.key(n.time)<t);this.Vb.splice(u,0,h);for(let n=u;n<this.Vb.length;++n)bu(this.Vb[n].pointData,n);return this.W_.fillWeightsForPoints(this.Vb,u),this.Nb(n,u,s)}Wb(n,t){let i=this.Bb.get(n);void 0===i&&(i=[],this.Bb.set(n,i));const r=0!==i.length?i[i.length-1]:null;null===r||this.W_.key(t.ot)>this.W_.key(r.ot)?pi(t)&&i.push(t):pi(t)?i[i.length-1]=t:i.splice(-1,1);this.Ab.set(n,t.ot)}Ib(n,t){0!==t.length?(this.Bb.set(n,t.filter(pi)),this.Ab.set(n,t[t.length-1].ot)):(this.Bb.delete(n),this.Ab.delete(n))}Eb(){for(const n of this.Vb)0===n.pointData.Pb.size&&this.Ob.delete(this.W_.key(n.time))}Lb(n){let t=-1;for(let i=0;i<this.Vb.length&&i<n.length;++i){const u=this.Vb[i],r=n[i];if(this.W_.key(u.time)!==this.W_.key(r.time)){t=i;break}r.timeWeight=u.timeWeight;bu(r.pointData,i)}if(-1===t&&this.Vb.length!==n.length&&(t=Math.min(this.Vb.length,n.length)),-1===t)return-1;for(let i=t;i<n.length;++i)bu(n[i].pointData,i);return this.W_.fillWeightsForPoints(n,t),this.Vb=n,t}jb(){if(0===this.Bb.size)return null;let n=0;return this.Bb.forEach(t=>{0!==t.length&&(n=Math.max(n,t[t.length-1].ie))}),n}Nb(n,t,i){const r={Hb:new Map,St:{Vu:this.jb()}};if(-1!==t)this.Bb.forEach((t,u)=>{r.Hb.set(u,{We:t,$b:u===n?i:void 0})}),this.Bb.has(n)||r.Hb.set(n,{We:[],$b:i}),r.St.Ub=this.Vb,r.St.qb=t;else{const t=this.Bb.get(n);r.Hb.set(n,{We:t||[],$b:i})}return r}}const bv={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},kv={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},dv={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:ki},gu={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},gv={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},ny={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:ki,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};class ty{constructor(n,t){this.Yb=n;this.Xb=t}applyOptions(n){this.Yb.$t().Nc(this.Xb,n)}options(){return this.Ei().W()}width(){return ti(this.Xb)?this.Yb.rb(this.Xb):0}Ei(){return n(this.Yb.$t().Fc(this.Xb)).Dt}}const iy={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class ry{constructor(n){this.zh=n}applyOptions(n){this.zh.Fh(n)}options(){return this.zh.W()}Kb(){return this.zh}}class uy{constructor(n,t,r,u,f){this.Zb=new i;this.zs=n;this.Gb=t;this.Jb=r;this.W_=f;this.Qb=u}S(){this.Zb.S()}priceFormatter(){return this.zs.fa()}priceToCoordinate(n){const t=this.zs.Ct();return null===t?null:this.zs.Dt().Rt(n,t.Ot)}coordinateToPrice(n){const t=this.zs.Ct();return null===t?null:this.zs.Dt().fn(n,t.Ot)}barsInLogicalRange(t){if(null===t)return null;const s=new wt(new pt(t.from,t.to)).su(),u=this.zs.An();if(u.Li())return null;const i=u.sl(s.Rs(),1),r=u.sl(s.ui(),-1),f=n(u.tl()),e=n(u.Bn());if(null!==i&&null!==r&&i.ie>r.ie)return{barsBefore:t.from-f,barsAfter:e-t.to};const o={barsBefore:null===i||i.ie===f?t.from-f:i.ie-f,barsAfter:null===r||r.ie===e?e-t.to:e-r.ie};return null!==i&&null!==r&&(o.from=i.Mb,o.to=r.Mb),o}setData(n){this.W_;this.zs.Kh();this.Gb.tw(this.zs,n);this.iw("full")}update(n){this.zs.Kh();this.Gb.nw(this.zs,n);this.iw("update")}dataByIndex(n,t){const i=this.zs.An().sl(n,t);return null===i?null:du(this.seriesType())(i)}data(){const n=du(this.seriesType());return this.zs.An().Qs().map(t=>n(t))}subscribeDataChanged(n){this.Zb.l(n)}unsubscribeDataChanged(n){this.Zb.v(n)}setMarkers(n){this.W_;const t=n.map(n=>rs(n,this.W_.convertHorzItemToInternal(n.time),n.time));this.zs.Jl(t)}markers(){return this.zs.Ql().map(n=>rs(n,n.originalTime,void 0))}applyOptions(n){this.zs.Fh(n)}options(){return l(this.zs.W())}priceScale(){return this.Jb.priceScale(this.zs.Dt().ya())}createPriceLine(n){const t=o(l(iy),n),i=this.zs.ta(t);return new ry(i)}removePriceLine(n){this.zs.ia(n.Kb())}seriesType(){return this.zs.Kh()}attachPrimitive(n){this.zs.ga(n);n.attached&&n.attached({chart:this.Qb,series:this,requestUpdate:()=>this.zs.$t().ql()})}detachPrimitive(n){this.zs.Ma(n);n.detached&&n.detached()}iw(n){this.Zb.M()&&this.Zb.m(n)}}class fy{constructor(n,t,r){this.sw=new i;this.du=new i;this.fm=new i;this.Hi=n;this.Ml=n.St();this.Ym=t;this.Ml.Gu().l(this.ew.bind(this));this.Ml.Ju().l(this.rw.bind(this));this.Ym.Sm().l(this.hw.bind(this));this.W_=r}S(){this.Ml.Gu().p(this);this.Ml.Ju().p(this);this.Ym.Sm().p(this);this.sw.S();this.du.S();this.fm.S()}scrollPosition(){return this.Ml.Nu()}scrollToPosition(n,t){t?this.Ml.Xu(n,1e3):this.Hi.Zn(n)}scrollToRealTime(){this.Ml.Yu()}getVisibleRange(){const n=this.Ml.Tu();return null===n?null:{from:n.from.originalTime,to:n.to.originalTime}}setVisibleRange(n){const t={from:this.W_.convertHorzItemToInternal(n.from),to:this.W_.convertHorzItemToInternal(n.to)},i=this.Ml.Ou(t);this.Hi._d(i)}getVisibleLogicalRange(){const n=this.Ml.Cu();return null===n?null:{from:n.Rs(),to:n.ui()}}setVisibleLogicalRange(n){v(n.from<=n.to,"The from index cannot be after the to index.");this.Hi._d(n)}resetTimeScale(){this.Hi.Xn()}fitContent(){this.Hi.ic()}logicalToCoordinate(n){const t=this.Hi.St();return t.Li()?null:t.zt(n)}coordinateToLogical(n){return this.Ml.Li()?null:this.Ml.zu(n)}timeToCoordinate(n){const i=this.W_.convertHorzItemToInternal(n),t=this.Ml.Ta(i,!1);return null===t?null:this.Ml.zt(t)}coordinateToTime(n){const t=this.Hi.St(),r=t.zu(n),i=t.$i(r);return null===i?null:i.originalTime}width(){return this.Ym.Yp().width}height(){return this.Ym.Yp().height}subscribeVisibleTimeRangeChange(n){this.sw.l(n)}unsubscribeVisibleTimeRangeChange(n){this.sw.v(n)}subscribeVisibleLogicalRangeChange(n){this.du.l(n)}unsubscribeVisibleLogicalRangeChange(n){this.du.v(n)}subscribeSizeChange(n){this.fm.l(n)}unsubscribeSizeChange(n){this.fm.v(n)}applyOptions(n){this.Ml.Fh(n)}options(){return Object.assign(Object.assign({},l(this.Ml.W())),{barSpacing:this.Ml.ee()})}ew(){this.sw.M()&&this.sw.m(this.getVisibleRange())}rw(){this.du.M()&&this.du.m(this.getVisibleLogicalRange())}hw(n){this.fm.m(n.width,n.height)}}class oy{constructor(n,t,r){this.lw=new Map;this.aw=new Map;this.ow=new i;this._w=new i;this.uw=new i;this.cw=new lv(t);const u=void 0===r?l(is()):o(l(is()),us(r));this.W_=t;this.Yb=new fv(n,u,t);this.Yb.Hp().l(n=>{this.ow.M()&&this.ow.m(this.dw(n()))},this);this.Yb.$p().l(n=>{this._w.M()&&this._w.m(this.dw(n()))},this);this.Yb.$c().l(n=>{this.uw.M()&&this.uw.m(this.dw(n()))},this);const f=this.Yb.$t();this.fw=new fy(f,this.Yb.Qm(),this.W_)}remove(){this.Yb.Hp().p(this);this.Yb.$p().p(this);this.Yb.$c().p(this);this.fw.S();this.Yb.S();this.lw.clear();this.aw.clear();this.ow.S();this._w.S();this.uw.S();this.cw.S()}resize(n,t,i){this.autoSizeActive()||this.Yb.Km(n,t,i)}addCustomSeries(n,t){const i=nt(n),r=Object.assign(Object.assign({},nf),i.defaultOptions());return this.pw("Custom",r,t,i)}addAreaSeries(n){return this.pw("Area",cs,n)}addBaselineSeries(n){return this.pw("Baseline",ls,n)}addBarSeries(n){return this.pw("Bar",ss,n)}addCandlestickSeries(n={}){return function(n){void 0!==n.borderColor&&(n.borderUpColor=n.borderColor,n.borderDownColor=n.borderColor);void 0!==n.wickColor&&(n.wickUpColor=n.wickColor,n.wickDownColor=n.wickColor)}(n),this.pw("Candlestick",os,n)}addHistogramSeries(n){return this.pw("Histogram",as,n)}addLineSeries(n){return this.pw("Line",hs,n)}removeSeries(n){const t=u(this.lw.get(n)),i=this.cw.od(t);this.Yb.$t().od(t);this.mw(i);this.lw.delete(n);this.aw.delete(t)}tw(n,t){this.mw(this.cw.zb(n,t))}nw(n,t){this.mw(this.cw.Fb(n,t))}subscribeClick(n){this.ow.l(n)}unsubscribeClick(n){this.ow.v(n)}subscribeCrosshairMove(n){this.uw.l(n)}unsubscribeCrosshairMove(n){this.uw.v(n)}subscribeDblClick(n){this._w.l(n)}unsubscribeDblClick(n){this._w.v(n)}priceScale(n){return new ty(this.Yb,n)}timeScale(){return this.fw}applyOptions(n){this.Yb.Fh(us(n))}options(){return this.Yb.W()}takeScreenshot(){return this.Yb.sb()}autoSizeActive(){return this.Yb.ab()}chartElement(){return this.Yb.ob()}paneSize(){const n=this.Yb.ub();return{height:n.height,width:n.width}}setCrosshairPosition(n,t,i){const r=this.lw.get(i);if(void 0!==r){const u=this.Yb.$t()._r(r);null!==u&&this.Yb.$t().sd(n,t,u)}}clearCrosshairPosition(){this.Yb.$t().ed(!0)}pw(n,t,i={},r){ey(i.priceFormat);const e=o(l(tf),l(t),i),u=this.Yb.$t().ld(n,e,r),f=new uy(u,this,this,this,this.W_);return this.lw.set(f,u),this.aw.set(u,f),f}mw(n){const t=this.Yb.$t();t.rd(n.St.Vu,n.St.Ub,n.St.qb);n.Hb.forEach((n,t)=>t.J(n.We,n.$b));t.Iu()}bw(n){return u(this.aw.get(n))}dw(n){const t=new Map;n.yb.forEach((n,i)=>{const u=i.Kh(),r=du(u)(n);if("Custom"!==u)v(function(n){return void 0!==n.open||void 0!==n.value}(r));else{const n=i.Sa();v(!n||!1===n(r))}t.set(this.bw(i),r)});const i=void 0!==n.Sb&&this.aw.has(n.Sb)?this.bw(n.Sb):void 0;return{time:n.Mb,logical:n.ie,point:n.xb,hoveredSeries:i,hoveredObjectId:n.kb,seriesData:t,sourceEvent:n.Cb}}}const sy=Object.assign(Object.assign({},tf),nf);es=Object.freeze({__proto__:null,get ColorType(){return gr},get CrosshairMode(){return nr},get LastPriceAnimationMode(){return kr},get LineStyle(){return bi},get LineType(){return wi},get MismatchDirection(){return sr},get PriceLineSource(){return dr},get PriceScaleMode(){return wr},get TickMarkType(){return nu},get TrackingModeExitMode(){return br},createChart:function(n,t){return fs(n,new ro,ro.Dd(t))},createChartEx:fs,customSeriesDefaultOptions:sy,isBusinessDay:si,isUTCTimestamp:tu,version:function(){return"4.1.4"}});window.LightweightCharts=es}();